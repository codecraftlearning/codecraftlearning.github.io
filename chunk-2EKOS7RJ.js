import{a as ue,b as E,c as je,d as T,e as L,f as q,g as Le,h as pe,i as A,j as te,k as Re}from"./chunk-WZJF6OEM.js";import{A as d,Aa as _,B as J,Ba as B,C as ke,Ca as G,Da as De,Ea as R,Fa as me,G as n,H as t,Ha as z,I as p,Ia as X,J as F,Ja as ee,K as I,Ka as W,L as k,La as U,M as x,Ma as K,N as g,Na as Y,Oa as Be,Qa as Z,Ra as qe,Sa as Ae,T as o,Ta as $e,U as h,V as w,Va as Ge,W as Pe,X as Me,Y as we,a as N,b as O,ba as he,c as Ce,ca as Oe,d as Se,da as Fe,g as de,ga as Ie,ha as D,i as ye,ia as Q,j as V,k as ce,ka as Te,n as b,o as C,ra as Ne,s as Ee,ta as Ve,v as l,w as M,wa as re,y as u,ya as se,za as $}from"./chunk-REUI3DMA.js";import{a as oe,b as le}from"./chunk-EMNZ2YI5.js";function Qe(r,s){r&1&&(n(0,"h5",40),o(1,"Create Student"),t())}function Xe(r,s){if(r&1&&(n(0,"h5",40),o(1),t()),r&2){let e,i=g(2);l(),w("Update Student - ",(e=i.studentForm.get("id"))==null?null:e.value,"")}}function et(r,s){if(r&1){let e=k();n(0,"button",41),x("click",function(){b(e);let a=g(2);return C(a.certifyStudent())}),o(1,"Verified and Certify"),t()}}function tt(r,s){r&1&&(n(0,"div",42),o(1," Name is required. "),t())}function nt(r,s){r&1&&(n(0,"div",42),o(1," Valid age is required. "),t())}function it(r,s){r&1&&(n(0,"div",42),o(1," Gender is required. "),t())}function ot(r,s){r&1&&(n(0,"div",42),o(1,'"> Valid email is required. '),t())}function rt(r,s){r&1&&(n(0,"div",42),o(1,'"> Phone is required. '),t())}function at(r,s){r&1&&(n(0,"div",42),o(1,'"> Street is required. '),t())}function lt(r,s){r&1&&(n(0,"div",42),o(1,'"> City is required. '),t())}function dt(r,s){r&1&&(n(0,"div",42),o(1,'"> State is required. '),t())}function ct(r,s){r&1&&(n(0,"div",42),o(1,'"> Valid zip is required. '),t())}function st(r,s){r&1&&(n(0,"div",42),o(1,'"> Country is required. '),t())}function mt(r,s){if(r&1){let e=k();n(0,"div",62)(1,"h6",63),o(2),t(),n(3,"button",64),x("click",function(){b(e);let a=g().index,c=g(2);return C(c.courses.removeAt(a))}),o(4," - Remove Course"),t()()}if(r&2){let e=g().index;l(2),w("Course ",e+1,"")}}function ut(r,s){if(r&1&&(n(0,"option",65),o(1),t()),r&2){let e=s.$implicit;d("value",e.id),l(),h(e.name)}}function pt(r,s){if(r&1){let e=k();n(0,"a",69),x("click",function(){b(e);let a=g().index,c=g().$implicit,m=g(2);return C(m.removeTechAt(c,a))}),o(1,"x"),t()}}function gt(r,s){if(r&1&&(F(0),n(1,"div",66)(2,"span",67),o(3),t(),u(4,pt,2,0,"a",68),t(),I()),r&2){let e=s.$implicit,i=g().$implicit,a=g(2);l(3),h(e),l(),d("ngIf",a.getTechStack(i).length>1)}}function ft(r,s){if(r&1&&(n(0,"option",65),o(1),t()),r&2){let e=s.$implicit;d("value",e.title),l(),h(e.title)}}function _t(r,s){r&1&&(n(0,"div",42),o(1," Course name is required. "),t())}function ht(r,s){r&1&&(n(0,"div",42),o(1," Custom Course Name is required. "),t())}function xt(r,s){r&1&&(n(0,"div",42),o(1," Duration is required. "),t())}function vt(r,s){r&1&&(n(0,"div",42),o(1," Monthly Price is required. "),t())}function bt(r,s){r&1&&(n(0,"div",42),o(1," Enrollment Date is required. "),t())}function Ct(r,s){r&1&&(n(0,"div",42),o(1," Completion Date cannot be before Enrollment Date. "),t())}function St(r,s){r&1&&(n(0,"div",42),o(1," instructor name is required. "),t())}function yt(r,s){r&1&&(n(0,"div",42),o(1," Course current status is required. "),t())}function Et(r,s){if(r&1&&(n(0,"option",65),o(1),t()),r&2){let e=s.$implicit;d("value",e),l(),w("",e," ")}}function kt(r,s){r&1&&(n(0,"div",42),o(1," Certification type is required. "),t())}function Pt(r,s){if(r&1&&(n(0,"div",43),u(1,mt,5,1,"div",44),n(2,"div",45)(3,"div",13)(4,"label"),o(5,"Batch name"),t(),n(6,"select",46)(7,"option",18),o(8,"Select Batch"),t(),u(9,ut,2,2,"option",47),t()()(),n(10,"div",48)(11,"label"),o(12,"Tech Stack"),t(),n(13,"div",49),u(14,gt,5,2,"ng-container",50),t()(),n(15,"div",51)(16,"div",13)(17,"label"),o(18,"Course Name*"),t(),n(19,"select",14),u(20,ft,2,2,"option",47),t(),u(21,_t,2,0,"div",15),t(),n(22,"div",13)(23,"label"),o(24,"Custom Course Name"),t(),p(25,"input",52),u(26,ht,2,0,"div",15),t(),n(27,"div",13)(28,"label"),o(29,"Default Duration*"),t(),p(30,"input",53),u(31,xt,2,0,"div",15),t(),n(32,"div",13)(33,"label"),o(34,"Monthly Price*"),t(),p(35,"input",54),u(36,vt,2,0,"div",15),t()(),n(37,"div",51)(38,"div",13)(39,"label"),o(40,"Enrollment Date*"),t(),p(41,"input",55),u(42,bt,2,0,"div",15),t(),n(43,"div",13)(44,"label"),o(45,"Completion Date"),t(),p(46,"input",56),u(47,Ct,2,0,"div",15),t(),n(48,"div",57)(49,"label"),o(50,"Instructor*"),t(),p(51,"input",58),u(52,St,2,0,"div",15),t(),n(53,"div",13)(54,"label"),o(55,"Status*"),t(),p(56,"input",59),u(57,yt,2,0,"div",15),t()(),n(58,"div",60)(59,"div",51)(60,"div",13)(61,"label"),o(62,"Certification Type"),t(),n(63,"select",61),u(64,Et,2,2,"option",47),t(),u(65,kt,2,0,"div",15),t(),n(66,"div",13)(67,"label"),o(68,"Certification Status*"),t(),p(69,"input",59),t(),n(70,"div",13)(71,"label"),o(72,"Certification Date"),t(),p(73,"input",59),t(),n(74,"div",13)(75,"label"),o(76,"Certificate ID"),t(),p(77,"input",59),t()()()()),r&2){let e,i,a,c,m,S,y,f,H,j,v,xe,ve,be,P=s.$implicit,He=s.index,ie=g(2);d("formGroupName",He),l(),d("ngIf",!ie.isEditMode),l(8),d("ngForOf",ie.availableBatches),l(5),d("ngForOf",ie.getTechStack(P)),l(6),d("ngForOf",ie.courseList),l(),d("ngIf",((e=P.get("name"))==null?null:e.invalid)&&((e=P.get("name"))==null?null:e.touched)),l(),J("disabled",((i=P.get("name"))==null?null:i.value)!=="CUSTOM"),l(4),d("ngIf",((a=P.get("customName"))==null?null:a.invalid)&&((a=P.get("customName"))==null?null:a.touched)),l(5),d("ngIf",((c=P.get("defaultDuration"))==null?null:c.invalid)&&((c=P.get("defaultDuration"))==null?null:c.touched)),l(5),d("ngIf",((m=P.get("price"))==null?null:m.invalid)&&((m=P.get("price"))==null?null:m.touched)),l(6),d("ngIf",((S=P.get("enrollmentDate"))==null?null:S.invalid)&&((S=P.get("enrollmentDate"))==null?null:S.touched)),l(5),d("ngIf",((y=P.get("completionDate"))==null||y.errors==null?null:y.errors.completionBeforeEnrollment)&&((y=P.get("completionDate"))==null?null:y.touched)),l(5),d("ngIf",((f=P.get("instructor"))==null?null:f.invalid)&&((f=P.get("instructor"))==null?null:f.touched)),l(4),d("value",(H=P.get("status"))==null?null:H.value),l(),d("ngIf",((j=P.get("status"))==null?null:j.invalid)&&((j=P.get("status"))==null?null:j.touched)),l(7),d("ngForOf",ie.certificationTypeList),l(),d("ngIf",(v=P.get("certification.certificationType"))==null?null:v.invalid),l(4),d("value",(xe=P.get("certification.certificationStatus"))==null?null:xe.value),l(4),d("value",(ve=P.get("certification.certificationDate"))==null?null:ve.value),l(4),d("value",(be=P.get("certification.certificateId"))==null?null:be.value)}}function Mt(r,s){if(r&1){let e=k();n(0,"button",70),x("click",function(){b(e);let a=g(2);return C(a.addCourse())}),o(1,"+ Add Course"),t()}}function wt(r,s){if(r&1){let e=k();n(0,"button",41),x("click",function(){b(e);let a=g(3);return C(a.onSubmit())}),o(1,"Create"),t()}}function Ot(r,s){if(r&1){let e=k();n(0,"button",41),x("click",function(){b(e);let a=g(3);return C(a.updateStudent())}),o(1,"Update Student"),t()}}function Ft(r,s){if(r&1&&(F(0),u(1,wt,2,0,"button",7)(2,Ot,2,0,"button",7),I()),r&2){let e=g(2);l(),d("ngIf",!e.isEditMode),l(),d("ngIf",e.isEditMode)}}function It(r,s){if(r&1){let e=k();n(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),u(5,Qe,2,0,"h5",6)(6,Xe,2,1,"h5",6)(7,et,2,0,"button",7),t(),n(8,"button",8),x("click",function(){b(e);let a=g();return C(a.closeModal())}),n(9,"span",9),o(10,"\xD7"),t()()(),n(11,"form",10)(12,"div",11)(13,"div",12)(14,"div",13)(15,"label"),o(16,"Full Name*"),t(),p(17,"input",14),u(18,tt,2,0,"div",15),t(),n(19,"div",13)(20,"label"),o(21,"Age*"),t(),p(22,"input",16),u(23,nt,2,0,"div",15),t(),n(24,"div",13)(25,"label"),o(26,"Gender*"),t(),n(27,"select",17)(28,"option",18),o(29,"Select"),t(),n(30,"option",19),o(31,"Male"),t(),n(32,"option",20),o(33,"Female"),t(),n(34,"option",21),o(35,"Other"),t()(),u(36,it,2,0,"div",15),t()(),n(37,"div",22)(38,"div",12)(39,"div",13)(40,"label"),o(41,"Email*"),t(),p(42,"input",23),u(43,ot,2,0,"div",15),t(),n(44,"div",13)(45,"label"),o(46,"Phone*"),t(),p(47,"input",24),u(48,rt,2,0,"div",15),t(),n(49,"div",13)(50,"label"),o(51,"Alternate Phone"),t(),p(52,"input",25),t()()(),n(53,"div",26)(54,"div",27)(55,"div",13)(56,"label"),o(57,"Street*"),t(),p(58,"input",28),u(59,at,2,0,"div",15),t(),n(60,"div",13)(61,"label"),o(62,"City*"),t(),p(63,"input",29),u(64,lt,2,0,"div",15),t(),n(65,"div",13)(66,"label"),o(67,"State*"),t(),p(68,"input",30),u(69,dt,2,0,"div",15),t(),n(70,"div",13)(71,"label"),o(72,"Zip*"),t(),p(73,"input",31),u(74,ct,2,0,"div",15),t(),n(75,"div",13)(76,"label"),o(77,"Country*"),t(),p(78,"input",32),u(79,st,2,0,"div",15),t()()(),n(80,"div",33),u(81,Pt,78,21,"div",34)(82,Mt,2,0,"button",35),t()(),p(83,"app-loader",36),n(84,"div",37),u(85,Ft,3,2,"ng-container",38),n(86,"button",39),x("click",function(){b(e);let a=g();return C(a.closeModal())}),o(87,"Cancel"),t()()()()()()}if(r&2){let e,i,a,c,m,S,y,f,H,j,v=g();l(5),d("ngIf",!v.isEditMode),l(),d("ngIf",v.isEditMode),l(),d("ngIf",v.isReadyToCertify),l(4),d("formGroup",v.studentForm),l(),J("hidden",v.creatingStudent),l(6),d("ngIf",((e=v.studentForm.get("name"))==null?null:e.invalid)&&((e=v.studentForm.get("name"))==null?null:e.touched)),l(5),d("ngIf",((i=v.studentForm.get("age"))==null?null:i.invalid)&&((i=v.studentForm.get("age"))==null?null:i.touched)),l(13),d("ngIf",((a=v.studentForm.get("gender"))==null?null:a.invalid)&&((a=v.studentForm.get("gender"))==null?null:a.touched)),l(7),d("ngIf",((c=v.studentForm.get("contact.email"))==null?null:c.invalid)&&((c=v.studentForm.get("contact.email"))==null?null:c.touched)),l(5),d("ngIf",((m=v.studentForm.get("contact.phone"))==null?null:m.invalid)&&((m=v.studentForm.get("contact.phone"))==null?null:m.touched)),l(11),d("ngIf",((S=v.studentForm.get("address.street"))==null?null:S.invalid)&&((S=v.studentForm.get("address.street"))==null?null:S.touched)),l(5),d("ngIf",((y=v.studentForm.get("address.city"))==null?null:y.invalid)&&((y=v.studentForm.get("address.city"))==null?null:y.touched)),l(5),d("ngIf",((f=v.studentForm.get("address.state"))==null?null:f.invalid)&&((f=v.studentForm.get("address.state"))==null?null:f.touched)),l(5),d("ngIf",((H=v.studentForm.get("address.zip"))==null?null:H.invalid)&&((H=v.studentForm.get("address.zip"))==null?null:H.touched)),l(5),d("ngIf",((j=v.studentForm.get("address.country"))==null?null:j.invalid)&&((j=v.studentForm.get("address.country"))==null?null:j.touched)),l(),J("pointer-events-none",v.isCertified),l(),d("ngForOf",v.courses.controls),l(),d("ngIf",!v.isEditMode),l(),d("loading",v.creatingStudent),l(),J("disabled",v.creatingStudent),l(),d("ngIf",!v.isCertified)}}var ze=(()=>{class r{set SelectedStudent(e){if(e){this.courses.clear(),this.studentForm.reset(),this.isOpen=!0,this.isEditMode=!!e.id;let i=oe({},e);i.course=i.course?[i.course]:[],this.studentForm.patchValue(i),this.addCourse(i.course[0]),this.studentForm.updateValueAndValidity()}}constructor(e,i){this.fb=e,this.firebaseService=i,this.isOpen=!1,this.onClose=new Ee,this.isEditMode=!1,this.courseList=[],this.courseStatusList=Object.values(T),this.certificationStatusList=Object.values(L),this.certificationTypeList=Object.values(je),this.creatingStudent=!1,this.availableBatches=[],this.subscriptions=new N,this.studentForm=this.fb.group({id:[null],name:["",_.required],age:[null,[_.required,_.min(1)]],gender:["",_.required],contact:this.fb.group({email:["",[_.required,_.email]],phone:["",_.required],alternatePhone:[""]}),address:this.fb.group({street:["",_.required],city:["",_.required],state:["",_.required],zip:[null,[_.required,_.pattern("^[0-9]{6}$")]],country:["",_.required]}),course:this.fb.array([])})}ngOnInit(){this.loadAllCourses(),this.loadAllBatches()}loadAllBatches(){this.subscriptions.add(this.firebaseService.getAllFromCollection(E.batches).subscribe(e=>{this.availableBatches=e}))}getBatch(e){let i=this.availableBatches.find(a=>a.id===e);return i||null}get courses(){return this.studentForm.get("course")}getTechStack(e){return e.get("technology")?.value??[]}addCourse(e){let i=this.fb.group({batchName:[e?.batchName||null],name:[e?.name||"",_.required],customName:[e?.customName||""],defaultDuration:[e?.defaultDuration||null,_.required],enrollmentDate:[e?.enrollmentDate||null,_.required],completionDate:[e?.completionDate||null,this.completionAfterEnrollmentValidator],technology:[e?.technology||[],_.required],price:[e?.price||0,[_.required,_.min(0)]],instructor:[e?.instructor||"",_.required],status:[e?.status||T.notStarted,_.required],certification:this.fb.group({certificationType:[e?.certification?.certificationType||""],certificationStatus:[e?.certification?.certificationStatus||L.notApplicable,_.required],certificationDate:[e?.certification?.certificationDate||""],certificateId:[e?.certification?.certificateId||""]})});this.nameValueChanges(i),this.completionDateValueChanges(i),this.batchNameValueChanges(i),e&&(e.name?.toLowerCase()==="custom"?i.get("customName")?.addValidators(_.required):(i.get("customName")?.removeValidators(_.required),i.get("customName")?.setErrors(null)),i.updateValueAndValidity()),this.courses.push(i)}nameValueChanges(e){let i=e.controls.name.valueChanges.subscribe(a=>{let c=this.courseList.find(m=>m.title===a);c&&(e.patchValue({defaultDuration:c.durationInMonth,price:c.discountPrice,technology:c.allTechItems||[]}),c.title.toLowerCase()==="custom"?e.get("customName")?.addValidators(_.required):(e.get("customName")?.removeValidators(_.required),e.get("customName")?.setErrors(null)),e.updateValueAndValidity())});this.subscriptions.add(i)}completionDateValueChanges(e){let i=e.controls.completionDate.valueChanges.subscribe(a=>{a&&(e.patchValue({certification:{certificationStatus:L.pending},status:T.completed}),e.get("certification.certificationType")?.setValidators([_.required]),e.get("certification.certificationType")?.updateValueAndValidity(),e.get("certification.certificationType")?.markAllAsTouched())});this.subscriptions.add(i)}batchNameValueChanges(e){let i=e.controls.batchName.valueChanges.subscribe(a=>{(e.controls.status.value===T.notStarted||e.controls.status.value===T.inProgress)&&(e.patchValue({status:T.inProgress,instructor:this.getBatch(a)?.instructorName||""}),e.updateValueAndValidity())});this.subscriptions.add(i)}removeTechAt(e,i){let a=e.get("technology")?.value??[];a.length!==1&&(a.splice(i,1),e.patchValue({technology:a}),e.updateValueAndValidity())}closeModal(){this.isOpen=!1,this.isEditMode=!1,this.courses.clear(),this.studentForm.reset(),window.history.replaceState({},document.title,window.location.pathname),this.onClose.emit()}onSubmit(){if(this.studentForm.valid){this.creatingStudent=!0;let e=[];this.getFlatStudents().forEach(a=>{e.push(this.firebaseService.saveNewData(E.students,a,a.id)),this.updateStudentLog(a)});let i=O(Promise.all(e)).subscribe({next:()=>{this.closeModal(),this.creatingStudent=!1,window.alert("Student created successfully!")},error:a=>{console.error("Error creating student:",a),this.creatingStudent=!1,window.alert("Failed to create student. Please try again.")}});this.subscriptions.add(i)}else this.studentForm.markAllAsTouched(),console.error("Form is invalid")}getFlatStudents(){let e=[],i=0;return this.studentForm.value.course.forEach(a=>{++i;let c=le(oe({},this.studentForm.value),{course:a});c.id=this.createId()+i,e.push(c)}),e}updateStudent(){let e=this.studentForm.value;e.course=e.course[0];let i=e.id;if(this.studentForm.valid&&i){this.creatingStudent=!0;let a=O(this.firebaseService.updateData(E.students,i,e)).subscribe({next:()=>{this.closeModal(),this.creatingStudent=!1,window.alert("Student updated successfully!"),this.updateStudentLog(e)},error:c=>{console.error("Error updating student:",c),this.creatingStudent=!1,window.alert("Failed to update student. Please try again.")}});this.subscriptions.add(a)}else this.studentForm.markAllAsTouched(),console.error("Form is invalid or student ID is missing")}updateStudentLog(e){let i={id:e.id??"",email:e.contact.email,name:e.name,gender:e.gender??"",courseTitle:e.course.name==="CUSTOM"?e.course.customName??"":e.course.name};this.subscriptions.add(O(this.firebaseService.saveNewData(E.studentLog,i,e.id)).subscribe())}certifyStudent(){let e=this.studentForm.value;if(!e.id||e.course[0].status!==T.completed){window.alert("Student is not eligible for certification.");return}this.subscriptions.add(this.firebaseService.getAllFromCollection(E.reviews).subscribe(i=>{if(i.findIndex(a=>a.studentId===e.id)===-1){window.alert("Student review not submitted. Certification cannot be processed.");return}this.studentForm.get("course")?.at(0)?.get("certification")?.patchValue({certificationStatus:L.certified,certificationDate:new Date().toDateString(),certificateId:e.id}),this.studentForm.updateValueAndValidity(),this.updateStudent(),this.generateCertificate()}))}generateCertificate(){let e=this.studentForm.value,i={id:e.id??"",issuedTo:e.name,courseTitle:e.course.name!=="CUSTOM"?e.course.name:e.course.customName,technologiesCovered:e.course.technology,duration:`${e.course.defaultDuration} months`,completionDate:e.course.certification?.certificationDate,certifiedBy:e.course.instructor??"",modeOfLearning:"Online",certificationType:e.course.certification?.certificationType,IssuedUnder:"Code Craft Learning"};this.subscriptions.add(O(this.firebaseService.saveNewData(E.certificates,i,e.id)).subscribe({next:()=>{console.log("Certificate generated successfully:",i),window.alert("Certificate generated successfully!")},error:a=>{console.error("Error generating certificate:",a),window.alert("Failed to generate certificate. Please try again.")}}))}loadAllCourses(){let e={description:"Custom Course",title:"CUSTOM",index:0,regularPrice:0,discountPrice:0,durationInMonth:0,technologies:[],allTechItems:[]},i=this.firebaseService.getAllFromCollection(E.coursePackages).subscribe(a=>{this.courseList=[e,...a]});this.subscriptions.add(i)}createId(){let i=this.studentForm.value.name.substring(0,2).toLowerCase(),a=Math.random().toString(36).substring(2,6);return i+a}ngOnDestroy(){this.subscriptions.unsubscribe()}get isReadyToCertify(){if(this.isEditMode){let e=this.studentForm.get("course")?.value[0];if(e.status===T.completed&&e.completionDate)return e.certification.certificationStatus===L.pending}return!1}get isCertified(){return this.studentForm.get("course")?.value[0]?.certification?.certificationStatus===L.certified}completionAfterEnrollmentValidator(e){let i=e.parent;if(!i)return null;let a=i.get("enrollmentDate")?.value,c=e.value;return a&&c&&new Date(c)<=new Date(a)?{completionBeforeEnrollment:!0}:null}static{this.\u0275fac=function(i){return new(i||r)(M(Z),M(A))}}static{this.\u0275cmp=V({type:r,selectors:[["app-create-student-modal"]],inputs:{isOpen:"isOpen",SelectedStudent:"SelectedStudent"},outputs:{onClose:"onClose"},decls:1,vars:1,consts:[["class","modal","tabindex","-1","role","dialog",4,"ngIf"],["tabindex","-1","role","dialog",1,"modal"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"flex","flex-row","gap-2","items-center"],["class","modal-title",4,"ngIf"],["class","button-accent-sm",3,"click",4,"ngIf"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[3,"formGroup"],[1,"modal-body"],[1,"grid","grid-cols-3","gap-8"],[1,"form-group"],["formControlName","name",1,"form-control"],["class","text-red-500",4,"ngIf"],["type","number","formControlName","age",1,"form-control"],["formControlName","gender",1,"form-control"],["value",""],["value","Male"],["value","Female"],["value","Other"],["formGroupName","contact"],["formControlName","email",1,"form-control"],["formControlName","phone",1,"form-control"],["formControlName","alternatePhone",1,"form-control"],["formGroupName","address"],[1,"grid","grid-cols-5","gap-8"],["formControlName","street",1,"form-control"],["formControlName","city",1,"form-control"],["formControlName","state",1,"form-control"],["formControlName","zip",1,"form-control"],["formControlName","country",1,"form-control"],["formArrayName","course"],["class","border p-2 mb-2",3,"formGroupName",4,"ngFor","ngForOf"],["type","button","class","button-primary-sm",3,"click",4,"ngIf"],[3,"loading"],[1,"modal-footer"],[4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"modal-title"],[1,"button-accent-sm",3,"click"],[1,"text-red-500"],[1,"border","p-2","mb-2",3,"formGroupName"],["class","flex flex-row gap-4 align-middle",4,"ngIf"],[1,"grid","grid-cols-2","gap-8"],["formControlName","batchName",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"form-group","flex","flex-col","w-full","mb-3","border","border-dotted","border-1","border-black","px-4","py-1"],[1,"flex","flex-row","gap-2","flex-wrap","mb-2"],[4,"ngFor","ngForOf"],[1,"grid","grid-cols-4","gap-8"],["formControlName","customName",1,"form-control"],["formControlName","defaultDuration",1,"form-control"],["type","number","formControlName","price",1,"form-control"],["type","date","formControlName","enrollmentDate",1,"form-control"],["type","date","formControlName","completionDate",1,"form-control"],[1,"form-group","pointer-events-none"],["formControlName","instructor","readonly","",1,"form-control","bg-slate-300"],["readonly","",1,"bg-slate-300","form-control",3,"value"],["formGroupName","certification"],["formControlName","certificationType",1,"form-control"],[1,"flex","flex-row","gap-4","align-middle"],[1,"mb-2","text-text","underline","underline-offset-2"],["type","button",1,"mt-2","bg-red-300","px-4","rounded-lg",3,"click"],[3,"value"],[1,"bg-blue-300","rounded-lg","px-2","flex","flex-row","gap-4","items-center"],[1,"text-primary","text-sm"],["class","cursor-pointer text-black text-sm hover:text-red-500",3,"click",4,"ngIf"],[1,"cursor-pointer","text-black","text-sm","hover:text-red-500",3,"click"],["type","button",1,"button-primary-sm",3,"click"]],template:function(i,a){i&1&&u(0,It,88,24,"div",0),i&2&&d("ngIf",a.isOpen)},dependencies:[D,Q,R,K,Y,$,me,U,B,G,z,W,X,ee,te],styles:[".modal[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:#00000080;position:fixed;inset:0;height:100vh;width:100vw;z-index:1050}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:8px;width:70%;height:90%;overflow-y:auto;margin:2rem auto;box-shadow:0 4px 24px #0003}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{border:none;border-radius:8px;overflow:hidden}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.5rem;border-bottom:1px solid #e9ecef;background:#f8f9fa}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{background:transparent;border:none;font-size:1.5rem;cursor:pointer;color:#333;transition:color .2s}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover{color:#d9534f}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid #ced4da;border-radius:4px;font-size:1rem;transition:border-color .2s}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#d9534f;font-size:.875rem;margin-top:.25rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:1rem 1.5rem;border-top:1px solid #e9ecef;background:#f8f9fa}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px;margin-left:.5rem}"]})}}return r})();var Vt=(r,s,e)=>({"course-completed":r,"course-in-progress":s,"course-not-started":e}),Dt=(r,s,e)=>({"certification-certified":r,"certification-pending":s,"certification-not-applicable":e});function Bt(r,s){if(r&1&&(n(0,"option",33),o(1),t()),r&2){let e=s.$implicit;d("value",e),l(),h(e)}}function qt(r,s){if(r&1&&(n(0,"option",33),o(1),t()),r&2){let e=s.$implicit;d("value",e),l(),h(e)}}function At(r,s){if(r&1){let e=k();F(0),n(1,"tr",34)(2,"td",35),o(3),t(),n(4,"td",35),o(5),t(),n(6,"td",35),o(7),t(),n(8,"td",35),o(9),t(),n(10,"td",35),o(11),t(),n(12,"td",35),o(13),t(),n(14,"td",35),o(15),t(),n(16,"td",35),o(17),t(),n(18,"td",36),o(19),t(),n(20,"td",36),o(21),t(),n(22,"td",37)(23,"a",38),x("click",function(){let a=b(e).$implicit,c=g();return C(c.openStudent(a))}),o(24,"View"),t()()(),I()}if(r&2){let e=s.$implicit,i=g();l(3),h(e.id),l(2),h(e.name),l(2),h(e.age),l(2),h(e.gender),l(2),h(e.contact.email),l(2),h(e.contact.phone),l(2),h(e.course.name),l(2),h(i.getBatchName(e.course.batchName)),l(),d("ngClass",he(12,Vt,(e.course.status==null?null:e.course.status.toString())==="completed",(e.course.status==null?null:e.course.status.toString())==="in-progress",(e.course.status==null?null:e.course.status.toString())==="not-started")),l(),w(" ",e.course.status," "),l(),d("ngClass",he(16,Dt,(e.course.certification==null||e.course.certification.certificationStatus==null?null:e.course.certification.certificationStatus.toString())==="Certified",(e.course.certification==null||e.course.certification.certificationStatus==null?null:e.course.certification.certificationStatus.toString())==="Pending",(e.course.certification==null||e.course.certification.certificationStatus==null?null:e.course.certification.certificationStatus.toString())==="Not applicable")),l(),w(" ",e.course.certification==null?null:e.course.certification.certificationStatus," ")}}var We=(()=>{class r{constructor(e,i,a){this.firebaseService=e,this.activatedRoute=i,this.fb=a,this.createStudentModal=!1,this.allStudents=[],this.filteredStudents=[],this.courseStatus=["",...Object.values(T)],this.certificationStatus=["",...Object.values(L)],this.subscriptions=new N,this.courses=[],this.availableBatches=[],this.filterForm=this.fb.group({id:[""],name:[""],email:[""],phone:[""],courseName:[""],batchName:[""],courseStatus:[""],certificationStatus:[""]})}ngOnInit(){this.loadAllCourses(),this.loadAllStudents(),this.loadParams(),this.filterFormChange(),this.loadAllBatches()}loadAllBatches(){this.subscriptions.add(this.firebaseService.getAllFromCollection(E.batches).subscribe(e=>{this.availableBatches=e}))}getBatchName(e){if(!e)return"N/A";let i=this.availableBatches.find(a=>a.id===e);return i?i.name:"N/A"}filterFormChange(){let e=this.filterForm.valueChanges.subscribe(()=>{this.filterStudentsOnChange()});this.subscriptions.add(e)}filterStudentsOnChange(){let e=this.filterForm.value,i=this.allStudents;Object.keys(e).forEach(a=>{let c=""+e[a];if(c)switch(a){case"id":i=i.filter(m=>m.id?.toLowerCase().startsWith(c.trim().toLowerCase()));break;case"name":i=i.filter(m=>m.name?.toLowerCase().startsWith(c.trim().toLowerCase()));break;case"email":i=i.filter(m=>m.contact.email?.toLowerCase().startsWith(c.trim().toLowerCase()));break;case"phone":i=i.filter(m=>m.contact.phone?.toLowerCase().startsWith(c.trim().toLowerCase()));break;case"courseName":i=i.filter(m=>m.course.name?.toLowerCase().startsWith(c.trim().toLowerCase())||m.course.customName?.toLowerCase().startsWith(c.trim().toLowerCase()));break;case"batchName":i=i.filter(m=>m.course.batchName?.toLowerCase().startsWith(c.trim().toLowerCase()));break;case"courseStatus":i=i.filter(m=>m.course.status?.toLowerCase().startsWith(c.trim().toLowerCase()));break;case"certificationStatus":i=i.filter(m=>m.course.certification?.certificationStatus?.toLowerCase().startsWith(c.trim().toLowerCase()));break}}),this.filteredStudents=i}loadAllCourses(){this.subscriptions.add(this.firebaseService.getAllFromCollection(E.coursePackages,"title").subscribe(e=>{this.courses=e}))}loadParams(){this.subscriptions.add(this.activatedRoute.queryParams.subscribe(e=>{e.enquiryId&&this.firebaseService.getFromCollectionById(E.enquiries,e.enquiryId).subscribe(i=>{this.openStudent(this.loadStudentWithEnquiry(i))})}))}loadStudentWithEnquiry(e){let i={name:e.fullName,age:e.age,contact:{email:e.email,phone:e.contactNumber}};(e.packageName===void 0||e.packageName===null)&&(i.course={name:"CUSTOM",technology:e.technologies});let a=this.courses.find(c=>c.title===e.packageName);return a&&(i.course={name:a.title,defaultDuration:a.durationInMonth,technology:a.allTechItems,price:a.discountPrice}),i}openStudent(e){this.selectedStudent=e,this.createStudentModal=!0}closeStudentModal(){this.createStudentModal=!1,this.selectedStudent=void 0}loadAllStudents(){this.subscriptions.add(this.firebaseService.getAllFromCollection(E.students,"id").subscribe(e=>{this.allStudents=e.sort((i,a)=>(i?.course?.enrollmentDate??1)<(a?.course?.enrollmentDate??0)?-1:1),this.filteredStudents=this.allStudents}))}ngOnDestroy(){this.subscriptions.unsubscribe()}static{this.\u0275fac=function(i){return new(i||r)(M(A),M(Ne),M(Z))}}static{this.\u0275cmp=V({type:r,selectors:[["app-students"]],decls:73,vars:6,consts:[[1,"flex","flex-col","gap-2","absolute","left-0","px-10","w-full","-mt-6"],[1,"border","border-primary","rounded-lg","px-4","py-2"],[1,"text-base","font-semibold","text-primary","px-2"],[1,"flex","flex-row","justify-start","flex-wrap","gap-4","form-group",3,"formGroup"],[1,"flex","flex-col","gap-1"],["for","idFilter"],["id","idFilter","type","text","formControlName","id",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","nameFilter"],["id","nameFilter","type","text","formControlName","name",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","emailFilter"],["id","emailFilter","type","text","formControlName","email",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","phoneFilter"],["id","phoneFilter","type","text","formControlName","phone",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","courseNameFilter"],["id","courseNameFilter","type","text","formControlName","courseName",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","batchNameFilter"],["id","batchNameFilter","type","text","formControlName","batchName",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","courseStatusFilter"],["id","courseStatusFilter","formControlName","courseStatus",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],[3,"value",4,"ngFor","ngForOf"],["for","certificationStatusFilter"],["id","certificationStatusFilter","formControlName","certificationStatus",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","px-4","py-1","text-left","rounded-lg"],[1,"flex","flex-row","gap-6","items-center","h-10","justify-between"],[1,"button-primary-xs",3,"click"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],[3,"onClose","isOpen","SelectedStudent"],[3,"value"],[1,"py-2","h-5","text-xs","font-poppins","bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text","hover:outline","hover:outline-1","hover:outline-black","hover:bg-yellow-50"],[1,"px-6"],[1,"px-6",3,"ngClass"],[1,"px-6","text-center"],[1,"text-blue","underline","underline-offset-2","cursor-pointer",3,"click"]],template:function(i,a){i&1&&(n(0,"div",0)(1,"fieldset",1)(2,"legend",2),o(3,"Filter"),t(),n(4,"form",3)(5,"div",4)(6,"label",5),o(7,"Id"),t(),p(8,"input",6),t(),n(9,"div",4)(10,"label",7),o(11,"Name"),t(),p(12,"input",8),t(),n(13,"div",4)(14,"label",9),o(15,"Email"),t(),p(16,"input",10),t(),n(17,"div",4)(18,"label",11),o(19,"Phone"),t(),p(20,"input",12),t(),n(21,"div",4)(22,"label",13),o(23,"Course Name"),t(),p(24,"input",14),t(),n(25,"div",4)(26,"label",15),o(27,"Batch Name"),t(),p(28,"input",16),t(),n(29,"div",4)(30,"label",17),o(31,"Course Status"),t(),n(32,"select",18),u(33,Bt,2,2,"option",19),t()(),n(34,"div",4)(35,"label",20),o(36,"Certification Status"),t(),n(37,"select",21),u(38,qt,2,2,"option",19),t()()()(),n(39,"div",22)(40,"table",23)(41,"caption",24)(42,"div",25)(43,"span"),o(44,"Student List"),t(),n(45,"button",26),x("click",function(){return a.createStudentModal=!0}),o(46,"+ Create Student"),t()()(),n(47,"thead",27)(48,"tr",28)(49,"th",29),o(50,"Id"),t(),n(51,"th",29),o(52,"Name"),t(),n(53,"th",29),o(54,"Age"),t(),n(55,"th",29),o(56,"Gender"),t(),n(57,"th",29),o(58,"Email"),t(),n(59,"th",29),o(60,"Phone"),t(),n(61,"th",29),o(62,"Course Name"),t(),n(63,"th",29),o(64,"Batch Name"),t(),n(65,"th",29),o(66,"Course Status"),t(),n(67,"th",29),o(68,"Certification Status"),t(),p(69,"th",29),t()(),n(70,"tbody",30),u(71,At,25,20,"ng-container",31),t()()()(),n(72,"app-create-student-modal",32),x("onClose",function(){return a.closeStudentModal()}),t()),i&2&&(l(4),d("formGroup",a.filterForm),l(29),d("ngForOf",a.courseStatus),l(5),d("ngForOf",a.certificationStatus),l(33),d("ngForOf",a.filteredStudents),l(),d("isOpen",a.createStudentModal)("SelectedStudent",a.selectedStudent))},dependencies:[Ie,D,R,K,Y,$,U,B,G,z,W,ze],styles:[".certification-certified[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.certification-pending[_ngcontent-%COMP%]{background-color:#fff3cd;color:#856404}.certification-not-applicable[_ngcontent-%COMP%]{background-color:#e2e3e5;color:#383d41}.course-completed[_ngcontent-%COMP%]{background-color:#cce5ff;color:#004085}.course-in-progress[_ngcontent-%COMP%]{background-color:#fffbe6;color:#856404}.course-not-started[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24}"]})}}return r})();var ae=(r,s)=>{let e=ye($e);return Ge(e).pipe(Se(1),Ce(i=>i?!0:(window.alert("You must be logged in to access this page"),!1)))};function jt(r,s){if(r&1){let e=k();n(0,"label",15)(1,"input",16),we("ngModelChange",function(a){let c=b(e).$implicit,m=g();return Me(m.selectedStatuses[c],a)||(m.selectedStatuses[c]=a),C(a)}),t(),n(2,"span"),o(3),t()()}if(r&2){let e=s.$implicit,i=g();l(),d("value",e),Pe("ngModel",i.selectedStatuses[e]),l(2),h(e)}}function Lt(r,s){if(r&1){let e=k();F(0),n(1,"tr",17)(2,"td",18),o(3),t(),n(4,"td",18),o(5),t(),n(6,"td",18),o(7),t(),n(8,"td",18),o(9),t(),n(10,"td",18),o(11),t(),n(12,"td",18),o(13),Oe(14,"timestampPipe"),t(),n(15,"td",18),o(16),t(),n(17,"td",18),o(18),t(),n(19,"td",18),o(20),t(),n(21,"td",18),o(22),t(),n(23,"td",18),o(24),t(),n(25,"td",19)(26,"a",20),x("click",function(){let a=b(e).$implicit,c=g();return C(c.viewEnquiry(a))}),o(27,"View"),t(),n(28,"a",21),x("click",function(){let a=b(e).$implicit,c=g();return C(c.confirmEnquiry(a))}),o(29,"Confirm"),t(),n(30,"a",22),x("click",function(){let a=b(e).$implicit,c=g();return C(c.cancelEnquiry(a))}),o(31,"Cancel"),t()()(),I()}if(r&2){let e=s.$implicit;l(),ke(e.status),l(2),h(e.id),l(2),h(e.fullName),l(2),h(e.age),l(2),h(e.email),l(2),h(e.contactNumber),l(2),h(Fe(14,13,e.createdDate)),l(3),h(e.packageName),l(2),h(e.technologies.join(", ")),l(2),h(e.enquiryPrice),l(2),h(e.status),l(2),h(e.notes)}}var Ue=(()=>{class r{constructor(e,i){this.firebaseService=e,this.router=i,this.loading=!1,this.enquiries=[],this.enquiryStatus=Object.values(q),this.selectedStatuses={[q.pending]:!0,[q.confirmed]:!0,[q.cancelled]:!0,[q.contacted]:!0},this.subscription=new N}ngOnInit(){this.getEnquiries()}get filteredEnquiries(){return this.enquiries.filter(e=>this.selectedStatuses[e.status||q.pending])}removeEnquiry(e){if(!e||!e.id){console.error("Invalid enquiry data:",e);return}if(confirm(`Are you sure you want to delete the enquiry from ${e.fullName}?`)){this.loading=!0;let i=O(this.firebaseService.deleteData(E.enquiries,e.id)).subscribe(()=>{this.enquiries=this.enquiries.filter(a=>a.id!==e.id),this.loading=!1},a=>{console.error("Error deleting enquiry:",a),this.loading=!1});this.subscription.add(i)}}cancelEnquiry(e){let i=window.prompt("Reason for cancellation:");if(!i){window.alert("Cancellation reason is required.");return}e.notes=i,e.status=q.cancelled,this.updateEnquiry(e)}viewEnquiry(e){let i=window.prompt("Message / updates:");if(!i){window.alert("message is required.");return}e.notes=i,e.status=q.contacted,this.updateEnquiry(e)}confirmEnquiry(e){window.confirm(`Are you sure you want to confirm the enquiry from ${e.fullName}?`)&&(e.status=q.confirmed,this.updateEnquiry(e),this.router.navigate(["/admin/students"],{queryParams:{enquiryId:e.id}}))}updateEnquiry(e){if(!e||!e.id){console.error("Invalid enquiry data:",e);return}this.loading=!0;let i=O(this.firebaseService.updateData(E.enquiries,e.id,e)).subscribe(()=>{let a=this.enquiries.findIndex(c=>c.id===e.id);a!==-1&&(this.enquiries[a]=e),this.loading=!1},a=>{console.error("Error updating enquiry:",a),this.loading=!1});this.subscription.add(i)}getEnquiries(){this.loading=!0;let e=this.firebaseService.getAllFromCollection(E.enquiries,"id").subscribe(i=>{this.enquiries=i,this.loading=!1},i=>{console.error("Error fetching enquiries:",i),this.loading=!1});this.subscription.add(e)}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(i){return new(i||r)(M(A),M(Ve))}}static{this.\u0275cmp=V({type:r,selectors:[["app-enquiry"]],decls:40,vars:3,consts:[[1,"flex","flex-col","gap-6","absolute","left-0","px-10","w-full"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","p-4","text-left","rounded-lg"],[1,"flex","flex-row","justify-between"],[1,"flex","flex-row","gap-6","align-middle","h-10","items-center"],[1,"text-gray-500","text-sm"],[1,"flex","flex-row","gap-6"],[1,"flex","flex-row","gap-4","items-center"],["class","flex flex-row items-center gap-1",4,"ngFor","ngForOf"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],[1,"flex","flex-row","items-center","gap-1"],["type","checkbox",1,"accent-primary",3,"ngModelChange","value","ngModel"],[1,"bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text","status"],[1,"px-6","py-4"],[1,"px-6","py-4","text-center","flex","flex-row","gap-2"],[1,"text-","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"text-black","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"text-red-500","underline","underline-offset-2","cursor-pointer",3,"click"]],template:function(i,a){i&1&&(n(0,"div",0)(1,"div",1)(2,"table",2)(3,"caption",3)(4,"div",4)(5,"div",5)(6,"span"),o(7,"Enquiry List"),t(),n(8,"span",6),o(9),t()(),n(10,"div",7)(11,"div",8),u(12,jt,4,3,"label",9),t()()()(),n(13,"thead",10)(14,"tr",11)(15,"th",12),o(16,"Id"),t(),n(17,"th",12),o(18,"Name"),t(),n(19,"th",12),o(20,"Age"),t(),n(21,"th",12),o(22,"Email"),t(),n(23,"th",12),o(24,"Phone"),t(),n(25,"th",12),o(26,"Date"),t(),n(27,"th",12),o(28,"Package Name"),t(),n(29,"th",12),o(30,"Technologies"),t(),n(31,"th",12),o(32,"Enquiry Price"),t(),n(33,"th",12),o(34,"Status"),t(),n(35,"th",12),o(36,"Notes"),t(),p(37,"th",12),t()(),n(38,"tbody",13),u(39,Lt,32,15,"ng-container",14),t()()()()),i&2&&(l(9),w("Total Enquiries: ",a.enquiries.length,""),l(3),d("ngForOf",a.enquiryStatus),l(27),d("ngForOf",a.filteredEnquiries))},dependencies:[D,se,B,De,Re],styles:[".status.pending[_ngcontent-%COMP%]{background-color:#ffe082}.status.contacted[_ngcontent-%COMP%]{background-color:#b3e5fc}.status.cancelled[_ngcontent-%COMP%]{background-color:#ffcdd2}.status.confirmed[_ngcontent-%COMP%]{background-color:#c8e6c9}"]})}}return r})();function $t(r,s){if(r&1){let e=k();F(0),n(1,"tr",16)(2,"td",17),o(3),t(),n(4,"td",17),o(5),t(),n(6,"td",17),o(7),t(),n(8,"td",17),o(9),t(),n(10,"td",17),o(11),t(),n(12,"td",17),o(13),t(),n(14,"td",18)(15,"a",19),x("click",function(){let a=b(e).$implicit,c=g(2);return C(c.viewCourse(a))}),o(16,"View"),t()()(),I()}if(r&2){let e=s.$implicit;l(3),h(e.index),l(2),h(e.title),l(2),h(e.description),l(2),h(e.regularPrice),l(2),h(e.discountPrice),l(2),h(e.durationInMonth)}}function Gt(r,s){if(r&1){let e=k();n(0,"table",5)(1,"caption",6)(2,"div",7)(3,"div",8)(4,"span"),o(5,"Package List"),t(),n(6,"span",9),o(7),t(),n(8,"button",10),x("click",function(){b(e);let a=g();return C(a.createNewPackage())}),o(9,"Create new package"),t()()()(),n(10,"thead",11)(11,"tr",12)(12,"th",13),o(13,"Index"),t(),n(14,"th",13),o(15,"Title"),t(),n(16,"th",13),o(17,"Description"),t(),n(18,"th",13),o(19,"Regular Price"),t(),n(20,"th",13),o(21,"Discounted Price"),t(),n(22,"th",13),o(23,"Duration"),t(),p(24,"th",13),t()(),n(25,"tbody",14),u(26,$t,17,6,"ng-container",15),t()()}if(r&2){let e=g();l(7),w("Total Packages: ",e.packages.length,""),l(19),d("ngForOf",e.packages)}}function Rt(r,s){r&1&&(n(0,"h3",43),o(1,"Create Package"),t())}function zt(r,s){r&1&&(n(0,"h3",43),o(1,"Update Package"),t())}function Wt(r,s){r&1&&(n(0,"div",44),o(1," Index is required and must be 0 or greater. "),t())}function Ut(r,s){r&1&&(n(0,"div",44),o(1," Title is required. "),t())}function Kt(r,s){r&1&&(n(0,"div",44),o(1," Regular price is required and must be 0 or greater. "),t())}function Yt(r,s){r&1&&(n(0,"div",44),o(1," Discounted price is required and must be 0 or greater. "),t())}function Zt(r,s){r&1&&(n(0,"div",44),o(1," Duration is required and must be at least 1 month. "),t())}function Ht(r,s){r&1&&(n(0,"div",44),o(1," Description is required. "),t())}function Jt(r,s){if(r&1&&(n(0,"div",45)(1,"span",46),o(2),t()()),r&2){let e,i=g(2);l(2),w(" ",(e=i.packageForm.get("allTechItems"))==null||e.value==null?null:e.value.join(", ")," ")}}function Qt(r,s){if(r&1&&p(0,"app-dropdown",55),r&2){let e=g(3);d("items",e.availableTechnologies)("multiselect",!0)}}function Xt(r,s){if(r&1&&p(0,"app-dropdown",56),r&2){let e=g(3);d("items",e.packages)("multiselect",!0)}}function en(r,s){r&1&&(n(0,"select",57)(1,"option",58),o(2,"None"),t(),n(3,"option",59),o(4,"+"),t(),n(5,"option",60),o(6,"/"),t()())}function tn(r,s){if(r&1){let e=k();n(0,"div",47)(1,"label",48)(2,"input",49),x("ngModelChange",function(){let a=b(e).$implicit,c=g(2);return C(c.resetTechs(a))}),t(),n(3,"span"),o(4,"Is Package"),t()(),u(5,Qt,1,2,"app-dropdown",50)(6,Xt,1,2,"app-dropdown",51)(7,en,7,0,"select",52),n(8,"button",53),x("click",function(){let a=b(e).index,c=g(2);return C(c.technologies.removeAt(a))}),o(9,"-Remove"),t(),n(10,"span",54),o(11),t()()}if(r&2){let e,i,a,c=s.$implicit,m=s.index,S=g(2);d("formGroupName",m),l(5),d("ngIf",!((e=c.get("isPackage"))!=null&&e.value)),l(),d("ngIf",(i=c.get("isPackage"))==null?null:i.value),l(),d("ngIf",((a=c.get("techs"))==null||a.value==null?null:a.value.length)>1||((a=c.get("packages"))==null||a.value==null?null:a.value.length)>1),l(4),h(S.getTechString(c))}}function nn(r,s){if(r&1){let e=k();n(0,"button",61),x("click",function(){b(e);let a=g(2);return C(a.deletePackage())}),o(1," Delete Package "),t()}}function on(r,s){if(r&1){let e=k();n(0,"div",20)(1,"div",21)(2,"div",22),u(3,Rt,2,0,"h3",23)(4,zt,2,0,"h3",23),n(5,"button",24),x("click",function(){b(e);let a=g();return C(a.closeCourse())}),o(6," \xD7 "),t()(),p(7,"app-loader",2),n(8,"form",25)(9,"div",26)(10,"div")(11,"label",27),o(12,"Index"),t(),p(13,"input",28),u(14,Wt,2,0,"div",29),t(),n(15,"div")(16,"label",27),o(17,"Title"),t(),p(18,"input",30),u(19,Ut,2,0,"div",29),t(),n(20,"div")(21,"label",27),o(22,"Regular Price"),t(),p(23,"input",31),u(24,Kt,2,0,"div",29),t()(),n(25,"div",26)(26,"div")(27,"label",27),o(28,"Discounted Price"),t(),p(29,"input",32),u(30,Yt,2,0,"div",29),t(),n(31,"div")(32,"label",27),o(33,"Duration (Months)"),t(),p(34,"input",33),u(35,Zt,2,0,"div",29),t(),n(36,"div")(37,"label",27),o(38,"Description"),t(),p(39,"input",34),u(40,Ht,2,0,"div",29),t()(),u(41,Jt,3,1,"div",35),n(42,"div")(43,"label",27),o(44,"Technologies"),t(),n(45,"div",36),u(46,tn,12,5,"div",37),n(47,"button",38),x("click",function(){b(e);let a=g();return C(a.addTechnology())}),o(48,"Add Technology"),t()()(),n(49,"div",39)(50,"button",40),x("click",function(){b(e);let a=g();return C(a.onSubmit())}),o(51),t(),u(52,nn,2,0,"button",41),n(53,"button",42),x("click",function(){b(e);let a=g();return C(a.closeCourse())}),o(54,"Cancel"),t()()()()()}if(r&2){let e,i,a,c,m,S,y,f=g();l(3),d("ngIf",!f.selectedPackage),l(),d("ngIf",f.selectedPackage),l(3),d("loading",f.packageProcessing),l(),J("hidden",f.packageProcessing),d("formGroup",f.packageForm),l(6),d("ngIf",((e=f.packageForm.get("index"))==null?null:e.invalid)&&((e=f.packageForm.get("index"))==null?null:e.touched)),l(5),d("ngIf",((i=f.packageForm.get("title"))==null?null:i.invalid)&&((i=f.packageForm.get("title"))==null?null:i.touched)),l(5),d("ngIf",((a=f.packageForm.get("regularPrice"))==null?null:a.invalid)&&((a=f.packageForm.get("regularPrice"))==null?null:a.touched)),l(6),d("ngIf",((c=f.packageForm.get("discountPrice"))==null?null:c.invalid)&&((c=f.packageForm.get("discountPrice"))==null?null:c.touched)),l(5),d("ngIf",((m=f.packageForm.get("durationInMonth"))==null?null:m.invalid)&&((m=f.packageForm.get("durationInMonth"))==null?null:m.touched)),l(5),d("ngIf",((S=f.packageForm.get("description"))==null?null:S.invalid)&&((S=f.packageForm.get("description"))==null?null:S.touched)),l(),d("ngIf",(y=f.packageForm.get("allTechItems"))==null||y.value==null?null:y.value.length),l(5),d("ngForOf",f.technologies.controls),l(5),w(" ",f.selectedPackage?"Update":"Create"," Package "),l(),d("ngIf",!!f.selectedPackage)}}var Ke=(()=>{class r{constructor(e,i){this.firebaseService=e,this.fb=i,this.loading=!0,this.packages=[],this.isOpen=!1,this.subscription=new N,this.availableTechnologies=[],this.packageProcessing=!1,this.packageForm=this.fb.group({index:[null,[_.required,_.min(0)]],title:[null,_.required],description:[null,_.required],regularPrice:[null,[_.required,_.min(0)]],discountPrice:[null,[_.required,_.min(0)]],durationInMonth:[null,[_.required,_.min(1)]],allTechItems:[[]],technologies:this.fb.array([])})}get technologies(){return this.packageForm.get("technologies")}addTechnology(e){this.technologies.push(this.fb.group({techs:[[]],packages:[[]],isPackage:[e?.isPackage||!1],combinationBy:[e?.combinationBy||""]}))}removeTechnology(e){this.technologies.removeAt(e)}ngOnInit(){this.fetchPackages()}createNewPackage(){this.isOpen=!0,this.selectedPackage=void 0,this.packageForm.reset(),this.technologies.clear(),this.packageForm.setControl("technologies",this.fb.array([])),this.packageForm.patchValue({index:this.packages.length+1,title:null,description:null,regularPrice:null,discountPrice:null,durationInMonth:null,allTechItems:[]}),this.packageForm.updateValueAndValidity(),this.addTechnology()}viewCourse(e){this.isOpen=!0,this.selectedPackage=e,this.packageForm.reset(),this.technologies.clear();let i=e.technologies||[];i.forEach(a=>{if(a.isPackage){let c=[];a.name.forEach(m=>{let S=this.packages.find(y=>y.title===m);S&&c.push(S)}),this.technologies.push(this.fb.group({packages:[c],techs:[[]],isPackage:[!0],combinationBy:[a.combinationBy||""]}))}else this.technologies.push(this.fb.group({techs:[a.name],packages:[[]],isPackage:[!1],combinationBy:[a.combinationBy||""]}))}),this.packageForm.patchValue({index:e.index,title:e.title,description:e.description,regularPrice:e.regularPrice,discountPrice:e.discountPrice,durationInMonth:e.durationInMonth,allTechItems:e.allTechItems||[],technologies:i}),this.packageForm.updateValueAndValidity()}closeCourse(){this.selectedPackage=void 0,this.technologies.clear(),this.isOpen=!1}getTechString(e){return e.get("isPackage")?.value?`${e.get("packages")?.value?.map(i=>i.title)?.join(" "+e.get("combinationBy")?.value+" ")}`:`${e.get("techs")?.value?.join(" "+e.get("combinationBy")?.value+" ")}`}resetTechs(e){e.get("packages")?.setValue([]),e.get("techs")?.setValue([]),e.updateValueAndValidity()}deletePackage(){if(!this.selectedPackage)return;let e=this.selectedPackage.id;e&&confirm("Are you sure you want to delete this package?")&&(this.packageProcessing=!0,this.subscription.add(O(this.firebaseService.deleteData(E.coursePackages,e)).subscribe({next:()=>{window.alert("Package deleted successfully"),this.selectedPackage=void 0,this.technologies.clear(),this.packageForm.reset(),this.packageProcessing=!1,this.isOpen=!1,this.fetchPackages()},error:i=>{this.packageProcessing=!1,window.alert("Error deleting package:")}})))}onSubmit(){if(this.packageForm.invalid){this.packageForm.markAllAsTouched();return}this.packageProcessing=!0;let e=this.packageForm.value,i={index:e.index,title:e.title,description:e.description,regularPrice:e.regularPrice,discountPrice:e.discountPrice,durationInMonth:e.durationInMonth,allTechItems:e.allTechItems||[]},a=[],c=new Set;e.technologies.forEach(m=>{if(m.isPackage){let S={name:m.packages.map(y=>y.title),isPackage:!0,combinationBy:m.combinationBy,iconUrl:[]};m.packages.forEach(y=>{y.allTechItems.forEach(f=>{c.add(f)})}),a.push(S)}else{let S={name:m.techs,isPackage:!1,combinationBy:m.combinationBy,iconUrl:[]};m.techs.forEach(y=>{c.add(y)}),a.push(S)}}),i.technologies=a,i.allTechItems=Array.from(c),this.subscription.add(O(this.firebaseService.saveNewData(E.coursePackages,i)).subscribe({next:()=>{window.alert("Package created successfully"),this.fetchPackages(),this.packageProcessing=!1,this.isOpen=!1},error:m=>{window.alert("Error creating package:"),this.packageProcessing=!1}}))}loadAllTechnologies(){let e=new Set;this.packages.forEach(i=>{i.allTechItems.forEach(a=>{e.add(a)})}),this.availableTechnologies=Array.from(e)}fetchPackages(){this.loading=!0,this.subscription.add(this.firebaseService.getAllFromCollection(E.coursePackages).subscribe({next:e=>{console.log(e),this.packages=e.sort((i,a)=>i.index-a.index),this.loading=!1,this.loadAllTechnologies()},error:e=>{console.error("Error fetching packages:",e),this.loading=!1}}))}static{this.\u0275fac=function(i){return new(i||r)(M(A),M(Z))}}static{this.\u0275cmp=V({type:r,selectors:[["app-packages"]],decls:5,vars:3,consts:[[1,"flex","flex-col","gap-6","absolute","left-0","px-10","w-full"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg","mb-32"],[3,"loading"],["class","w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400 rounded-lg",4,"ngIf"],["class","fixed inset-0 z-30 flex items-center justify-center bg-black bg-opacity-40 backdrop-blur-sm ",4,"ngIf"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","p-4","text-left","rounded-lg"],[1,"flex","flex-row","justify-between"],[1,"flex","flex-row","gap-6","align-middle","h-10","items-center"],[1,"text-gray-500","text-sm"],[1,"button-primary-sm",3,"click"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],[1,"bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text"],[1,"px-6","py-4"],[1,"px-6","py-4","text-center","flex","flex-row","gap-2"],[1,"text-","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"fixed","inset-0","z-30","flex","items-center","justify-center","bg-black","bg-opacity-40","backdrop-blur-sm"],[1,"relative","z-40","bg-secondary","rounded-lg","shadow-lg","p-6","w-1/2","max-h-[85vh]","overflow-y-auto"],[1,"flex","flex-row","justify-between","w-full","bg-primary","py-3","px-5","text-white","rounded-lg","align-middle"],["class","text-lg font-semibold ",4,"ngIf"],["aria-label","Close",1,"text-3xl","font-semibold","cursor-pointer","hover:text-gray-300","transition-colors",3,"click"],[1,"mt-6","flex","flex-col","gap-6",3,"formGroup"],[1,"grid","grid-cols-3","gap-4"],[1,"block","mb-1","font-medium"],["type","number","formControlName","index","min","0","readonly","",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["class","text-red-500 text-xs",4,"ngIf"],["type","text","formControlName","title",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","number","formControlName","regularPrice","min","0",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","number","formControlName","discountPrice","min","0",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","number","formControlName","durationInMonth","min","1",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["formControlName","description","rows","3",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["class","bg-slate-300 px-4 py-2 border border-1 border-primary rounded-lg w-full",4,"ngIf"],["formArrayName","technologies",1,"flex","flex-col","w-full","gap-4"],["class","flex flex-row gap-4 items-center",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"button-primary-sm","mt-2","w-fit",3,"click"],[1,"flex","justify-end","gap-4","mt-4"],["type","submit",1,"button-primary-sm",3,"click"],["type","submit","class","button-primary-sm bg-red-500",3,"click",4,"ngIf"],["type","button",1,"button-secondary-sm",3,"click"],[1,"text-lg","font-semibold"],[1,"text-red-500","text-xs"],[1,"bg-slate-300","px-4","py-2","border","border-1","border-primary","rounded-lg","w-full"],[1,"text-primary","text-lg","font-outfit"],[1,"flex","flex-row","gap-4","items-center",3,"formGroupName"],[1,"flex","items-center","gap-1"],["type","checkbox","formControlName","isPackage",3,"ngModelChange"],["formControlName","techs",3,"items","multiselect",4,"ngIf"],["formControlName","packages","labelKey","title",3,"items","multiselect",4,"ngIf"],["formControlName","combinationBy","class","px-4 py-2 border border-black rounded-lg",4,"ngIf"],["type","button",1,"text-red-600","font-semibold","text-lg",3,"click"],[1,"text-gray-600"],["formControlName","techs",3,"items","multiselect"],["formControlName","packages","labelKey","title",3,"items","multiselect"],["formControlName","combinationBy",1,"px-4","py-2","border","border-black","rounded-lg"],["value",""],["value","+"],["value","/"],["type","submit",1,"button-primary-sm","bg-red-500",3,"click"]],template:function(i,a){i&1&&(n(0,"div",0)(1,"div",1),p(2,"app-loader",2),u(3,Gt,27,2,"table",3),t()(),u(4,on,55,16,"div",4)),i&2&&(l(2),d("loading",a.loading),l(),d("ngIf",!a.loading),l(),d("ngIf",a.isOpen))},dependencies:[D,Q,R,K,Y,$,me,se,U,B,G,Be,z,W,X,ee,te,ue]})}}return r})();function rn(r,s){if(r&1&&(n(0,"span"),o(1),p(2,"br"),t()),r&2){let e=s.$implicit;l(),w("",e," ")}}function an(r,s){if(r&1){let e=k();F(0),n(1,"tr",12)(2,"td",13),o(3),t(),n(4,"td",13),o(5),t(),n(6,"td",13),o(7),t(),n(8,"td",13),o(9),t(),n(10,"td",13),o(11),t(),n(12,"td",13),o(13),t(),n(14,"td",13),o(15),t(),n(16,"td",13),u(17,rn,3,1,"span",10),t(),n(18,"td",13),o(19),t(),n(20,"td",14)(21,"a",15),x("click",function(){let a=b(e).$implicit,c=g();return C(c.openBatch(a))}),o(22,"View"),t()()(),I()}if(r&2){let e=s.$implicit,i=g();l(3),h(e.id),l(2),h(e.name),l(2),h(e.instructorName),l(2),h(e.strength),l(2),h(e.startDate),l(2),h(e.endDate),l(2),h(e.status),l(2),d("ngForOf",i.getFormattedSchedule(e.weeklySchedule)),l(2),h(e.description)}}function ln(r,s){r&1&&(n(0,"div",43),o(1," Id is required. "),t())}function dn(r,s){r&1&&(n(0,"div",43),o(1," Name is required. "),t())}function cn(r,s){r&1&&(n(0,"div",43),o(1," Status is required. "),t())}function sn(r,s){r&1&&(n(0,"div",43),o(1," Instructor is required. "),t())}function mn(r,s){r&1&&(n(0,"div",43),o(1," Start date is required. "),t())}function un(r,s){r&1&&(n(0,"div",43),o(1," End date is required. "),t())}function pn(r,s){r&1&&(n(0,"div",43),o(1," End date cannot be before start date. "),t())}function gn(r,s){if(r&1&&(n(0,"option",51),o(1),t()),r&2){let e=s.$implicit;d("value",e),l(),h(e)}}function fn(r,s){r&1&&(n(0,"div",43),o(1," Day is required. "),t())}function _n(r,s){r&1&&(n(0,"div",43),o(1," Start Time is required. "),t())}function hn(r,s){r&1&&(n(0,"div",43),o(1," End Time is required. "),t())}function xn(r,s){r&1&&(n(0,"div",43),o(1," End time cannot be before start time. "),t())}function vn(r,s){if(r&1){let e=k();n(0,"button",52),x("click",function(){b(e);let a=g().index,c=g(2);return C(c.removeSchedule(a))}),o(1," - Remove"),t()}}function bn(r,s){if(r&1&&(n(0,"div",44)(1,"div")(2,"select",45)(3,"option",46),o(4,"Select Day"),t(),u(5,gn,2,2,"option",47),t(),u(6,fn,2,0,"div",27),t(),n(7,"div"),p(8,"input",48),u(9,_n,2,0,"div",27),t(),n(10,"div"),p(11,"input",49),u(12,hn,2,0,"div",27)(13,xn,2,0,"div",27),t(),u(14,vn,2,0,"button",50),t()),r&2){let e,i,a,c,m=s.$implicit,S=s.index,y=g(2);d("formGroupName",S),l(5),d("ngForOf",y.weekDays),l(),d("ngIf",((e=m.get("day"))==null?null:e.touched)&&((e=m.get("day"))==null?null:e.invalid)),l(3),d("ngIf",((i=m.get("startTime"))==null?null:i.touched)&&((i=m.get("startTime"))==null?null:i.invalid)),l(3),d("ngIf",((a=m.get("endTime"))==null?null:a.touched)&&((a=m.get("endTime"))==null?null:a.invalid)),l(),d("ngIf",(m.errors==null?null:m.errors.endTimeBeforeStartTime)&&(((c=m.get("endTime"))==null?null:c.touched)||((c=m.get("startTime"))==null?null:c.touched))),l(),d("ngIf",y.weeklySchedule.length>1)}}function Cn(r,s){if(r&1){let e=k();n(0,"button",53),x("click",function(){b(e);let a=g(2);return C(a.removeBatch())}),o(1,"Remove Batch"),t()}}function Sn(r,s){if(r&1){let e=k();n(0,"div",16)(1,"div",17)(2,"div",18)(3,"div",19)(4,"span",20),o(5),t(),n(6,"button",21),x("click",function(){b(e);let a=g();return C(a.showModal=!1)}),o(7,"\xD7"),t()(),n(8,"form",22)(9,"div",23)(10,"div",24)(11,"div",25)(12,"label"),o(13,"Id"),t(),p(14,"input",26),u(15,ln,2,0,"div",27),t(),n(16,"div",28)(17,"label"),o(18,"Name"),t(),p(19,"input",29),u(20,dn,2,0,"div",27),t(),n(21,"div",25)(22,"label"),o(23,"Status"),t(),p(24,"input",30),u(25,cn,2,0,"div",27),t()(),n(26,"div",24)(27,"div",28)(28,"label"),o(29,"Instructor"),t(),p(30,"input",31),u(31,sn,2,0,"div",27),t(),n(32,"div",28)(33,"label"),o(34,"Start Date"),t(),p(35,"input",32),u(36,mn,2,0,"div",27),t(),n(37,"div",28)(38,"label"),o(39,"End Date"),t(),p(40,"input",33),u(41,un,2,0,"div",27)(42,pn,2,0,"div",27),t()(),n(43,"div",24)(44,"div",28)(45,"label"),o(46,"Description"),t(),p(47,"input",34),t()(),n(48,"div",28)(49,"div",35)(50,"label"),o(51,"Weekly Schedule "),t(),n(52,"button",36),x("click",function(){b(e);let a=g();return C(a.addSchedule())}),o(53,"+ Add Day "),t()(),n(54,"div",37),u(55,bn,15,7,"div",38),t()()(),n(56,"div",39)(57,"button",40),x("click",function(){b(e);let a=g();return C(a.showModal=!1)}),o(58,"Cancel"),t(),n(59,"button",41),x("click",function(){b(e);let a=g();return C(a.onSubmit())}),o(60),t(),u(61,Cn,2,0,"button",42),t()()()()()}if(r&2){let e,i,a,c,m,S,y,f=g();l(5),w("",f.selectedBatch?"Update":"Create"," Batch"),l(3),d("formGroup",f.batchForm),l(7),d("ngIf",((e=f.batchForm.get("id"))==null?null:e.touched)&&((e=f.batchForm.get("id"))==null?null:e.invalid)),l(5),d("ngIf",((i=f.batchForm.get("name"))==null?null:i.touched)&&((i=f.batchForm.get("name"))==null?null:i.invalid)),l(5),d("ngIf",((a=f.batchForm.get("status"))==null?null:a.touched)&&((a=f.batchForm.get("status"))==null?null:a.invalid)),l(6),d("ngIf",((c=f.batchForm.get("instructorName"))==null?null:c.touched)&&((c=f.batchForm.get("instructorName"))==null?null:c.invalid)),l(5),d("ngIf",((m=f.batchForm.get("startDate"))==null?null:m.touched)&&((m=f.batchForm.get("startDate"))==null?null:m.invalid)),l(5),d("ngIf",((S=f.batchForm.get("endDate"))==null?null:S.touched)&&((S=f.batchForm.get("endDate"))==null?null:S.invalid)),l(),d("ngIf",(f.batchForm.errors==null?null:f.batchForm.errors.endDateBeforeStartDate)&&(((y=f.batchForm.get("endDate"))==null?null:y.touched)||((y=f.batchForm.get("startDate"))==null?null:y.touched))),l(13),d("ngForOf",f.weeklySchedule.controls),l(5),h(f.selectedBatch?"Update":"Create"),l(),d("ngIf",f.selectedBatch)}}var Ye=(()=>{class r{constructor(e,i){this.fb=e,this.fireBaseService=i,this.showModal=!1,this.weekDays=Object.values(Le),this.batches=[],this.students=[],this.subscription=new N,this.batchForm=this.fb.group({id:[""],name:["",_.required],startDate:[null,_.required],endDate:[null],status:[null],instructorName:["",_.required],weeklySchedule:this.fb.array([this.fb.group({day:[null,_.required],startTime:["",_.required],endTime:["",_.required]},{validators:a=>{let c=a.get("startTime")?.value,m=a.get("endTime")?.value;return c&&m&&m<c?{endTimeBeforeStartTime:!0}:null}})]),description:[""]},{validators:a=>{let c=a.get("startDate")?.value,m=a.get("endDate")?.value;return c&&m&&new Date(m)<new Date(c)?{endDateBeforeStartDate:!0}:null}}),this.setStartDateChanges()}setStartDateChanges(){this.subscription.add(this.batchForm.get("startDate")?.valueChanges.subscribe(()=>{this.batchForm.patchValue({status:this.calculateBatchStatus()}),this.batchForm.updateValueAndValidity()}))}calculateBatchStatus(){let e=this.batchForm.get("startDate")?.value,i=this.batchForm.get("endDate")?.value,a=new Date;return e&&a<new Date(e)?pe.notStarted:i&&a>new Date(i)?pe.completed:pe.inProgress}ngOnInit(){this.fetchBatches(),this.loadAllStudents()}loadAllStudents(){this.subscription.add(this.fireBaseService.getAllFromCollection(E.students).subscribe({next:e=>{this.students=e||[],this.batches.forEach(i=>{i.strength=this.getBatchStrength(i.id)})},error:e=>{console.error("Error fetching students:",e)}}))}getBatchStrength(e){let i=0;return this.students.forEach(a=>{a.course.batchName===e&&i++}),i}fetchBatches(){this.subscription.add(this.fireBaseService.getAllFromCollection(E.batches).subscribe({next:e=>{this.batches=e||[]},error:e=>{console.error("Error fetching batches:",e)}}))}get weeklySchedule(){return this.batchForm.get("weeklySchedule")}addSchedule(e={day:null,startTime:"",endTime:""}){this.weeklySchedule.push(this.fb.group({day:[e?.day??null,_.required],startTime:[e?.startTime??"",_.required],endTime:[e?.endTime??"",_.required]}))}removeSchedule(e){this.weeklySchedule.removeAt(e)}onSubmit(){if(this.batchForm.valid){let e=le(oe({},this.batchForm.value),{id:this.batchForm.value.id||this.fireBaseService.generateId()});this.selectedBatch?this.subscription.add(O(this.fireBaseService.updateData(E.batches,this.selectedBatch.id,e)).subscribe({next:i=>{window.alert("Batch updated successfully")},error:i=>{window.alert("Failed to update batch")}})):this.subscription.add(O(this.fireBaseService.saveNewData(E.batches,e)).subscribe({next:i=>{window.alert("Batch added successfully")},error:i=>{window.alert("Failed to add batch")}})),this.showModal=!1}else this.batchForm.markAllAsTouched()}openBatchModal(){this.showModal=!0,this.batchForm.reset()}openBatch(e){this.selectedBatch=e,this.batchForm.patchValue(e),this.weeklySchedule.clear(),e.weeklySchedule.forEach(i=>{this.addSchedule(i)}),this.batchForm.updateValueAndValidity(),this.showModal=!0}getFormattedSchedule(e){return e.map(i=>`${i.day} (${i.startTime} - ${i.endTime})`)}removeBatch(){this.selectedBatch&&confirm(`Are you sure you want to delete the batch: ${this.selectedBatch?.name}?`)&&this.subscription.add(O(this.fireBaseService.deleteData(E.batches,this.selectedBatch?.id)).subscribe({next:()=>{window.alert("Batch deleted successfully"),this.fetchBatches(),this.selectedBatch=void 0,this.showModal=!1},error:e=>{window.alert("Failed to delete batch")}}))}ngOnDestroy(){this.subscription.unsubscribe(),this.selectedBatch=void 0,this.showModal=!1}static{this.\u0275fac=function(i){return new(i||r)(M(Z),M(A))}}static{this.\u0275cmp=V({type:r,selectors:[["app-batch"]],decls:33,vars:2,consts:[[1,"flex","flex-col","gap-2","absolute","left-0","px-10","w-full","-mt-6"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","px-4","py-1","text-left","rounded-lg"],[1,"flex","flex-row","gap-6","items-center","h-10","justify-between"],[1,"button-primary-xs",3,"click"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],["class","modal",4,"ngIf"],[1,"py-2","h-5","text-xs","font-poppins","bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text","hover:outline","hover:outline-1","hover:outline-black","hover:bg-yellow-50"],[1,"px-6","py-3","text-text"],[1,"px-6","text-center"],[1,"text-blue","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"modal"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["aria-label","Close",1,"close",3,"click"],[3,"formGroup"],[1,"modal-body"],[1,"grid","grid-cols-3","gap-8"],[1,"form-group","pointer-events-none"],["formControlName","id","readonly","",1,"bg-slate-300"],["class","error-message",4,"ngIf"],[1,"form-group"],["formControlName","name"],["formControlName","status","readonly","",1,"bg-slate-300"],["formControlName","instructorName"],["type","date","formControlName","startDate"],["type","date","formControlName","endDate"],["formControlName","description"],[1,"flex","flex-row","gap-4","mb-3","items-center"],[1,"text-lg","font-poppins","text-black","border","border-1","rounded-lg","ml-3","bg-secondary","px-3","py-1","hover:bg-white",3,"click"],["formArrayName","weeklySchedule"],["class","grid grid-cols-4 gap-8 mb-2",3,"formGroupName",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"button-secondary-xs",3,"click"],["type","button",1,"button-primary-xs",3,"click"],["type","button","class","button-primary-xs bg-red-400",3,"click",4,"ngIf"],[1,"error-message"],[1,"grid","grid-cols-4","gap-8","mb-2",3,"formGroupName"],["formControlName","day",1,"form-select"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["type","time","formControlName","startTime","placeholder","Start Time"],["type","time","formControlName","endTime","placeholder","End Time"],["class","text-lg font-poppins text-black border border-1 rounded-lg ml-3 bg-red-200 px-3 py-1 hover:bg-red-400",3,"click",4,"ngIf"],[3,"value"],[1,"text-lg","font-poppins","text-black","border","border-1","rounded-lg","ml-3","bg-red-200","px-3","py-1","hover:bg-red-400",3,"click"],["type","button",1,"button-primary-xs","bg-red-400",3,"click"]],template:function(i,a){i&1&&(n(0,"div",0)(1,"div",1)(2,"table",2)(3,"caption",3)(4,"div",4)(5,"span"),o(6,"Batch List"),t(),n(7,"button",5),x("click",function(){return a.openBatchModal()}),o(8,"+ Create Batch"),t()()(),n(9,"thead",6)(10,"tr",7)(11,"th",8),o(12,"Id"),t(),n(13,"th",8),o(14,"Name"),t(),n(15,"th",8),o(16,"Instructor"),t(),n(17,"th",8),o(18,"Strength"),t(),n(19,"th",8),o(20,"Start Date"),t(),n(21,"th",8),o(22,"End Date"),t(),n(23,"th",8),o(24,"Status"),t(),n(25,"th",8),o(26,"Weekly Schedule"),t(),n(27,"th",8),o(28,"Description"),t(),p(29,"th",8),t()(),n(30,"tbody",9),u(31,an,23,9,"ng-container",10),t()()()(),u(32,Sn,62,12,"div",11)),i&2&&(l(31),d("ngForOf",a.batches),l(),d("ngIf",a.showModal))},dependencies:[D,Q,R,K,Y,$,U,B,G,z,W,X,ee],styles:[".modal[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:#00000080;position:fixed;inset:0;height:100vh;width:100vw;z-index:1050}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:8px;width:70%;height:90%;overflow-y:auto;margin:2rem auto;box-shadow:0 4px 24px #0003}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{border:none;border-radius:8px;overflow:hidden}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.5rem;border-bottom:1px solid #e9ecef;background:#f8f9fa}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{background:transparent;border:none;font-size:1.5rem;cursor:pointer;color:#333;transition:color .2s}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover{color:#d9534f}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid #ced4da;border-radius:4px;font-size:1rem;transition:border-color .2s}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#d9534f;font-size:.875rem;margin-top:.25rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:1rem 1.5rem;border-top:1px solid #e9ecef;background:#f8f9fa}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px;margin-left:.5rem}"]})}}return r})();var yn=[{path:"students",component:We,canActivate:[ae]},{path:"enquiries",component:Ue,canActivate:[ae]},{path:"packages",component:Ke,canActivate:[ae]},{path:"batches",component:Ye,canActivate:[ae]}],Ze=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=ce({type:r})}static{this.\u0275inj=de({imports:[re.forChild(yn),re]})}}return r})();var Ei=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=ce({type:r})}static{this.\u0275inj=de({imports:[Te,Ze,Ae,qe,re,te,ue]})}}return r})();export{Ei as AdminModule};
