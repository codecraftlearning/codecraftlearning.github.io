import{a as he,b as E,c as Xe,d as B,e as z,f as $,g as et,h as xe,i as G,j as le,k as it}from"./chunk-V772B53N.js";import{A as u,Aa as fe,Ba as K,C as c,Ca as h,D as H,Da as R,E as je,Ea as W,Fa as Je,Ga as J,Ha as _e,I as i,J as t,Ja as Y,K as g,Ka as re,L as V,La as ae,M as D,Ma as Z,N as k,Na as Q,O as v,Oa as X,P as p,Pa as ee,Qa as Ye,Sa as te,Ta as Ze,Ua as Qe,V as r,Va as tt,W as _,X as O,Xa as nt,Y as Le,Z as Re,_ as $e,a as A,c as M,d as De,da as Te,e as Be,ea as Ge,fa as Ue,i as pe,ia as ze,ja as L,k as qe,ka as oe,l as j,m as ge,ma as He,p as C,q as y,ta as Ke,u as Ae,va as We,x as l,y as F,ya as se}from"./chunk-V2O3INC2.js";import{a as I,b as ue,f as U}from"./chunk-EMNZ2YI5.js";var q=class{constructor(d=0,e="Network Error"){this.status=d,this.text=e}};var ot=()=>{if(!(typeof localStorage>"u"))return{get:n=>Promise.resolve(localStorage.getItem(n)),set:(n,d)=>Promise.resolve(localStorage.setItem(n,d)),remove:n=>Promise.resolve(localStorage.removeItem(n))}};var P={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:ot()};var de=n=>n?typeof n=="string"?{publicKey:n}:n.toString()==="[object Object]"?n:{}:{};var rt=(n,d="https://api.emailjs.com")=>{if(!n)return;let e=de(n);P.publicKey=e.publicKey,P.blockHeadless=e.blockHeadless,P.storageProvider=e.storageProvider,P.blockList=e.blockList,P.limitRate=e.limitRate,P.origin=e.origin||d};var ve=(o,a,...s)=>U(void 0,[o,a,...s],function*(n,d,e={}){let m=yield fetch(P.origin+n,{method:"POST",headers:e,body:d}),S=yield m.text(),x=new q(m.status,S);if(m.ok)return x;throw x});var be=(n,d,e)=>{if(!n||typeof n!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!d||typeof d!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!e||typeof e!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"};var at=n=>{if(n&&n.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"};var Ce=n=>n.webdriver||!n.languages||n.languages.length===0;var ye=()=>new q(451,"Unavailable For Headless Browser");var lt=(n,d)=>{if(!Array.isArray(n))throw"The BlockList list has to be an array";if(typeof d!="string")throw"The BlockList watchVariable has to be a string"};var bt=n=>!n.list?.length||!n.watchVariable,Ct=(n,d)=>n instanceof FormData?n.get(d):n[d],Se=(n,d)=>{if(bt(n))return!1;lt(n.list,n.watchVariable);let e=Ct(d,n.watchVariable);return typeof e!="string"?!1:n.list.includes(e)};var Ee=()=>new q(403,"Forbidden");var dt=(n,d)=>{if(typeof n!="number"||n<0)throw"The LimitRate throttle has to be a positive number";if(d&&typeof d!="string")throw"The LimitRate ID has to be a non-empty string"};var yt=(n,d,e)=>U(void 0,null,function*(){let o=Number((yield e.get(n))||0);return d-Date.now()+o}),ke=(n,d,e)=>U(void 0,null,function*(){if(!d.throttle||!e)return!1;dt(d.throttle,d.id);let o=d.id||n;return(yield yt(o,d.throttle,e))>0?!0:(yield e.set(o,Date.now().toString()),!1)});var we=()=>new q(429,"Too Many Requests");var ct=(n,d,e,o)=>U(void 0,null,function*(){let a=de(o),s=a.publicKey||P.publicKey,m=a.blockHeadless||P.blockHeadless,S=a.storageProvider||P.storageProvider,x=I(I({},P.blockList),a.blockList),f=I(I({},P.limitRate),a.limitRate);return m&&Ce(navigator)?Promise.reject(ye()):(be(s,n,d),at(e),e&&Se(x,e)?Promise.reject(Ee()):(yield ke(location.pathname,f,S))?Promise.reject(we()):ve("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:s,service_id:n,template_id:d,template_params:e}),{"Content-type":"application/json"}))});var st=n=>{if(!n||n.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"};var St=n=>typeof n=="string"?document.querySelector(n):n,mt=(n,d,e,o)=>U(void 0,null,function*(){let a=de(o),s=a.publicKey||P.publicKey,m=a.blockHeadless||P.blockHeadless,S=P.storageProvider||a.storageProvider,x=I(I({},P.blockList),a.blockList),f=I(I({},P.limitRate),a.limitRate);if(m&&Ce(navigator))return Promise.reject(ye());let N=St(e);be(s,n,d),st(N);let T=new FormData(N);return Se(x,T)?Promise.reject(Ee()):(yield ke(location.pathname,f,S))?Promise.reject(we()):(T.append("lib_version","4.4.1"),T.append("service_id",n),T.append("template_id",d),T.append("user_id",s),ve("/api/v1.0/email/send-form",T))});var ut={init:rt,send:ct,sendForm:mt,EmailJSResponseStatus:q};function kt(n,d){n&1&&(i(0,"h5",43),r(1,"Create Student"),t())}function wt(n,d){if(n&1&&(i(0,"h5",43),r(1),t()),n&2){let e,o=p(2);l(),O("Update Student - ",(e=o.studentForm.get("id"))==null?null:e.value,"")}}function Pt(n,d){if(n&1){let e=k();i(0,"button",44),v("click",function(){C(e);let a=p(2);return y(a.certifyStudent())}),r(1,"Verified and Certify"),t()}}function Mt(n,d){if(n&1){let e=k();i(0,"button",44),v("click",function(){C(e);let a=p(2);return y(a.sendOnboardingEmail())}),r(1," Send Onboarding Email "),t()}}function Ot(n,d){n&1&&(i(0,"button",45),r(1," Sending Onboarding Email ... "),t())}function Tt(n,d){n&1&&(i(0,"div",46),r(1," Name is required. "),t())}function Ft(n,d){n&1&&(i(0,"div",46),r(1," Valid age is required. "),t())}function It(n,d){n&1&&(i(0,"div",46),r(1," Gender is required. "),t())}function Nt(n,d){n&1&&(i(0,"div",46),r(1," Invalid Aadhar Number. "),t())}function Vt(n,d){n&1&&(i(0,"div",46),r(1,'"> Valid email is required. '),t())}function Dt(n,d){n&1&&(i(0,"div",46),r(1,'"> Phone is required. '),t())}function Bt(n,d){n&1&&(i(0,"div",46),r(1,'"> Street is required. '),t())}function qt(n,d){n&1&&(i(0,"div",46),r(1,'"> City is required. '),t())}function At(n,d){n&1&&(i(0,"div",46),r(1,'"> State is required. '),t())}function jt(n,d){n&1&&(i(0,"div",46),r(1,'"> Valid zip is required. '),t())}function Lt(n,d){n&1&&(i(0,"div",46),r(1,'"> Country is required. '),t())}function Rt(n,d){if(n&1){let e=k();i(0,"div",65)(1,"h6",66),r(2),t(),i(3,"button",67),v("click",function(){C(e);let a=p().index,s=p(2);return y(s.courses.removeAt(a))}),r(4," - Remove Course"),t()()}if(n&2){let e=p().index;l(2),O("Course ",e+1,"")}}function $t(n,d){if(n&1&&(i(0,"option",68),r(1),t()),n&2){let e=d.$implicit;c("value",e.id),l(),_(e.name)}}function Gt(n,d){n&1&&(i(0,"div",46),r(1," Add aadhar number to assign a batch. "),t())}function Ut(n,d){if(n&1){let e=k();i(0,"a",72),v("click",function(){C(e);let a=p().index,s=p().$implicit,m=p(2);return y(m.removeTechAt(s,a))}),r(1,"x"),t()}}function zt(n,d){if(n&1&&(V(0),i(1,"div",69)(2,"span",70),r(3),t(),u(4,Ut,2,0,"a",71),t(),D()),n&2){let e=d.$implicit,o=p().$implicit,a=p(2);l(3),_(e),l(),c("ngIf",a.getTechStack(o).length>1)}}function Ht(n,d){if(n&1&&(i(0,"option",68),r(1),t()),n&2){let e=d.$implicit;c("value",e.title),l(),_(e.title)}}function Kt(n,d){n&1&&(i(0,"div",46),r(1," Course name is required. "),t())}function Wt(n,d){n&1&&(i(0,"div",46),r(1," Custom Course Name is required. "),t())}function Jt(n,d){n&1&&(i(0,"div",46),r(1," Duration is required. "),t())}function Yt(n,d){n&1&&(i(0,"div",46),r(1," Monthly Price is required. "),t())}function Zt(n,d){n&1&&(i(0,"div",46),r(1," Enrollment Date is required. "),t())}function Qt(n,d){n&1&&(i(0,"div",46),r(1," Completion Date cannot be before Enrollment Date. "),t())}function Xt(n,d){n&1&&(i(0,"div",46),r(1," instructor name is required. "),t())}function en(n,d){n&1&&(i(0,"div",46),r(1," Course current status is required. "),t())}function tn(n,d){if(n&1&&(i(0,"option",68),r(1),t()),n&2){let e=d.$implicit;c("value",e),l(),O("",e," ")}}function nn(n,d){n&1&&(i(0,"div",46),r(1," Certification type is required. "),t())}function on(n,d){if(n&1&&(i(0,"div",47),u(1,Rt,5,1,"div",48),i(2,"div",49)(3,"div",14)(4,"label"),r(5,"Batch name"),t(),i(6,"select",50)(7,"option",19),r(8,"Select Batch"),t(),u(9,$t,2,2,"option",51),t(),u(10,Gt,2,0,"div",16),t()(),i(11,"div",52)(12,"label"),r(13,"Tech Stack"),t(),i(14,"div",53),u(15,zt,5,2,"ng-container",54),t()(),i(16,"div",13)(17,"div",14)(18,"label"),r(19,"Course Name*"),t(),i(20,"select",15),u(21,Ht,2,2,"option",51),t(),u(22,Kt,2,0,"div",16),t(),i(23,"div",14)(24,"label"),r(25,"Custom Course Name"),t(),g(26,"input",55),u(27,Wt,2,0,"div",16),t(),i(28,"div",14)(29,"label"),r(30,"Default Duration*"),t(),g(31,"input",56),u(32,Jt,2,0,"div",16),t(),i(33,"div",14)(34,"label"),r(35,"Monthly Price*"),t(),g(36,"input",57),u(37,Yt,2,0,"div",16),t()(),i(38,"div",13)(39,"div",14)(40,"label"),r(41,"Enrollment Date*"),t(),g(42,"input",58),u(43,Zt,2,0,"div",16),t(),i(44,"div",14)(45,"label"),r(46,"Completion Date"),t(),g(47,"input",59),u(48,Qt,2,0,"div",16),t(),i(49,"div",60)(50,"label"),r(51,"Instructor*"),t(),g(52,"input",61),u(53,Xt,2,0,"div",16),t(),i(54,"div",14)(55,"label"),r(56,"Status*"),t(),g(57,"input",62),u(58,en,2,0,"div",16),t()(),i(59,"div",63)(60,"div",13)(61,"div",14)(62,"label"),r(63,"Certification Type"),t(),i(64,"select",64),u(65,tn,2,2,"option",51),t(),u(66,nn,2,0,"div",16),t(),i(67,"div",14)(68,"label"),r(69,"Certification Status*"),t(),g(70,"input",62),t(),i(71,"div",14)(72,"label"),r(73,"Certification Date"),t(),g(74,"input",62),t(),i(75,"div",14)(76,"label"),r(77,"Certificate ID"),t(),g(78,"input",62),t()()()()),n&2){let e,o,a,s,m,S,x,f,N,T,ne,b,Fe,Ie,Ne,Ve,w=d.$implicit,vt=d.index,ie=p(2);c("formGroupName",vt),l(),c("ngIf",!ie.isEditMode),l(5),H("disabled",!((e=ie.studentForm.get("aadharNumber"))!=null&&e.value)),l(3),c("ngForOf",ie.availableBatches),l(),c("ngIf",!((o=ie.studentForm.get("aadharNumber"))!=null&&o.value)),l(5),c("ngForOf",ie.getTechStack(w)),l(6),c("ngForOf",ie.courseList),l(),c("ngIf",((a=w.get("name"))==null?null:a.invalid)&&((a=w.get("name"))==null?null:a.touched)),l(),H("disabled",((s=w.get("name"))==null?null:s.value)!=="CUSTOM"),l(4),c("ngIf",((m=w.get("customName"))==null?null:m.invalid)&&((m=w.get("customName"))==null?null:m.touched)),l(5),c("ngIf",((S=w.get("defaultDuration"))==null?null:S.invalid)&&((S=w.get("defaultDuration"))==null?null:S.touched)),l(5),c("ngIf",((x=w.get("price"))==null?null:x.invalid)&&((x=w.get("price"))==null?null:x.touched)),l(6),c("ngIf",((f=w.get("enrollmentDate"))==null?null:f.invalid)&&((f=w.get("enrollmentDate"))==null?null:f.touched)),l(5),c("ngIf",((N=w.get("completionDate"))==null||N.errors==null?null:N.errors.completionBeforeEnrollment)&&((N=w.get("completionDate"))==null?null:N.touched)),l(5),c("ngIf",((T=w.get("instructor"))==null?null:T.invalid)&&((T=w.get("instructor"))==null?null:T.touched)),l(4),c("value",(ne=w.get("status"))==null?null:ne.value),l(),c("ngIf",((b=w.get("status"))==null?null:b.invalid)&&((b=w.get("status"))==null?null:b.touched)),l(7),c("ngForOf",ie.certificationTypeList),l(),c("ngIf",(Fe=w.get("certification.certificationType"))==null?null:Fe.invalid),l(4),c("value",(Ie=w.get("certification.certificationStatus"))==null?null:Ie.value),l(4),c("value",(Ne=w.get("certification.certificationDate"))==null?null:Ne.value),l(4),c("value",(Ve=w.get("certification.certificateId"))==null?null:Ve.value)}}function rn(n,d){if(n&1){let e=k();i(0,"button",73),v("click",function(){C(e);let a=p(2);return y(a.addCourse())}),r(1,"+ Add Course"),t()}}function an(n,d){if(n&1){let e=k();i(0,"button",44),v("click",function(){C(e);let a=p(3);return y(a.onSubmit())}),r(1,"Create"),t()}}function ln(n,d){if(n&1){let e=k();i(0,"button",44),v("click",function(){C(e);let a=p(3);return y(a.updateStudent())}),r(1,"Update Student"),t()}}function dn(n,d){if(n&1&&(V(0),u(1,an,2,0,"button",7)(2,ln,2,0,"button",7),D()),n&2){let e=p(2);l(),c("ngIf",!e.isEditMode),l(),c("ngIf",e.isEditMode)}}function cn(n,d){if(n&1){let e=k();i(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),u(5,kt,2,0,"h5",6)(6,wt,2,1,"h5",6)(7,Pt,2,0,"button",7)(8,Mt,2,0,"button",7)(9,Ot,2,0,"button",8),t(),i(10,"button",9),v("click",function(){C(e);let a=p();return y(a.closeModal())}),i(11,"span",10),r(12,"\xD7"),t()()(),i(13,"form",11)(14,"div",12)(15,"div",13)(16,"div",14)(17,"label"),r(18,"Full Name*"),t(),g(19,"input",15),u(20,Tt,2,0,"div",16),t(),i(21,"div",14)(22,"label"),r(23,"Age*"),t(),g(24,"input",17),u(25,Ft,2,0,"div",16),t(),i(26,"div",14)(27,"label"),r(28,"Gender*"),t(),i(29,"select",18)(30,"option",19),r(31,"Select"),t(),i(32,"option",20),r(33,"Male"),t(),i(34,"option",21),r(35,"Female"),t(),i(36,"option",22),r(37,"Other"),t()(),u(38,It,2,0,"div",16),t(),i(39,"div",14)(40,"label"),r(41,"AAdhar Number"),t(),g(42,"input",23),u(43,Nt,2,0,"div",16),t()(),i(44,"div",24)(45,"div",25)(46,"div",14)(47,"label"),r(48,"Email*"),t(),g(49,"input",26),u(50,Vt,2,0,"div",16),t(),i(51,"div",14)(52,"label"),r(53,"Phone*"),t(),g(54,"input",27),u(55,Dt,2,0,"div",16),t(),i(56,"div",14)(57,"label"),r(58,"Alternate Phone"),t(),g(59,"input",28),t()()(),i(60,"div",29)(61,"div",30)(62,"div",14)(63,"label"),r(64,"Street*"),t(),g(65,"input",31),u(66,Bt,2,0,"div",16),t(),i(67,"div",14)(68,"label"),r(69,"City*"),t(),g(70,"input",32),u(71,qt,2,0,"div",16),t(),i(72,"div",14)(73,"label"),r(74,"State*"),t(),g(75,"input",33),u(76,At,2,0,"div",16),t(),i(77,"div",14)(78,"label"),r(79,"Zip*"),t(),g(80,"input",34),u(81,jt,2,0,"div",16),t(),i(82,"div",14)(83,"label"),r(84,"Country*"),t(),g(85,"input",35),u(86,Lt,2,0,"div",16),t()()(),i(87,"div",36),u(88,on,79,24,"div",37)(89,rn,2,0,"button",38),t()(),g(90,"app-loader",39),i(91,"div",40),u(92,dn,3,2,"ng-container",41),i(93,"button",42),v("click",function(){C(e);let a=p();return y(a.closeModal())}),r(94,"Cancel"),t()()()()()()}if(n&2){let e,o,a,s,m,S,x,f,N,T,ne,b=p();l(5),c("ngIf",!b.isEditMode),l(),c("ngIf",b.isEditMode),l(),c("ngIf",b.isReadyToCertify),l(),c("ngIf",b.showKycButton&&!b.sendingEmail),l(),c("ngIf",b.showKycButton&&b.sendingEmail),l(4),c("formGroup",b.studentForm),l(),H("hidden",b.creatingStudent),l(6),c("ngIf",((e=b.studentForm.get("name"))==null?null:e.invalid)&&((e=b.studentForm.get("name"))==null?null:e.touched)),l(5),c("ngIf",((o=b.studentForm.get("age"))==null?null:o.invalid)&&((o=b.studentForm.get("age"))==null?null:o.touched)),l(13),c("ngIf",((a=b.studentForm.get("gender"))==null?null:a.invalid)&&((a=b.studentForm.get("gender"))==null?null:a.touched)),l(5),c("ngIf",((s=b.studentForm.get("aadharNumber"))==null?null:s.invalid)&&((s=b.studentForm.get("aadharNumber"))==null?null:s.touched)),l(7),c("ngIf",((m=b.studentForm.get("contact.email"))==null?null:m.invalid)&&((m=b.studentForm.get("contact.email"))==null?null:m.touched)),l(5),c("ngIf",((S=b.studentForm.get("contact.phone"))==null?null:S.invalid)&&((S=b.studentForm.get("contact.phone"))==null?null:S.touched)),l(11),c("ngIf",((x=b.studentForm.get("address.street"))==null?null:x.invalid)&&((x=b.studentForm.get("address.street"))==null?null:x.touched)),l(5),c("ngIf",((f=b.studentForm.get("address.city"))==null?null:f.invalid)&&((f=b.studentForm.get("address.city"))==null?null:f.touched)),l(5),c("ngIf",((N=b.studentForm.get("address.state"))==null?null:N.invalid)&&((N=b.studentForm.get("address.state"))==null?null:N.touched)),l(5),c("ngIf",((T=b.studentForm.get("address.zip"))==null?null:T.invalid)&&((T=b.studentForm.get("address.zip"))==null?null:T.touched)),l(5),c("ngIf",((ne=b.studentForm.get("address.country"))==null?null:ne.invalid)&&((ne=b.studentForm.get("address.country"))==null?null:ne.touched)),l(),H("pointer-events-none",b.isCertified),l(),c("ngForOf",b.courses.controls),l(),c("ngIf",!b.isEditMode),l(),c("loading",b.creatingStudent),l(),H("disabled",b.creatingStudent),l(),c("ngIf",!b.isCertified)}}var pt=(()=>{class n{set SelectedStudent(e){if(e){this.courses.clear(),this.studentForm.reset(),this.isOpen=!0,this.isEditMode=!!e.id;let o=I({},e);o.course=o.course?[o.course]:[],this.studentForm.patchValue(o),this.addCourse(o.course[0]),this.studentForm.updateValueAndValidity()}}constructor(e,o){this.fb=e,this.firebaseService=o,this.isOpen=!1,this.onClose=new Ae,this.sendingEmail=!1,this.isEditMode=!1,this.courseList=[],this.courseStatusList=Object.values(B),this.certificationStatusList=Object.values(z),this.certificationTypeList=Object.values(Xe),this.creatingStudent=!1,this.availableBatches=[],this.configuration={},this.subscriptions=new A,this.studentForm=this.fb.group({id:[null],name:["",h.required],age:[null,[h.required,h.min(1)]],gender:["",h.required],aadharNumber:[null,[h.pattern("^[0-9]{12}$")]],contact:this.fb.group({email:["",[h.required,h.email]],phone:["",h.required],alternatePhone:[""]}),address:this.fb.group({street:["",h.required],city:["",h.required],state:["",h.required],zip:[null,[h.required,h.pattern("^[0-9]{6}$")]],country:["",h.required]}),course:this.fb.array([])})}ngOnInit(){this.loadConfiguration(),this.loadAllCourses(),this.loadAllBatches()}get showKycButton(){return!this.studentForm.get("aadharNumber")?.value&&this.isEditMode&&this.studentForm.get("course")?.value[0]?.status!==B.completed}loadConfiguration(){this.subscriptions.add(this.firebaseService.getAllFromCollection(E.configurations).subscribe(e=>{this.configuration=e&&e.length>0?e[0]:{}}))}loadAllBatches(){this.subscriptions.add(this.firebaseService.getAllFromCollection(E.batches).subscribe(e=>{this.availableBatches=e}))}getBatch(e){let o=this.availableBatches.find(a=>a.id===e);return o||null}get courses(){return this.studentForm.get("course")}getTechStack(e){return e.get("technology")?.value??[]}addCourse(e){let o=this.fb.group({batchName:[e?.batchName||null],name:[e?.name||"",h.required],customName:[e?.customName||""],defaultDuration:[e?.defaultDuration||null,h.required],enrollmentDate:[e?.enrollmentDate||null,h.required],completionDate:[e?.completionDate||null,this.completionAfterEnrollmentValidator],technology:[e?.technology||[],h.required],price:[e?.price||0,[h.required,h.min(0)]],instructor:[e?.instructor||""],status:[e?.status||B.notStarted,h.required],certification:this.fb.group({certificationType:[e?.certification?.certificationType||""],certificationStatus:[e?.certification?.certificationStatus||z.notApplicable,h.required],certificationDate:[e?.certification?.certificationDate||""],certificateId:[e?.certification?.certificateId||""]})});this.nameValueChanges(o),this.completionDateValueChanges(o),this.batchNameValueChanges(o),e&&(e.name?.toLowerCase()==="custom"?o.get("customName")?.addValidators(h.required):(o.get("customName")?.removeValidators(h.required),o.get("customName")?.setErrors(null)),o.updateValueAndValidity()),this.courses.push(o)}nameValueChanges(e){let o=e.controls.name.valueChanges.subscribe(a=>{let s=this.courseList.find(m=>m.title===a);s&&(e.patchValue({defaultDuration:s.durationInMonth,price:s.discountPrice,technology:s.allTechItems||[]}),s.title.toLowerCase()==="custom"?e.get("customName")?.addValidators(h.required):(e.get("customName")?.removeValidators(h.required),e.get("customName")?.setErrors(null)),e.updateValueAndValidity())});this.subscriptions.add(o)}completionDateValueChanges(e){let o=e.controls.completionDate.valueChanges.subscribe(a=>{a&&(e.patchValue({certification:{certificationStatus:z.pending},status:B.completed}),e.get("certification.certificationType")?.setValidators([h.required]),e.get("certification.certificationType")?.updateValueAndValidity(),e.get("certification.certificationType")?.markAllAsTouched())});this.subscriptions.add(o)}batchNameValueChanges(e){let o=e.controls.batchName.valueChanges.subscribe(a=>{(e.controls.status.value===B.notStarted||e.controls.status.value===B.inProgress)&&(e.patchValue({status:B.inProgress,instructor:this.getBatch(a)?.instructorName||""}),e.updateValueAndValidity())});this.subscriptions.add(o)}removeTechAt(e,o){let a=e.get("technology")?.value??[];a.length!==1&&(a.splice(o,1),e.patchValue({technology:a}),e.updateValueAndValidity())}closeModal(){this.isOpen=!1,this.isEditMode=!1,this.courses.clear(),this.studentForm.reset(),window.history.replaceState({},document.title,window.location.pathname),this.onClose.emit()}onSubmit(){if(this.studentForm.valid){this.creatingStudent=!0;let e=[];this.getFlatStudents().forEach(a=>{e.push(this.firebaseService.saveNewData(E.students,a,a.id)),this.updateStudentLog(a)});let o=M(Promise.all(e)).subscribe({next:()=>{this.closeModal(),this.creatingStudent=!1,window.alert("Student created successfully!")},error:a=>{console.error("Error creating student:",a),this.creatingStudent=!1,window.alert("Failed to create student. Please try again.")}});this.subscriptions.add(o)}else this.studentForm.markAllAsTouched(),console.error("Form is invalid")}getFlatStudents(){let e=[],o=0;return this.studentForm.value.course.forEach(a=>{++o;let s=ue(I({},this.studentForm.value),{course:a});s.id=this.createId()+o,e.push(s)}),e}updateStudent(){let e=this.studentForm.value;e.course=e.course[0];let o=e.id;if(this.studentForm.valid&&o){this.creatingStudent=!0;let a=M(this.firebaseService.updateData(E.students,o,e)).subscribe({next:()=>{this.creatingStudent=!1,window.alert("Student updated successfully!"),this.updateStudentLog(e)},error:s=>{console.error("Error updating student:",s),this.creatingStudent=!1,window.alert("Failed to update student. Please try again.")}});this.subscriptions.add(a)}else this.studentForm.markAllAsTouched(),console.error("Form is invalid or student ID is missing")}updateStudentLog(e){let o={id:e.id??"",email:e.contact.email,name:e.name,gender:e.gender??"",courseTitle:e.course.name==="CUSTOM"?e.course.customName??"":e.course.name};this.subscriptions.add(M(this.firebaseService.saveNewData(E.studentLog,o,e.id)).subscribe())}certifyStudent(){let e=this.studentForm.value;if(!e.id||e.course[0].status!==B.completed){window.alert("Student is not eligible for certification.");return}this.subscriptions.add(this.firebaseService.getAllFromCollection(E.reviews).subscribe(o=>{if(o.findIndex(a=>a.studentId===e.id)===-1){window.alert("Student review not submitted. Certification cannot be processed.");return}this.studentForm.get("course")?.at(0)?.get("certification")?.patchValue({certificationStatus:z.certified,certificationDate:new Date().toDateString(),certificateId:e.id}),this.studentForm.updateValueAndValidity(),this.updateStudent(),this.generateCertificate()}))}generateCertificate(){let e=this.studentForm.value,o={id:e.id??"",issuedTo:e.name,courseTitle:e.course.name!=="CUSTOM"?e.course.name:e.course.customName,technologiesCovered:e.course.technology,duration:`${e.course.defaultDuration} months`,completionDate:e.course.certification?.certificationDate,certifiedBy:e.course.instructor??"",modeOfLearning:"Online",certificationType:e.course.certification?.certificationType,IssuedUnder:"Code Craft Learning"};this.subscriptions.add(M(this.firebaseService.saveNewData(E.certificates,o,e.id)).subscribe({next:()=>{console.log("Certificate generated successfully:",o),window.alert("Certificate generated successfully!")},error:a=>{console.error("Error generating certificate:",a),window.alert("Failed to generate certificate. Please try again.")}}))}loadAllCourses(){let e={description:"Custom Course",title:"CUSTOM",index:0,regularPrice:0,discountPrice:0,durationInMonth:0,technologies:[],allTechItems:[]},o=this.firebaseService.getAllFromCollection(E.coursePackages).subscribe(a=>{this.courseList=[e,...a]});this.subscriptions.add(o)}createId(){let o=this.studentForm.value.name.substring(0,2).toLowerCase(),a=Math.random().toString(36).substring(2,6);return o+a}ngOnDestroy(){this.subscriptions.unsubscribe()}get isReadyToCertify(){if(this.isEditMode){let e=this.studentForm.get("course")?.value[0];if(e.status===B.completed&&e.completionDate)return e.certification.certificationStatus===z.pending}return!1}get isCertified(){return this.studentForm.get("course")?.value[0]?.certification?.certificationStatus===z.certified}completionAfterEnrollmentValidator(e){let o=e.parent;if(!o)return null;let a=o.get("enrollmentDate")?.value,s=e.value;return a&&s&&new Date(s)<=new Date(a)?{completionBeforeEnrollment:!0}:null}sendOnboardingEmail(){this.sendingEmail=!0;let e=this.studentForm.value;if(e.course=e.course[0],!this.configuration.email||!this.configuration.email.serviceId||!this.configuration.email.publicKey){console.warn("Email configuration is not set.");return}let o={studentId:e.id||"",studentName:e.name||"",email:e.contact.email||"",courseTitle:e.course.name==="CUSTOM"?e.course.customName||"":e.course.name,technologiesCovered:e.course.technology.join(", ")||"",duration:`${e.course.defaultDuration} months`,price:e.course.price??0};ut.send(this.configuration.email.serviceId,this.configuration.email.onboardingTemplateId,o,this.configuration.email.publicKey).then(()=>{this.sendingEmail=!1,window.alert("Onboarding email sent successfully.")})}static{this.\u0275fac=function(o){return new(o||n)(F(te),F(G))}}static{this.\u0275cmp=j({type:n,selectors:[["app-create-student-modal"]],inputs:{isOpen:"isOpen",SelectedStudent:"SelectedStudent"},outputs:{onClose:"onClose"},decls:1,vars:1,consts:[["class","modal","tabindex","-1","role","dialog",4,"ngIf"],["tabindex","-1","role","dialog",1,"modal"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"flex","flex-row","gap-2","items-center"],["class","modal-title",4,"ngIf"],["class","button-accent-sm",3,"click",4,"ngIf"],["class","button-accent-sm disabled",4,"ngIf"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[3,"formGroup"],[1,"modal-body"],[1,"grid","grid-cols-4","gap-8"],[1,"form-group"],["formControlName","name",1,"form-control"],["class","text-red-500",4,"ngIf"],["type","number","formControlName","age",1,"form-control"],["formControlName","gender",1,"form-control"],["value",""],["value","Male"],["value","Female"],["value","Other"],["formControlName","aadharNumber",1,"form-control"],["formGroupName","contact"],[1,"grid","grid-cols-3","gap-8"],["formControlName","email",1,"form-control"],["formControlName","phone",1,"form-control"],["formControlName","alternatePhone",1,"form-control"],["formGroupName","address"],[1,"grid","grid-cols-5","gap-8"],["formControlName","street",1,"form-control"],["formControlName","city",1,"form-control"],["formControlName","state",1,"form-control"],["formControlName","zip",1,"form-control"],["formControlName","country",1,"form-control"],["formArrayName","course"],["class","border p-2 mb-2",3,"formGroupName",4,"ngFor","ngForOf"],["type","button","class","button-primary-sm",3,"click",4,"ngIf"],[3,"loading"],[1,"modal-footer"],[4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"modal-title"],[1,"button-accent-sm",3,"click"],[1,"button-accent-sm","disabled"],[1,"text-red-500"],[1,"border","p-2","mb-2",3,"formGroupName"],["class","flex flex-row gap-4 align-middle",4,"ngIf"],[1,"grid","grid-cols-2","gap-8"],["formControlName","batchName",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"form-group","flex","flex-col","w-full","mb-3","border","border-dotted","border-1","border-black","px-4","py-1"],[1,"flex","flex-row","gap-2","flex-wrap","mb-2"],[4,"ngFor","ngForOf"],["formControlName","customName",1,"form-control"],["formControlName","defaultDuration",1,"form-control"],["type","number","formControlName","price",1,"form-control"],["type","date","formControlName","enrollmentDate",1,"form-control"],["type","date","formControlName","completionDate",1,"form-control"],[1,"form-group","pointer-events-none"],["formControlName","instructor","readonly","",1,"form-control","bg-slate-300"],["readonly","",1,"bg-slate-300","form-control",3,"value"],["formGroupName","certification"],["formControlName","certificationType",1,"form-control"],[1,"flex","flex-row","gap-4","align-middle"],[1,"mb-2","text-text","underline","underline-offset-2"],["type","button",1,"mt-2","bg-red-300","px-4","rounded-lg",3,"click"],[3,"value"],[1,"bg-blue-300","rounded-lg","px-2","flex","flex-row","gap-4","items-center"],[1,"text-primary","text-sm"],["class","cursor-pointer text-black text-sm hover:text-red-500",3,"click",4,"ngIf"],[1,"cursor-pointer","text-black","text-sm","hover:text-red-500",3,"click"],["type","button",1,"button-primary-sm",3,"click"]],template:function(o,a){o&1&&u(0,cn,95,27,"div",0),o&2&&c("ngIf",a.isOpen)},dependencies:[L,oe,J,X,ee,K,_e,Q,R,W,Y,Z,re,ae,le],styles:[".modal[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:#00000080;position:fixed;inset:0;height:100vh;width:100vw;z-index:1050}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:8px;width:70%;height:90%;overflow-y:auto;margin:2rem auto;box-shadow:0 4px 24px #0003}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{border:none;border-radius:8px;overflow:hidden}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.5rem;border-bottom:1px solid #e9ecef;background:#f8f9fa}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{background:transparent;border:none;font-size:1.5rem;cursor:pointer;color:#333;transition:color .2s}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover{color:#d9534f}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid #ced4da;border-radius:4px;font-size:1rem;transition:border-color .2s}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#d9534f;font-size:.875rem;margin-top:.25rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:1rem 1.5rem;border-top:1px solid #e9ecef;background:#f8f9fa}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px;margin-left:.5rem}"]})}}return n})();var un=(n,d,e)=>({"course-completed":n,"course-in-progress":d,"course-not-started":e}),pn=(n,d,e)=>({"certification-certified":n,"certification-pending":d,"certification-not-applicable":e});function gn(n,d){if(n&1&&(i(0,"option",34),r(1),t()),n&2){let e=d.$implicit;c("value",e.id),l(),_(e.name)}}function fn(n,d){if(n&1&&(i(0,"option",34),r(1),t()),n&2){let e=d.$implicit;c("value",e),l(),_(e)}}function _n(n,d){if(n&1&&(i(0,"option",34),r(1),t()),n&2){let e=d.$implicit;c("value",e),l(),_(e)}}function hn(n,d){if(n&1){let e=k();V(0),i(1,"tr",35)(2,"td",36),r(3),t(),i(4,"td",36),r(5),t(),i(6,"td",36),r(7),t(),i(8,"td",36),r(9),t(),i(10,"td",36),r(11),t(),i(12,"td",36),r(13),t(),i(14,"td",36),r(15),t(),i(16,"td",36),r(17),t(),i(18,"td",37),r(19),t(),i(20,"td",37),r(21),t(),i(22,"td",38)(23,"a",39),v("click",function(){let a=C(e).$implicit,s=p();return y(s.openStudent(a))}),r(24,"View"),t()()(),D()}if(n&2){let e=d.$implicit,o=p();l(3),_(e.id),l(2),_(e.name),l(2),_(e.age),l(2),_(e.gender),l(2),_(e.contact.email),l(2),_(e.contact.phone),l(2),_(e.course.name),l(2),_(o.getBatchName(e.course.batchName)),l(),c("ngClass",Te(12,un,(e.course.status==null?null:e.course.status.toString())==="completed",(e.course.status==null?null:e.course.status.toString())==="in-progress",(e.course.status==null?null:e.course.status.toString())==="not-started")),l(),O(" ",e.course.status," "),l(),c("ngClass",Te(16,pn,(e.course.certification==null||e.course.certification.certificationStatus==null?null:e.course.certification.certificationStatus.toString())==="Certified",(e.course.certification==null||e.course.certification.certificationStatus==null?null:e.course.certification.certificationStatus.toString())==="Pending",(e.course.certification==null||e.course.certification.certificationStatus==null?null:e.course.certification.certificationStatus.toString())==="Not applicable")),l(),O(" ",e.course.certification==null?null:e.course.certification.certificationStatus," ")}}var gt=(()=>{class n{constructor(e,o,a){this.firebaseService=e,this.activatedRoute=o,this.fb=a,this.createStudentModal=!1,this.allStudents=[],this.filteredStudents=[],this.courseStatus=Object.values(B),this.certificationStatus=Object.values(z),this.subscriptions=new A,this.courses=[],this.availableBatches=[],this.filterForm=this.fb.group({id:[""],name:[""],email:[""],phone:[""],courseName:[""],batchName:[""],courseStatus:[""],certificationStatus:[""]})}ngOnInit(){this.loadAllCourses(),this.loadAllStudents(),this.loadParams(),this.filterFormChange(),this.loadAllBatches()}loadAllBatches(){this.subscriptions.add(this.firebaseService.getAllFromCollection(E.batches).subscribe(e=>{this.availableBatches=e}))}getBatchName(e){if(!e)return"N/A";let o=this.availableBatches.find(a=>a.id===e);return o?o.name:"N/A"}filterFormChange(){let e=this.filterForm.valueChanges.subscribe(()=>{this.filterStudentsOnChange()});this.subscriptions.add(e)}filterStudentsOnChange(){let e=this.filterForm.value,o=this.allStudents;Object.keys(e).forEach(a=>{let s=""+e[a];if(s)switch(a){case"id":o=o.filter(m=>m.id?.toLowerCase().startsWith(s.trim().toLowerCase()));break;case"name":o=o.filter(m=>m.name?.toLowerCase().startsWith(s.trim().toLowerCase()));break;case"email":o=o.filter(m=>m.contact.email?.toLowerCase().startsWith(s.trim().toLowerCase()));break;case"phone":o=o.filter(m=>m.contact.phone?.toLowerCase().startsWith(s.trim().toLowerCase()));break;case"courseName":o=o.filter(m=>m.course.name?.toLowerCase().startsWith(s.trim().toLowerCase())||m.course.customName?.toLowerCase().startsWith(s.trim().toLowerCase()));break;case"batchName":o=o.filter(m=>m.course.batchName===s);break;case"courseStatus":o=o.filter(m=>m.course.status===s);break;case"certificationStatus":o=o.filter(m=>m.course.certification?.certificationStatus===s);break}}),this.filteredStudents=o}loadAllCourses(){this.subscriptions.add(this.firebaseService.getAllFromCollection(E.coursePackages,"title").subscribe(e=>{this.courses=e}))}loadParams(){this.subscriptions.add(this.activatedRoute.queryParams.subscribe(e=>{e.enquiryId&&this.firebaseService.getFromCollectionById(E.enquiries,e.enquiryId).subscribe(o=>{this.openStudent(this.loadStudentWithEnquiry(o))})}))}loadStudentWithEnquiry(e){let o={name:e.fullName,age:e.age,contact:{email:e.email,phone:e.contactNumber}};(e.packageName===void 0||e.packageName===null)&&(o.course={name:"CUSTOM",technology:e.technologies});let a=this.courses.find(s=>s.title===e.packageName);return a&&(o.course={name:a.title,defaultDuration:a.durationInMonth,technology:a.allTechItems,price:a.discountPrice}),o}openStudent(e){this.selectedStudent=e,this.createStudentModal=!0}closeStudentModal(){this.createStudentModal=!1,this.selectedStudent=void 0}loadAllStudents(){this.subscriptions.add(this.firebaseService.getAllFromCollection(E.students,"id").subscribe(e=>{this.allStudents=e.sort((o,a)=>(o?.course?.enrollmentDate??1)<(a?.course?.enrollmentDate??0)?-1:1),this.filteredStudents=this.allStudents}))}ngOnDestroy(){this.subscriptions.unsubscribe()}static{this.\u0275fac=function(o){return new(o||n)(F(G),F(Ke),F(te))}}static{this.\u0275cmp=j({type:n,selectors:[["app-students"]],decls:80,vars:7,consts:[[1,"flex","flex-col","gap-2","absolute","left-0","px-10","w-full","-mt-6"],[1,"border","border-primary","rounded-lg","px-4","py-2"],[1,"text-base","font-semibold","text-primary","px-2"],[1,"flex","flex-row","justify-start","flex-wrap","gap-4","form-group",3,"formGroup"],[1,"flex","flex-col","gap-1"],["for","idFilter"],["id","idFilter","type","text","formControlName","id",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","nameFilter"],["id","nameFilter","type","text","formControlName","name",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","emailFilter"],["id","emailFilter","type","text","formControlName","email",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","phoneFilter"],["id","phoneFilter","type","text","formControlName","phone",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","courseNameFilter"],["id","courseNameFilter","type","text","formControlName","courseName",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","batchNameFilter"],["id","batchNameFilter","formControlName","batchName",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","courseStatusFilter"],["id","courseStatusFilter","formControlName","courseStatus",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","certificationStatusFilter"],["id","certificationStatusFilter","formControlName","certificationStatus",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","px-4","py-1","text-left","rounded-lg"],[1,"flex","flex-row","gap-6","items-center","h-10","justify-between"],[1,"button-primary-xs",3,"click"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],[3,"onClose","isOpen","SelectedStudent"],[3,"value"],[1,"py-2","h-5","text-xs","font-poppins","bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text","hover:outline","hover:outline-1","hover:outline-black","hover:bg-yellow-50"],[1,"px-6"],[1,"px-6",3,"ngClass"],[1,"px-6","text-center"],[1,"text-blue","underline","underline-offset-2","cursor-pointer",3,"click"]],template:function(o,a){o&1&&(i(0,"div",0)(1,"fieldset",1)(2,"legend",2),r(3,"Filter"),t(),i(4,"form",3)(5,"div",4)(6,"label",5),r(7,"Id"),t(),g(8,"input",6),t(),i(9,"div",4)(10,"label",7),r(11,"Name"),t(),g(12,"input",8),t(),i(13,"div",4)(14,"label",9),r(15,"Email"),t(),g(16,"input",10),t(),i(17,"div",4)(18,"label",11),r(19,"Phone"),t(),g(20,"input",12),t(),i(21,"div",4)(22,"label",13),r(23,"Course Name"),t(),g(24,"input",14),t(),i(25,"div",4)(26,"label",15),r(27,"Batch Name"),t(),i(28,"select",16)(29,"option",17),r(30,"All"),t(),u(31,gn,2,2,"option",18),t()(),i(32,"div",4)(33,"label",19),r(34,"Course Status"),t(),i(35,"select",20)(36,"option",17),r(37,"All"),t(),u(38,fn,2,2,"option",18),t()(),i(39,"div",4)(40,"label",21),r(41,"Certification Status"),t(),i(42,"select",22)(43,"option",17),r(44,"All"),t(),u(45,_n,2,2,"option",18),t()()()(),i(46,"div",23)(47,"table",24)(48,"caption",25)(49,"div",26)(50,"span"),r(51,"Student List"),t(),i(52,"button",27),v("click",function(){return a.createStudentModal=!0}),r(53,"+ Create Student"),t()()(),i(54,"thead",28)(55,"tr",29)(56,"th",30),r(57,"Id"),t(),i(58,"th",30),r(59,"Name"),t(),i(60,"th",30),r(61,"Age"),t(),i(62,"th",30),r(63,"Gender"),t(),i(64,"th",30),r(65,"Email"),t(),i(66,"th",30),r(67,"Phone"),t(),i(68,"th",30),r(69,"Course Name"),t(),i(70,"th",30),r(71,"Batch Name"),t(),i(72,"th",30),r(73,"Course Status"),t(),i(74,"th",30),r(75,"Certification Status"),t(),g(76,"th",30),t()(),i(77,"tbody",31),u(78,hn,25,20,"ng-container",32),t()()()(),i(79,"app-create-student-modal",33),v("onClose",function(){return a.closeStudentModal()}),t()),o&2&&(l(4),c("formGroup",a.filterForm),l(27),c("ngForOf",a.availableBatches),l(7),c("ngForOf",a.courseStatus),l(7),c("ngForOf",a.certificationStatus),l(33),c("ngForOf",a.filteredStudents),l(),c("isOpen",a.createStudentModal)("SelectedStudent",a.selectedStudent))},dependencies:[ze,L,J,X,ee,K,Q,R,W,Y,Z,pt],styles:[".certification-certified[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.certification-pending[_ngcontent-%COMP%]{background-color:#fff3cd;color:#856404}.certification-not-applicable[_ngcontent-%COMP%]{background-color:#e2e3e5;color:#383d41}.course-completed[_ngcontent-%COMP%]{background-color:#cce5ff;color:#004085}.course-in-progress[_ngcontent-%COMP%]{background-color:#fffbe6;color:#856404}.course-not-started[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24}"]})}}return n})();var me=(n,d)=>{let e=qe(tt);return nt(e).pipe(Be(1),De(o=>o?!0:(window.alert("You must be logged in to access this page"),!1)))};function xn(n,d){if(n&1){let e=k();i(0,"label",15)(1,"input",16),$e("ngModelChange",function(a){let s=C(e).$implicit,m=p();return Re(m.selectedStatuses[s],a)||(m.selectedStatuses[s]=a),y(a)}),t(),i(2,"span"),r(3),t()()}if(n&2){let e=d.$implicit,o=p();l(),c("value",e),Le("ngModel",o.selectedStatuses[e]),l(2),_(e)}}function vn(n,d){if(n&1){let e=k();V(0),i(1,"tr",17)(2,"td",18),r(3),t(),i(4,"td",18),r(5),t(),i(6,"td",18),r(7),t(),i(8,"td",18),r(9),t(),i(10,"td",18),r(11),t(),i(12,"td",18),r(13),Ge(14,"timestampPipe"),t(),i(15,"td",18),r(16),t(),i(17,"td",18),r(18),t(),i(19,"td",18),r(20),t(),i(21,"td",18),r(22),t(),i(23,"td",18),r(24),t(),i(25,"td",19)(26,"a",20),v("click",function(){let a=C(e).$implicit,s=p();return y(s.viewEnquiry(a))}),r(27,"View"),t(),i(28,"a",21),v("click",function(){let a=C(e).$implicit,s=p();return y(s.confirmEnquiry(a))}),r(29,"Confirm"),t(),i(30,"a",22),v("click",function(){let a=C(e).$implicit,s=p();return y(s.cancelEnquiry(a))}),r(31,"Cancel"),t()()(),D()}if(n&2){let e=d.$implicit;l(),je(e.status),l(2),_(e.id),l(2),_(e.fullName),l(2),_(e.age),l(2),_(e.email),l(2),_(e.contactNumber),l(2),_(Ue(14,13,e.createdDate)),l(3),_(e.packageName),l(2),_(e.technologies.join(", ")),l(2),_(e.enquiryPrice),l(2),_(e.status),l(2),_(e.notes)}}var ft=(()=>{class n{constructor(e,o){this.firebaseService=e,this.router=o,this.loading=!1,this.enquiries=[],this.enquiryStatus=Object.values($),this.selectedStatuses={[$.pending]:!0,[$.confirmed]:!0,[$.cancelled]:!0,[$.contacted]:!0},this.subscription=new A}ngOnInit(){this.getEnquiries()}get filteredEnquiries(){return this.enquiries.filter(e=>this.selectedStatuses[e.status||$.pending])}removeEnquiry(e){if(!e||!e.id){console.error("Invalid enquiry data:",e);return}if(confirm(`Are you sure you want to delete the enquiry from ${e.fullName}?`)){this.loading=!0;let o=M(this.firebaseService.deleteData(E.enquiries,e.id)).subscribe(()=>{this.enquiries=this.enquiries.filter(a=>a.id!==e.id),this.loading=!1},a=>{console.error("Error deleting enquiry:",a),this.loading=!1});this.subscription.add(o)}}cancelEnquiry(e){let o=window.prompt("Reason for cancellation:");if(!o){window.alert("Cancellation reason is required.");return}e.notes=o,e.status=$.cancelled,this.updateEnquiry(e)}viewEnquiry(e){let o=window.prompt("Message / updates:");if(!o){window.alert("message is required.");return}e.notes=o,e.status=$.contacted,this.updateEnquiry(e)}confirmEnquiry(e){window.confirm(`Are you sure you want to confirm the enquiry from ${e.fullName}?`)&&(e.status=$.confirmed,this.updateEnquiry(e),this.router.navigate(["/admin/students"],{queryParams:{enquiryId:e.id}}))}updateEnquiry(e){if(!e||!e.id){console.error("Invalid enquiry data:",e);return}this.loading=!0;let o=M(this.firebaseService.updateData(E.enquiries,e.id,e)).subscribe(()=>{let a=this.enquiries.findIndex(s=>s.id===e.id);a!==-1&&(this.enquiries[a]=e),this.loading=!1},a=>{console.error("Error updating enquiry:",a),this.loading=!1});this.subscription.add(o)}getEnquiries(){this.loading=!0;let e=this.firebaseService.getAllFromCollection(E.enquiries,"id").subscribe(o=>{this.enquiries=o,this.loading=!1},o=>{console.error("Error fetching enquiries:",o),this.loading=!1});this.subscription.add(e)}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(o){return new(o||n)(F(G),F(We))}}static{this.\u0275cmp=j({type:n,selectors:[["app-enquiry"]],decls:40,vars:3,consts:[[1,"flex","flex-col","gap-6","absolute","left-0","px-10","w-full"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","p-4","text-left","rounded-lg"],[1,"flex","flex-row","justify-between"],[1,"flex","flex-row","gap-6","align-middle","h-10","items-center"],[1,"text-gray-500","text-sm"],[1,"flex","flex-row","gap-6"],[1,"flex","flex-row","gap-4","items-center"],["class","flex flex-row items-center gap-1",4,"ngFor","ngForOf"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],[1,"flex","flex-row","items-center","gap-1"],["type","checkbox",1,"accent-primary",3,"ngModelChange","value","ngModel"],[1,"bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text","status"],[1,"px-6","py-4"],[1,"px-6","py-4","text-center","flex","flex-row","gap-2"],[1,"text-","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"text-black","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"text-red-500","underline","underline-offset-2","cursor-pointer",3,"click"]],template:function(o,a){o&1&&(i(0,"div",0)(1,"div",1)(2,"table",2)(3,"caption",3)(4,"div",4)(5,"div",5)(6,"span"),r(7,"Enquiry List"),t(),i(8,"span",6),r(9),t()(),i(10,"div",7)(11,"div",8),u(12,xn,4,3,"label",9),t()()()(),i(13,"thead",10)(14,"tr",11)(15,"th",12),r(16,"Id"),t(),i(17,"th",12),r(18,"Name"),t(),i(19,"th",12),r(20,"Age"),t(),i(21,"th",12),r(22,"Email"),t(),i(23,"th",12),r(24,"Phone"),t(),i(25,"th",12),r(26,"Date"),t(),i(27,"th",12),r(28,"Package Name"),t(),i(29,"th",12),r(30,"Technologies"),t(),i(31,"th",12),r(32,"Enquiry Price"),t(),i(33,"th",12),r(34,"Status"),t(),i(35,"th",12),r(36,"Notes"),t(),g(37,"th",12),t()(),i(38,"tbody",13),u(39,vn,32,15,"ng-container",14),t()()()()),o&2&&(l(9),O("Total Enquiries: ",a.enquiries.length,""),l(3),c("ngForOf",a.enquiryStatus),l(27),c("ngForOf",a.filteredEnquiries))},dependencies:[L,fe,R,Je,it],styles:[".status.pending[_ngcontent-%COMP%]{background-color:#ffe082}.status.contacted[_ngcontent-%COMP%]{background-color:#b3e5fc}.status.cancelled[_ngcontent-%COMP%]{background-color:#ffcdd2}.status.confirmed[_ngcontent-%COMP%]{background-color:#c8e6c9}"]})}}return n})();function bn(n,d){if(n&1){let e=k();V(0),i(1,"tr",17)(2,"td",18),r(3),t(),i(4,"td",18),r(5),t(),i(6,"td",18),r(7),t(),i(8,"td",18),r(9),t(),i(10,"td",18),r(11),t(),i(12,"td",18),r(13),t(),i(14,"td",19)(15,"a",20),v("click",function(){let a=C(e).$implicit,s=p(2);return y(s.viewCourse(a))}),r(16,"View"),t()()(),D()}if(n&2){let e=d.$implicit;l(3),_(e.index),l(2),_(e.title),l(2),_(e.description),l(2),_(e.regularPrice),l(2),_(e.discountPrice),l(2),_(e.durationInMonth)}}function Cn(n,d){if(n&1){let e=k();i(0,"table",5)(1,"caption",6)(2,"div",7)(3,"div",8)(4,"span"),r(5,"Package List"),t(),i(6,"span",9),r(7),t(),i(8,"button",10),v("click",function(){C(e);let a=p();return y(a.createNewPackage())}),r(9,"Create new package"),t(),i(10,"button",11),v("click",function(){C(e);let a=p();return y(a.createNewTechnology())}),r(11,"View/Add Technology"),t()()()(),i(12,"thead",12)(13,"tr",13)(14,"th",14),r(15,"Index"),t(),i(16,"th",14),r(17,"Title"),t(),i(18,"th",14),r(19,"Description"),t(),i(20,"th",14),r(21,"Regular Price"),t(),i(22,"th",14),r(23,"Discounted Price"),t(),i(24,"th",14),r(25,"Duration"),t(),g(26,"th",14),t()(),i(27,"tbody",15),u(28,bn,17,6,"ng-container",16),t()()}if(n&2){let e=p();l(7),O("Total Packages: ",e.packages.length,""),l(21),c("ngForOf",e.packages)}}function yn(n,d){n&1&&(i(0,"h3",44),r(1,"Create Package"),t())}function Sn(n,d){n&1&&(i(0,"h3",44),r(1,"Update Package"),t())}function En(n,d){n&1&&(i(0,"div",45),r(1," Index is required and must be 0 or greater. "),t())}function kn(n,d){n&1&&(i(0,"div",45),r(1," Title is required. "),t())}function wn(n,d){n&1&&(i(0,"div",45),r(1," Regular price is required and must be 0 or greater. "),t())}function Pn(n,d){n&1&&(i(0,"div",45),r(1," Discounted price is required and must be 0 or greater. "),t())}function Mn(n,d){n&1&&(i(0,"div",45),r(1," Duration is required and must be at least 1 month. "),t())}function On(n,d){n&1&&(i(0,"div",45),r(1," Description is required. "),t())}function Tn(n,d){if(n&1&&(i(0,"div",46)(1,"span",47),r(2),t()()),n&2){let e,o=p(2);l(2),O(" ",(e=o.packageForm.get("allTechItems"))==null||e.value==null?null:e.value.join(", ")," ")}}function Fn(n,d){if(n&1&&g(0,"app-dropdown",56),n&2){let e=p(3);c("items",e.availableTechnologies)("multiselect",!0)}}function In(n,d){if(n&1&&g(0,"app-dropdown",57),n&2){let e=p(3);c("items",e.packages)("multiselect",!0)}}function Nn(n,d){n&1&&(i(0,"select",58)(1,"option",59),r(2,"None"),t(),i(3,"option",60),r(4,"+"),t(),i(5,"option",61),r(6,"/"),t()())}function Vn(n,d){if(n&1){let e=k();i(0,"div",48)(1,"label",49)(2,"input",50),v("ngModelChange",function(){let a=C(e).$implicit,s=p(2);return y(s.resetTechs(a))}),t(),i(3,"span"),r(4,"Is Package"),t()(),u(5,Fn,1,2,"app-dropdown",51)(6,In,1,2,"app-dropdown",52)(7,Nn,7,0,"select",53),i(8,"button",54),v("click",function(){let a=C(e).index,s=p(2);return y(s.technologies.removeAt(a))}),r(9,"-Remove"),t(),i(10,"span",55),r(11),t()()}if(n&2){let e,o,a,s=d.$implicit,m=d.index,S=p(2);c("formGroupName",m),l(5),c("ngIf",!((e=s.get("isPackage"))!=null&&e.value)),l(),c("ngIf",(o=s.get("isPackage"))==null?null:o.value),l(),c("ngIf",((a=s.get("techs"))==null||a.value==null?null:a.value.length)>1||((a=s.get("packages"))==null||a.value==null?null:a.value.length)>1),l(4),_(S.getTechString(s))}}function Dn(n,d){if(n&1){let e=k();i(0,"button",62),v("click",function(){C(e);let a=p(2);return y(a.deletePackage())}),r(1," Delete Package "),t()}}function Bn(n,d){if(n&1){let e=k();i(0,"div",21)(1,"div",22)(2,"div",23),u(3,yn,2,0,"h3",24)(4,Sn,2,0,"h3",24),i(5,"button",25),v("click",function(){C(e);let a=p();return y(a.closeCourse())}),r(6," \xD7 "),t()(),g(7,"app-loader",2),i(8,"form",26)(9,"div",27)(10,"div")(11,"label",28),r(12,"Index"),t(),g(13,"input",29),u(14,En,2,0,"div",30),t(),i(15,"div")(16,"label",28),r(17,"Title"),t(),g(18,"input",31),u(19,kn,2,0,"div",30),t(),i(20,"div")(21,"label",28),r(22,"Regular Price"),t(),g(23,"input",32),u(24,wn,2,0,"div",30),t()(),i(25,"div",27)(26,"div")(27,"label",28),r(28,"Discounted Price"),t(),g(29,"input",33),u(30,Pn,2,0,"div",30),t(),i(31,"div")(32,"label",28),r(33,"Duration (Months)"),t(),g(34,"input",34),u(35,Mn,2,0,"div",30),t(),i(36,"div")(37,"label",28),r(38,"Description"),t(),g(39,"input",35),u(40,On,2,0,"div",30),t()(),u(41,Tn,3,1,"div",36),i(42,"div")(43,"label",28),r(44,"Technologies"),t(),i(45,"div",37),u(46,Vn,12,5,"div",38),i(47,"button",39),v("click",function(){C(e);let a=p();return y(a.addTechnology())}),r(48,"Add Technology"),t()()(),i(49,"div",40)(50,"button",41),v("click",function(){C(e);let a=p();return y(a.onSubmit())}),r(51),t(),u(52,Dn,2,0,"button",42),i(53,"button",43),v("click",function(){C(e);let a=p();return y(a.closeCourse())}),r(54,"Cancel"),t()()()()()}if(n&2){let e,o,a,s,m,S,x,f=p();l(3),c("ngIf",!f.selectedPackage),l(),c("ngIf",f.selectedPackage),l(3),c("loading",f.packageProcessing),l(),H("hidden",f.packageProcessing),c("formGroup",f.packageForm),l(6),c("ngIf",((e=f.packageForm.get("index"))==null?null:e.invalid)&&((e=f.packageForm.get("index"))==null?null:e.touched)),l(5),c("ngIf",((o=f.packageForm.get("title"))==null?null:o.invalid)&&((o=f.packageForm.get("title"))==null?null:o.touched)),l(5),c("ngIf",((a=f.packageForm.get("regularPrice"))==null?null:a.invalid)&&((a=f.packageForm.get("regularPrice"))==null?null:a.touched)),l(6),c("ngIf",((s=f.packageForm.get("discountPrice"))==null?null:s.invalid)&&((s=f.packageForm.get("discountPrice"))==null?null:s.touched)),l(5),c("ngIf",((m=f.packageForm.get("durationInMonth"))==null?null:m.invalid)&&((m=f.packageForm.get("durationInMonth"))==null?null:m.touched)),l(5),c("ngIf",((S=f.packageForm.get("description"))==null?null:S.invalid)&&((S=f.packageForm.get("description"))==null?null:S.touched)),l(),c("ngIf",(x=f.packageForm.get("allTechItems"))==null||x.value==null?null:x.value.length),l(5),c("ngForOf",f.technologies.controls),l(5),O(" ",f.selectedPackage?"Update":"Create"," Package "),l(),c("ngIf",!!f.selectedPackage)}}function qn(n,d){n&1&&(i(0,"div",45),r(1," Name is required. "),t())}function An(n,d){n&1&&(i(0,"div",45),r(1," Full Name is required. "),t())}function jn(n,d){n&1&&(i(0,"div",45),r(1," Description is required. "),t())}function Ln(n,d){n&1&&(i(0,"div",45),r(1," Icon URL is required. "),t())}function Rn(n,d){n&1&&(i(0,"div",45),r(1," Alt Text is required. "),t())}function $n(n,d){if(n&1){let e=k();i(0,"tr",69)(1,"td",70),r(2),t(),i(3,"td",70),g(4,"input",71),u(5,qn,2,0,"div",30),t(),i(6,"td",70),g(7,"input",72),u(8,An,2,0,"div",30),t(),i(9,"td",70),g(10,"input",73),u(11,jn,2,0,"div",30),t(),i(12,"td",70),g(13,"input",74),u(14,Ln,2,0,"div",30),t(),i(15,"td",70),g(16,"input",75),u(17,Rn,2,0,"div",30),t(),i(18,"td",76)(19,"button",77),v("click",function(){C(e);let a=p(3);return y(a.saveTechnology())}),r(20," Save "),t(),i(21,"button",78),v("click",function(){C(e);let a=p(3);return y(a.clearTechForm())}),r(22," Cancel "),t()()()}if(n&2){let e,o,a,s,m,S,x=p(3);l(2),O(" ",((e=x.technologyForm.get("id"))==null?null:e.value)||"-Will be generated-"," "),l(3),c("ngIf",((o=x.technologyForm.get("name"))==null?null:o.invalid)&&((o=x.technologyForm.get("name"))==null?null:o.touched)),l(3),c("ngIf",((a=x.technologyForm.get("fullName"))==null?null:a.invalid)&&((a=x.technologyForm.get("fullName"))==null?null:a.touched)),l(3),c("ngIf",((s=x.technologyForm.get("description"))==null?null:s.invalid)&&((s=x.technologyForm.get("description"))==null?null:s.touched)),l(3),c("ngIf",((m=x.technologyForm.get("iconUrl"))==null?null:m.invalid)&&((m=x.technologyForm.get("iconUrl"))==null?null:m.touched)),l(3),c("ngIf",((S=x.technologyForm.get("altText"))==null?null:S.invalid)&&((S=x.technologyForm.get("altText"))==null?null:S.touched))}}function Gn(n,d){if(n&1){let e=k();V(0),i(1,"tr",17)(2,"td",18),r(3),t(),i(4,"td",18),r(5),t(),i(6,"td",18),r(7),t(),i(8,"td",18),r(9),t(),i(10,"td",18),r(11),t(),i(12,"td",18),r(13),t(),i(14,"td",19)(15,"button",79),v("click",function(){let a=C(e).$implicit,s=p(3);return y(s.editTechnology(a))}),r(16," Edit "),t(),i(17,"button",80),v("click",function(){let a=C(e).$implicit,s=p(3);return y(s.deleteTechnology(a))}),i(18,"span",81),r(19,"delete"),t()()()(),D()}if(n&2){let e=d.$implicit;l(3),_(e.id),l(2),_(e.name),l(2),_(e.fullName),l(2),_(e.description),l(2),_(e.iconUrl),l(2),_(e.altText)}}function Un(n,d){if(n&1){let e=k();i(0,"div",65)(1,"form",66)(2,"table",5)(3,"caption")(4,"div",67)(5,"button",10),v("click",function(){C(e);let a=p(2);return y(a.addingNewTech=!0)}),r(6,"Create new Technology"),t()()(),i(7,"thead",12)(8,"tr",13)(9,"th",14),r(10,"Id"),t(),i(11,"th",14),r(12,"Name"),t(),i(13,"th",14),r(14,"Full Name"),t(),i(15,"th",14),r(16,"Description"),t(),i(17,"th",14),r(18,"Icon Url"),t(),i(19,"th",14),r(20,"Alt text"),t(),g(21,"th",14),t()(),i(22,"tbody",15),u(23,$n,23,6,"tr",68)(24,Gn,20,6,"ng-container",16),t()()()()}if(n&2){let e=p(2);l(),c("formGroup",e.technologyForm),l(22),c("ngIf",e.addingNewTech),l(),c("ngForOf",e.availableTechnologies)}}function zn(n,d){if(n&1){let e=k();i(0,"div",21)(1,"div",63)(2,"div",23)(3,"h3",44),r(4,"Technologies"),t(),i(5,"button",25),v("click",function(){C(e);let a=p();return y(a.technologyModalOpen=!1)}),r(6," \xD7 "),t()(),g(7,"app-loader",2),u(8,Un,25,3,"div",64),t()()}if(n&2){let e=p();l(7),c("loading",e.techProcessing),l(),c("ngIf",!e.techProcessing)}}var _t=(()=>{class n{constructor(e,o){this.firebaseService=e,this.fb=o,this.loading=!0,this.packages=[],this.isOpen=!1,this.subscription=new A,this.availableTechnologies=[],this.technologyMap={},this.packageProcessing=!1,this.techProcessing=!1,this.technologyModalOpen=!1,this.addingNewTech=!1,this.packageForm=this.fb.group({index:[null,[h.required,h.min(0)]],title:[null,h.required],description:[null,h.required],regularPrice:[null,[h.required,h.min(0)]],discountPrice:[null,[h.required,h.min(0)]],durationInMonth:[null,[h.required,h.min(1)]],allTechItems:[[]],technologies:this.fb.array([])}),this.technologyForm=this.fb.group({id:[null],name:[null,h.required],fullName:[null,h.required],description:[null,h.required],iconUrl:[null,h.required],altText:[null,h.required]})}get technologies(){return this.packageForm.get("technologies")}addTechnology(e){this.technologies.push(this.fb.group({techs:[[]],packages:[[]],isPackage:[e?.isPackage||!1],combinationBy:[e?.combinationBy||""]}))}removeTechnology(e){this.technologies.removeAt(e)}ngOnInit(){this.fetchPackages()}createNewPackage(){this.isOpen=!0,this.selectedPackage=void 0,this.packageForm.reset(),this.technologies.clear(),this.packageForm.setControl("technologies",this.fb.array([])),this.packageForm.patchValue({index:this.packages.length+1,title:null,description:null,regularPrice:null,discountPrice:null,durationInMonth:null,allTechItems:[]}),this.packageForm.updateValueAndValidity(),this.addTechnology()}viewCourse(e){this.isOpen=!0,this.selectedPackage=e,this.packageForm.reset(),this.technologies.clear();let o=e.technologies||[];o.forEach(a=>{if(a.isPackage){let s=[];a.name.forEach(m=>{let S=this.packages.find(x=>x.title===m);S&&s.push(S)}),this.technologies.push(this.fb.group({packages:[s],techs:[[]],isPackage:[!0],combinationBy:[a.combinationBy||""]}))}else this.technologies.push(this.fb.group({techs:[a.name],packages:[[]],isPackage:[!1],combinationBy:[a.combinationBy||""]}))}),this.packageForm.patchValue({index:e.index,title:e.title,description:e.description,regularPrice:e.regularPrice,discountPrice:e.discountPrice,durationInMonth:e.durationInMonth,allTechItems:e.allTechItems||[],technologies:o}),this.packageForm.updateValueAndValidity()}closeCourse(){this.selectedPackage=void 0,this.technologies.clear(),this.isOpen=!1}getTechString(e){return e.get("isPackage")?.value?`${e.get("packages")?.value?.map(o=>o.title)?.join(" "+e.get("combinationBy")?.value+" ")}`:`${e.get("techs")?.value.map(o=>this.technologyMap[o]?.name)?.join(" "+e.get("combinationBy")?.value+" ")}`}resetTechs(e){e.get("packages")?.setValue([]),e.get("techs")?.setValue([]),e.updateValueAndValidity()}deletePackage(){if(!this.selectedPackage)return;let e=this.selectedPackage.id;e&&confirm("Are you sure you want to delete this package?")&&(this.packageProcessing=!0,this.subscription.add(M(this.firebaseService.deleteData(E.coursePackages,e)).subscribe({next:()=>{window.alert("Package deleted successfully"),this.selectedPackage=void 0,this.technologies.clear(),this.packageForm.reset(),this.packageProcessing=!1,this.isOpen=!1,this.fetchPackages()},error:o=>{this.packageProcessing=!1,window.alert("Error deleting package:")}})))}onSubmit(){if(this.packageForm.invalid){this.packageForm.markAllAsTouched();return}this.packageProcessing=!0;let e=this.packageForm.value,o={index:e.index,title:e.title,description:e.description,regularPrice:e.regularPrice,discountPrice:e.discountPrice,durationInMonth:e.durationInMonth,allTechItems:e.allTechItems||[]},a=[],s=new Set;e.technologies.forEach(m=>{if(m.isPackage){let S={name:m.packages.map(x=>x.title),isPackage:!0,combinationBy:m.combinationBy};m.packages.forEach(x=>{x.allTechItems.forEach(f=>{s.add(f)})}),a.push(S)}else{let S={name:m.techs,isPackage:!1,combinationBy:m.combinationBy};m.techs.forEach(x=>{s.add(this.technologyMap[x].name)}),a.push(S)}}),o.technologies=a,o.allTechItems=Array.from(s),this.subscription.add(M(this.selectedPackage?this.firebaseService.updateData(E.coursePackages,this.selectedPackage.id||"",o):this.firebaseService.saveNewData(E.coursePackages,o)).subscribe({next:()=>{window.alert("Package created successfully"),this.fetchPackages(),this.packageProcessing=!1,this.isOpen=!1},error:m=>{window.alert("Error creating package:"),this.packageProcessing=!1}}))}loadAllTechnologies(){this.firebaseService.getAllFromCollection(E.technologies).subscribe(e=>{this.availableTechnologies=e.sort((o,a)=>o.name.localeCompare(a.name)),this.availableTechnologies.forEach(o=>{this.technologyMap[o.id]=o})})}fetchPackages(){this.loading=!0,this.subscription.add(this.firebaseService.getAllFromCollection(E.coursePackages).subscribe({next:e=>{this.packages=e.sort((o,a)=>o.index-a.index),this.loading=!1,this.loadAllTechnologies()},error:e=>{console.error("Error fetching packages:",e),this.loading=!1}}))}createNewTechnology(){this.closeCourse(),this.technologyModalOpen=!0,this.technologyForm.reset(),this.technologyForm.setValue({id:null,name:null,fullName:null,description:null,iconUrl:null,altText:null}),this.technologyForm.updateValueAndValidity()}saveTechnology(){if(this.technologyForm.invalid){this.technologyForm.markAllAsTouched();return}this.techProcessing=!0;let e=this.technologyForm.value,o=!!e.id;this.subscription.add(M(o?this.firebaseService.updateData(E.technologies,e.id,e):this.firebaseService.saveNewData(E.technologies,e)).subscribe({next:()=>{window.alert("Technology saved successfully"),this.techProcessing=!1,this.addingNewTech=!1,this.loadAllTechnologies()},error:a=>{console.error("Error saving technology:",a),window.alert("Error saving technology"),this.techProcessing=!1}}))}editTechnology(e){this.technologyModalOpen=!0,this.technologyForm.reset(),this.technologyForm.setValue({id:e.id,name:e.name,fullName:e.fullName,description:e.description,iconUrl:e.iconUrl,altText:e.altText}),this.technologyForm.updateValueAndValidity(),this.addingNewTech=!0}deleteTechnology(e){confirm(`Are you sure you want to delete the technology: ${e.name}?`)&&(this.techProcessing=!0,this.subscription.add(M(this.firebaseService.deleteData(E.technologies,e.id)).subscribe({next:()=>{window.alert("Technology deleted successfully"),this.loadAllTechnologies(),this.techProcessing=!1},error:o=>{console.error("Error deleting technology:",o),window.alert("Error deleting technology"),this.techProcessing=!1}})))}ngOnDestroy(){this.subscription.unsubscribe()}clearTechForm(){this.technologyForm.reset(),this.technologyForm.setValue({id:null,name:null,fullName:null,description:null,iconUrl:null,altText:null}),this.technologyForm.updateValueAndValidity(),this.addingNewTech=!1}static{this.\u0275fac=function(o){return new(o||n)(F(G),F(te))}}static{this.\u0275cmp=j({type:n,selectors:[["app-packages"]],decls:6,vars:4,consts:[[1,"flex","flex-col","gap-6","absolute","left-0","px-10","w-full"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg","mb-32"],[3,"loading"],["class","w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400 rounded-lg",4,"ngIf"],["class","fixed inset-0 z-30 flex items-center justify-center bg-black bg-opacity-40 backdrop-blur-sm ",4,"ngIf"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","p-4","text-left","rounded-lg"],[1,"flex","flex-row","justify-between"],[1,"flex","flex-row","gap-6","align-middle","h-10","items-center"],[1,"text-gray-500","text-sm"],[1,"button-primary-sm",3,"click"],[1,"button-accent-sm",3,"click"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],[1,"bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text"],[1,"px-6","py-4"],[1,"px-6","py-4","text-center","flex","flex-row","gap-2"],[1,"text-","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"fixed","inset-0","z-30","flex","items-center","justify-center","bg-black","bg-opacity-40","backdrop-blur-sm"],[1,"relative","z-40","bg-secondary","rounded-lg","shadow-lg","p-6","w-1/2","max-h-[85vh]","overflow-y-auto"],[1,"flex","flex-row","justify-between","w-full","bg-primary","py-3","px-5","text-white","rounded-lg","align-middle"],["class","text-lg font-semibold ",4,"ngIf"],["aria-label","Close",1,"text-3xl","font-semibold","cursor-pointer","hover:text-gray-300","transition-colors",3,"click"],[1,"mt-6","flex","flex-col","gap-6",3,"formGroup"],[1,"grid","grid-cols-3","gap-4"],[1,"block","mb-1","font-medium"],["type","number","formControlName","index","min","0","readonly","",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["class","text-red-500 text-xs",4,"ngIf"],["type","text","formControlName","title",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","number","formControlName","regularPrice","min","0",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","number","formControlName","discountPrice","min","0",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","number","formControlName","durationInMonth","min","1",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["formControlName","description","rows","3",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["class","bg-slate-300 px-4 py-2 border border-1 border-primary rounded-lg w-full",4,"ngIf"],["formArrayName","technologies",1,"flex","flex-col","w-full","gap-4"],["class","flex flex-row gap-4 items-center",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"button-primary-sm","mt-2","w-fit",3,"click"],[1,"flex","justify-end","gap-4","mt-4"],["type","submit",1,"button-primary-sm",3,"click"],["type","submit","class","button-primary-sm bg-red-500",3,"click",4,"ngIf"],["type","button",1,"button-secondary-sm",3,"click"],[1,"text-lg","font-semibold"],[1,"text-red-500","text-xs"],[1,"bg-slate-300","px-4","py-2","border","border-1","border-primary","rounded-lg","w-full"],[1,"text-primary","text-lg","font-outfit"],[1,"flex","flex-row","gap-4","items-center",3,"formGroupName"],[1,"flex","items-center","gap-1"],["type","checkbox","formControlName","isPackage",3,"ngModelChange"],["formControlName","techs","labelKey","name","valueKey","id",3,"items","multiselect",4,"ngIf"],["formControlName","packages","labelKey","title",3,"items","multiselect",4,"ngIf"],["formControlName","combinationBy","class","px-4 py-2 border border-black rounded-lg",4,"ngIf"],["type","button",1,"text-red-600","font-semibold","text-lg",3,"click"],[1,"text-gray-600"],["formControlName","techs","labelKey","name","valueKey","id",3,"items","multiselect"],["formControlName","packages","labelKey","title",3,"items","multiselect"],["formControlName","combinationBy",1,"px-4","py-2","border","border-black","rounded-lg"],["value",""],["value","+"],["value","/"],["type","submit",1,"button-primary-sm","bg-red-500",3,"click"],[1,"relative","z-40","bg-secondary","rounded-lg","shadow-lg","p-6","w-[95vw]","max-h-[85vh]","overflow-y-auto"],["class","flex flex-row justify-between w-full py-3 px-5 text-white rounded-lg align-middle",4,"ngIf"],[1,"flex","flex-row","justify-between","w-full","py-3","px-5","text-white","rounded-lg","align-middle"],[3,"formGroup"],[1,"flex","flex-row","justify-end"],["class","bg-yellow-50 border-2 border-primary dark:bg-gray-800 dark:border-gray-700 text-text ",4,"ngIf"],[1,"bg-yellow-50","border-2","border-primary","dark:bg-gray-800","dark:border-gray-700","text-text"],[1,"px-2","py-2"],["type","text","formControlName","name",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","text","formControlName","fullName",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","text","formControlName","description",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","text","formControlName","iconUrl",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","text","formControlName","altText",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],[1,"px-2","py-2","text-center","flex","flex-row","gap-2","text-lg","align-middle"],["title","Approve",1,"text-green-600","hover:text-green-800",3,"click"],["title","Approve",1,"text-gray-600","hover:text-black","text-lg",3,"click"],["title","Edit",1,"text-blue-600","hover:text-blue-800",3,"click"],["title","Delete",1,"text-red-600","hover:text-red-800",3,"click"],["aria-label","Delete","title","Delete",1,"material-icons","text-lg","align-middle"]],template:function(o,a){o&1&&(i(0,"div",0)(1,"div",1),g(2,"app-loader",2),u(3,Cn,29,2,"table",3),t()(),u(4,Bn,55,16,"div",4)(5,zn,9,2,"div",4)),o&2&&(l(2),c("loading",a.loading),l(),c("ngIf",!a.loading),l(),c("ngIf",a.isOpen),l(),c("ngIf",a.technologyModalOpen))},dependencies:[L,oe,J,X,ee,K,_e,fe,Q,R,W,Ye,Y,Z,re,ae,le,he]})}}return n})();function Hn(n,d){if(n&1&&(i(0,"span"),r(1),g(2,"br"),t()),n&2){let e=d.$implicit;l(),O("",e," ")}}function Kn(n,d){if(n&1){let e=k();V(0),i(1,"tr",12)(2,"td",13),r(3),t(),i(4,"td",13),r(5),t(),i(6,"td",13),r(7),t(),i(8,"td",13),r(9),t(),i(10,"td",13),r(11),t(),i(12,"td",13),r(13),t(),i(14,"td",13),r(15),t(),i(16,"td",13),u(17,Hn,3,1,"span",10),t(),i(18,"td",13),r(19),t(),i(20,"td",14)(21,"a",15),v("click",function(){let a=C(e).$implicit,s=p();return y(s.openBatch(a))}),r(22,"View"),t()()(),D()}if(n&2){let e=d.$implicit,o=p();l(3),_(e.id),l(2),_(e.name),l(2),_(e.instructorName),l(2),_(e.strength),l(2),_(e.startDate),l(2),_(e.endDate),l(2),_(e.status),l(2),c("ngForOf",o.getFormattedSchedule(e.weeklySchedule)),l(2),_(e.description)}}function Wn(n,d){n&1&&(i(0,"div",43),r(1," Id is required. "),t())}function Jn(n,d){n&1&&(i(0,"div",43),r(1," Name is required. "),t())}function Yn(n,d){n&1&&(i(0,"div",43),r(1," Status is required. "),t())}function Zn(n,d){n&1&&(i(0,"div",43),r(1," Instructor is required. "),t())}function Qn(n,d){n&1&&(i(0,"div",43),r(1," Start date is required. "),t())}function Xn(n,d){n&1&&(i(0,"div",43),r(1," End date is required. "),t())}function ei(n,d){n&1&&(i(0,"div",43),r(1," End date cannot be before start date. "),t())}function ti(n,d){if(n&1&&(i(0,"option",51),r(1),t()),n&2){let e=d.$implicit;c("value",e),l(),_(e)}}function ni(n,d){n&1&&(i(0,"div",43),r(1," Day is required. "),t())}function ii(n,d){n&1&&(i(0,"div",43),r(1," Start Time is required. "),t())}function oi(n,d){n&1&&(i(0,"div",43),r(1," End Time is required. "),t())}function ri(n,d){n&1&&(i(0,"div",43),r(1," End time cannot be before start time. "),t())}function ai(n,d){if(n&1){let e=k();i(0,"button",52),v("click",function(){C(e);let a=p().index,s=p(2);return y(s.removeSchedule(a))}),r(1," - Remove"),t()}}function li(n,d){if(n&1&&(i(0,"div",44)(1,"div")(2,"select",45)(3,"option",46),r(4,"Select Day"),t(),u(5,ti,2,2,"option",47),t(),u(6,ni,2,0,"div",27),t(),i(7,"div"),g(8,"input",48),u(9,ii,2,0,"div",27),t(),i(10,"div"),g(11,"input",49),u(12,oi,2,0,"div",27)(13,ri,2,0,"div",27),t(),u(14,ai,2,0,"button",50),t()),n&2){let e,o,a,s,m=d.$implicit,S=d.index,x=p(2);c("formGroupName",S),l(5),c("ngForOf",x.weekDays),l(),c("ngIf",((e=m.get("day"))==null?null:e.touched)&&((e=m.get("day"))==null?null:e.invalid)),l(3),c("ngIf",((o=m.get("startTime"))==null?null:o.touched)&&((o=m.get("startTime"))==null?null:o.invalid)),l(3),c("ngIf",((a=m.get("endTime"))==null?null:a.touched)&&((a=m.get("endTime"))==null?null:a.invalid)),l(),c("ngIf",(m.errors==null?null:m.errors.endTimeBeforeStartTime)&&(((s=m.get("endTime"))==null?null:s.touched)||((s=m.get("startTime"))==null?null:s.touched))),l(),c("ngIf",x.weeklySchedule.length>1)}}function di(n,d){if(n&1){let e=k();i(0,"button",53),v("click",function(){C(e);let a=p(2);return y(a.removeBatch())}),r(1,"Remove Batch"),t()}}function ci(n,d){if(n&1){let e=k();i(0,"div",16)(1,"div",17)(2,"div",18)(3,"div",19)(4,"span",20),r(5),t(),i(6,"button",21),v("click",function(){C(e);let a=p();return y(a.showModal=!1)}),r(7,"\xD7"),t()(),i(8,"form",22)(9,"div",23)(10,"div",24)(11,"div",25)(12,"label"),r(13,"Id"),t(),g(14,"input",26),u(15,Wn,2,0,"div",27),t(),i(16,"div",28)(17,"label"),r(18,"Name"),t(),g(19,"input",29),u(20,Jn,2,0,"div",27),t(),i(21,"div",25)(22,"label"),r(23,"Status"),t(),g(24,"input",30),u(25,Yn,2,0,"div",27),t()(),i(26,"div",24)(27,"div",28)(28,"label"),r(29,"Instructor"),t(),g(30,"input",31),u(31,Zn,2,0,"div",27),t(),i(32,"div",28)(33,"label"),r(34,"Start Date"),t(),g(35,"input",32),u(36,Qn,2,0,"div",27),t(),i(37,"div",28)(38,"label"),r(39,"End Date"),t(),g(40,"input",33),u(41,Xn,2,0,"div",27)(42,ei,2,0,"div",27),t()(),i(43,"div",24)(44,"div",28)(45,"label"),r(46,"Description"),t(),g(47,"input",34),t()(),i(48,"div",28)(49,"div",35)(50,"label"),r(51,"Weekly Schedule "),t(),i(52,"button",36),v("click",function(){C(e);let a=p();return y(a.addSchedule())}),r(53,"+ Add Day "),t()(),i(54,"div",37),u(55,li,15,7,"div",38),t()()(),i(56,"div",39)(57,"button",40),v("click",function(){C(e);let a=p();return y(a.showModal=!1)}),r(58,"Cancel"),t(),i(59,"button",41),v("click",function(){C(e);let a=p();return y(a.onSubmit())}),r(60),t(),u(61,di,2,0,"button",42),t()()()()()}if(n&2){let e,o,a,s,m,S,x,f=p();l(5),O("",f.selectedBatch?"Update":"Create"," Batch"),l(3),c("formGroup",f.batchForm),l(7),c("ngIf",((e=f.batchForm.get("id"))==null?null:e.touched)&&((e=f.batchForm.get("id"))==null?null:e.invalid)),l(5),c("ngIf",((o=f.batchForm.get("name"))==null?null:o.touched)&&((o=f.batchForm.get("name"))==null?null:o.invalid)),l(5),c("ngIf",((a=f.batchForm.get("status"))==null?null:a.touched)&&((a=f.batchForm.get("status"))==null?null:a.invalid)),l(6),c("ngIf",((s=f.batchForm.get("instructorName"))==null?null:s.touched)&&((s=f.batchForm.get("instructorName"))==null?null:s.invalid)),l(5),c("ngIf",((m=f.batchForm.get("startDate"))==null?null:m.touched)&&((m=f.batchForm.get("startDate"))==null?null:m.invalid)),l(5),c("ngIf",((S=f.batchForm.get("endDate"))==null?null:S.touched)&&((S=f.batchForm.get("endDate"))==null?null:S.invalid)),l(),c("ngIf",(f.batchForm.errors==null?null:f.batchForm.errors.endDateBeforeStartDate)&&(((x=f.batchForm.get("endDate"))==null?null:x.touched)||((x=f.batchForm.get("startDate"))==null?null:x.touched))),l(13),c("ngForOf",f.weeklySchedule.controls),l(5),_(f.selectedBatch?"Update":"Create"),l(),c("ngIf",f.selectedBatch)}}var ht=(()=>{class n{constructor(e,o){this.fb=e,this.fireBaseService=o,this.showModal=!1,this.weekDays=Object.values(et),this.batches=[],this.students=[],this.subscription=new A,this.batchForm=this.fb.group({id:[""],name:["",h.required],startDate:[null,h.required],endDate:[null],status:[null],instructorName:["",h.required],weeklySchedule:this.fb.array([this.fb.group({day:[null,h.required],startTime:["",h.required],endTime:["",h.required]},{validators:a=>{let s=a.get("startTime")?.value,m=a.get("endTime")?.value;return s&&m&&m<s?{endTimeBeforeStartTime:!0}:null}})]),description:[""]},{validators:a=>{let s=a.get("startDate")?.value,m=a.get("endDate")?.value;return s&&m&&new Date(m)<new Date(s)?{endDateBeforeStartDate:!0}:null}}),this.setStartDateChanges()}setStartDateChanges(){this.subscription.add(this.batchForm.get("startDate")?.valueChanges.subscribe(()=>{this.batchForm.patchValue({status:this.calculateBatchStatus()}),this.batchForm.updateValueAndValidity()}))}calculateBatchStatus(){let e=this.batchForm.get("startDate")?.value,o=this.batchForm.get("endDate")?.value,a=new Date;return e&&a<new Date(e)?xe.notStarted:o&&a>new Date(o)?xe.completed:xe.inProgress}ngOnInit(){this.fetchBatches(),this.loadAllStudents()}loadAllStudents(){this.subscription.add(this.fireBaseService.getAllFromCollection(E.students).subscribe({next:e=>{this.students=e||[],this.batches.forEach(o=>{o.strength=this.getBatchStrength(o.id)})},error:e=>{console.error("Error fetching students:",e)}}))}getBatchStrength(e){let o=0;return this.students.forEach(a=>{a.course.batchName===e&&o++}),o}fetchBatches(){this.subscription.add(this.fireBaseService.getAllFromCollection(E.batches).subscribe({next:e=>{this.batches=e||[]},error:e=>{console.error("Error fetching batches:",e)}}))}get weeklySchedule(){return this.batchForm.get("weeklySchedule")}addSchedule(e={day:null,startTime:"",endTime:""}){this.weeklySchedule.push(this.fb.group({day:[e?.day??null,h.required],startTime:[e?.startTime??"",h.required],endTime:[e?.endTime??"",h.required]}))}removeSchedule(e){this.weeklySchedule.removeAt(e)}onSubmit(){if(this.batchForm.valid){let e=ue(I({},this.batchForm.value),{id:this.batchForm.value.id||this.fireBaseService.generateId()});this.selectedBatch?this.subscription.add(M(this.fireBaseService.updateData(E.batches,this.selectedBatch.id,e)).subscribe({next:o=>{window.alert("Batch updated successfully")},error:o=>{window.alert("Failed to update batch")}})):this.subscription.add(M(this.fireBaseService.saveNewData(E.batches,e)).subscribe({next:o=>{window.alert("Batch added successfully")},error:o=>{window.alert("Failed to add batch")}})),this.showModal=!1}else this.batchForm.markAllAsTouched()}openBatchModal(){this.showModal=!0,this.batchForm.reset()}openBatch(e){this.selectedBatch=e,this.batchForm.patchValue(e),this.weeklySchedule.clear(),e.weeklySchedule.forEach(o=>{this.addSchedule(o)}),this.batchForm.updateValueAndValidity(),this.showModal=!0}getFormattedSchedule(e){return e.map(o=>`${o.day} (${o.startTime} - ${o.endTime})`)}removeBatch(){this.selectedBatch&&confirm(`Are you sure you want to delete the batch: ${this.selectedBatch?.name}?`)&&this.subscription.add(M(this.fireBaseService.deleteData(E.batches,this.selectedBatch?.id)).subscribe({next:()=>{window.alert("Batch deleted successfully"),this.fetchBatches(),this.selectedBatch=void 0,this.showModal=!1},error:e=>{window.alert("Failed to delete batch")}}))}ngOnDestroy(){this.subscription.unsubscribe(),this.selectedBatch=void 0,this.showModal=!1}static{this.\u0275fac=function(o){return new(o||n)(F(te),F(G))}}static{this.\u0275cmp=j({type:n,selectors:[["app-batch"]],decls:33,vars:2,consts:[[1,"flex","flex-col","gap-2","absolute","left-0","px-10","w-full","-mt-6"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","px-4","py-1","text-left","rounded-lg"],[1,"flex","flex-row","gap-6","items-center","h-10","justify-between"],[1,"button-primary-xs",3,"click"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],["class","modal",4,"ngIf"],[1,"py-2","h-5","text-xs","font-poppins","bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text","hover:outline","hover:outline-1","hover:outline-black","hover:bg-yellow-50"],[1,"px-6","py-3","text-text"],[1,"px-6","text-center"],[1,"text-blue","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"modal"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["aria-label","Close",1,"close",3,"click"],[3,"formGroup"],[1,"modal-body"],[1,"grid","grid-cols-3","gap-8"],[1,"form-group","pointer-events-none"],["formControlName","id","readonly","",1,"bg-slate-300"],["class","error-message",4,"ngIf"],[1,"form-group"],["formControlName","name"],["formControlName","status","readonly","",1,"bg-slate-300"],["formControlName","instructorName"],["type","date","formControlName","startDate"],["type","date","formControlName","endDate"],["formControlName","description"],[1,"flex","flex-row","gap-4","mb-3","items-center"],[1,"text-lg","font-poppins","text-black","border","border-1","rounded-lg","ml-3","bg-secondary","px-3","py-1","hover:bg-white",3,"click"],["formArrayName","weeklySchedule"],["class","grid grid-cols-4 gap-8 mb-2",3,"formGroupName",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"button-secondary-xs",3,"click"],["type","button",1,"button-primary-xs",3,"click"],["type","button","class","button-primary-xs bg-red-400",3,"click",4,"ngIf"],[1,"error-message"],[1,"grid","grid-cols-4","gap-8","mb-2",3,"formGroupName"],["formControlName","day",1,"form-select"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["type","time","formControlName","startTime","placeholder","Start Time"],["type","time","formControlName","endTime","placeholder","End Time"],["class","text-lg font-poppins text-black border border-1 rounded-lg ml-3 bg-red-200 px-3 py-1 hover:bg-red-400",3,"click",4,"ngIf"],[3,"value"],[1,"text-lg","font-poppins","text-black","border","border-1","rounded-lg","ml-3","bg-red-200","px-3","py-1","hover:bg-red-400",3,"click"],["type","button",1,"button-primary-xs","bg-red-400",3,"click"]],template:function(o,a){o&1&&(i(0,"div",0)(1,"div",1)(2,"table",2)(3,"caption",3)(4,"div",4)(5,"span"),r(6,"Batch List"),t(),i(7,"button",5),v("click",function(){return a.openBatchModal()}),r(8,"+ Create Batch"),t()()(),i(9,"thead",6)(10,"tr",7)(11,"th",8),r(12,"Id"),t(),i(13,"th",8),r(14,"Name"),t(),i(15,"th",8),r(16,"Instructor"),t(),i(17,"th",8),r(18,"Strength"),t(),i(19,"th",8),r(20,"Start Date"),t(),i(21,"th",8),r(22,"End Date"),t(),i(23,"th",8),r(24,"Status"),t(),i(25,"th",8),r(26,"Weekly Schedule"),t(),i(27,"th",8),r(28,"Description"),t(),g(29,"th",8),t()(),i(30,"tbody",9),u(31,Kn,23,9,"ng-container",10),t()()()(),u(32,ci,62,12,"div",11)),o&2&&(l(31),c("ngForOf",a.batches),l(),c("ngIf",a.showModal))},dependencies:[L,oe,J,X,ee,K,Q,R,W,Y,Z,re,ae],styles:[".modal[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:#00000080;position:fixed;inset:0;height:100vh;width:100vw;z-index:1050}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:8px;width:70%;height:90%;overflow-y:auto;margin:2rem auto;box-shadow:0 4px 24px #0003}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{border:none;border-radius:8px;overflow:hidden}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.5rem;border-bottom:1px solid #e9ecef;background:#f8f9fa}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{background:transparent;border:none;font-size:1.5rem;cursor:pointer;color:#333;transition:color .2s}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover{color:#d9534f}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid #ced4da;border-radius:4px;font-size:1rem;transition:border-color .2s}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#d9534f;font-size:.875rem;margin-top:.25rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:1rem 1.5rem;border-top:1px solid #e9ecef;background:#f8f9fa}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px;margin-left:.5rem}"]})}}return n})();var si=[{path:"students",component:gt,canActivate:[me]},{path:"enquiries",component:ft,canActivate:[me]},{path:"packages",component:_t,canActivate:[me]},{path:"batches",component:ht,canActivate:[me]}],xt=(()=>{class n{static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275mod=ge({type:n})}static{this.\u0275inj=pe({imports:[se.forChild(si),se]})}}return n})();var vr=(()=>{class n{static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275mod=ge({type:n})}static{this.\u0275inj=pe({imports:[He,xt,Qe,Ze,se,le,he]})}}return n})();export{vr as AdminModule};
