import{a as de,b as P,c as qe,d as A,e as L,f as O,g as j,h as z,i as je}from"./chunk-CHVJI36O.js";import{$ as Pe,A as Se,Aa as J,Ba as Te,Ca as Q,Da as X,E as n,F as t,Fa as ee,G as u,Ga as te,H as V,Ha as ne,I as q,Ia as ie,J as k,Ja as oe,K as h,Ka as re,L as p,La as ae,Ma as Fe,Oa as le,Pa as Ne,Qa as Ve,R as i,Ra as De,S as x,T as I,Ta as Ae,U as ye,V as Ee,W as ke,a as F,aa as Me,b as w,c as ve,d as he,ea as D,fa as Y,g as W,ha as we,i as Ce,j as N,k as K,n as C,o as b,oa as Ie,qa as Oe,r as be,u as l,ua as G,v as M,wa as Z,x as m,xa as H,y as d,ya as g,z as $,za as R}from"./chunk-GVS732PN.js";import{a as me,b as xe}from"./chunk-EMNZ2YI5.js";function Ke(r,s){r&1&&(n(0,"h5",40),i(1,"Create Student"),t())}function Ye(r,s){if(r&1&&(n(0,"h5",40),i(1),t()),r&2){let e,o=p(2);l(),I("Update Student - ",(e=o.studentForm.get("id"))==null?null:e.value,"")}}function Ze(r,s){if(r&1){let e=k();n(0,"button",41),h("click",function(){C(e);let a=p(2);return b(a.certifyStudent())}),i(1,"Verified and Certify"),t()}}function He(r,s){r&1&&(n(0,"div",42),i(1," Name is required. "),t())}function Je(r,s){r&1&&(n(0,"div",42),i(1," Valid age is required. "),t())}function Qe(r,s){r&1&&(n(0,"div",42),i(1," Gender is required. "),t())}function Xe(r,s){r&1&&(n(0,"div",42),i(1,'"> Valid email is required. '),t())}function et(r,s){r&1&&(n(0,"div",42),i(1,'"> Phone is required. '),t())}function tt(r,s){r&1&&(n(0,"div",42),i(1,'"> Street is required. '),t())}function nt(r,s){r&1&&(n(0,"div",42),i(1,'"> City is required. '),t())}function it(r,s){r&1&&(n(0,"div",42),i(1,'"> State is required. '),t())}function ot(r,s){r&1&&(n(0,"div",42),i(1,'"> Valid zip is required. '),t())}function rt(r,s){r&1&&(n(0,"div",42),i(1,'"> Country is required. '),t())}function at(r,s){if(r&1){let e=k();n(0,"div",59)(1,"h6",60),i(2),t(),n(3,"button",61),h("click",function(){C(e);let a=p().index,c=p(2);return b(c.courses.removeAt(a))}),i(4," - Remove Course"),t()()}if(r&2){let e=p().index;l(2),I("Course ",e+1,"")}}function lt(r,s){r&1&&(n(0,"div",42),i(1," Custom Course Name is required. "),t())}function dt(r,s){if(r&1&&(n(0,"div",13)(1,"label"),i(2,"Custom Course Name"),t(),u(3,"input",62),m(4,lt,2,0,"div",15),t()),r&2){let e,o=p().$implicit;l(4),d("ngIf",((e=o.get("customName"))==null?null:e.invalid)&&((e=o.get("customName"))==null?null:e.touched))}}function ct(r,s){if(r&1&&(n(0,"option",63),i(1),t()),r&2){let e=s.$implicit;d("value",e.title),l(),x(e.title)}}function st(r,s){r&1&&(n(0,"div",42),i(1," Course name is required. "),t())}function mt(r,s){r&1&&(n(0,"div",42),i(1," Duration is required. "),t())}function ut(r,s){r&1&&(n(0,"div",42),i(1," Technology is required. "),t())}function pt(r,s){r&1&&(n(0,"div",42),i(1," Monthly Price is required. "),t())}function gt(r,s){r&1&&(n(0,"div",42),i(1," Enrollment Date is required. "),t())}function ft(r,s){r&1&&(n(0,"div",42),i(1," Completion Date cannot be before Enrollment Date. "),t())}function _t(r,s){r&1&&(n(0,"div",42),i(1," instructor name is required. "),t())}function xt(r,s){r&1&&(n(0,"div",42),i(1," Course current status is required. "),t())}function vt(r,s){if(r&1&&(n(0,"option",63),i(1),t()),r&2){let e=s.$implicit;d("value",e),l(),I("",e," ")}}function ht(r,s){r&1&&(n(0,"div",42),i(1," Certification type is required. "),t())}function Ct(r,s){if(r&1&&(n(0,"div",43),m(1,at,5,1,"div",44),n(2,"div",45)(3,"div",13)(4,"label"),i(5,"Batch name"),t(),u(6,"input",46),t(),m(7,dt,5,1,"div",47),t(),n(8,"div",48)(9,"div",13)(10,"label"),i(11,"Course Name*"),t(),n(12,"select",14),m(13,ct,2,2,"option",49),t(),m(14,st,2,0,"div",15),t(),n(15,"div",13)(16,"label"),i(17,"Default Duration*"),t(),u(18,"input",50),m(19,mt,2,0,"div",15),t(),n(20,"div",13)(21,"label"),i(22,"Technology*"),t(),u(23,"input",51),m(24,ut,2,0,"div",15),t(),n(25,"div",13)(26,"label"),i(27,"Monthly Price*"),t(),u(28,"input",52),m(29,pt,2,0,"div",15),t()(),n(30,"div",48)(31,"div",13)(32,"label"),i(33,"Enrollment Date*"),t(),u(34,"input",53),m(35,gt,2,0,"div",15),t(),n(36,"div",13)(37,"label"),i(38,"Completion Date"),t(),u(39,"input",54),m(40,ft,2,0,"div",15),t(),n(41,"div",13)(42,"label"),i(43,"Instructor*"),t(),u(44,"input",55),m(45,_t,2,0,"div",15),t(),n(46,"div",13)(47,"label"),i(48,"Status*"),t(),u(49,"input",56),m(50,xt,2,0,"div",15),t()(),n(51,"div",57)(52,"div",48)(53,"div",13)(54,"label"),i(55,"Certification Type"),t(),n(56,"select",58),m(57,vt,2,2,"option",49),t(),m(58,ht,2,0,"div",15),t(),n(59,"div",13)(60,"label"),i(61,"Certification Status*"),t(),u(62,"input",56),t(),n(63,"div",13)(64,"label"),i(65,"Certification Date"),t(),u(66,"input",56),t(),n(67,"div",13)(68,"label"),i(69,"Certificate ID"),t(),u(70,"input",56),t()()()()),r&2){let e,o,a,c,v,S,y,_,B,T,f,ge,fe,_e,E=s.$implicit,Ue=s.index,se=p(2);d("formGroupName",Ue),l(),d("ngIf",!se.isEditMode),l(6),d("ngIf",((e=E.get("name"))==null?null:e.value)==="CUSTOM"),l(6),d("ngForOf",se.courseList),l(),d("ngIf",((o=E.get("name"))==null?null:o.invalid)&&((o=E.get("name"))==null?null:o.touched)),l(5),d("ngIf",((a=E.get("defaultDuration"))==null?null:a.invalid)&&((a=E.get("defaultDuration"))==null?null:a.touched)),l(5),d("ngIf",((c=E.get("technology"))==null?null:c.invalid)&&((c=E.get("technology"))==null?null:c.touched)),l(5),d("ngIf",((v=E.get("price"))==null?null:v.invalid)&&((v=E.get("price"))==null?null:v.touched)),l(6),d("ngIf",((S=E.get("enrollmentDate"))==null?null:S.invalid)&&((S=E.get("enrollmentDate"))==null?null:S.touched)),l(5),d("ngIf",((y=E.get("completionDate"))==null||y.errors==null?null:y.errors.completionBeforeEnrollment)&&((y=E.get("completionDate"))==null?null:y.touched)),l(5),d("ngIf",((_=E.get("instructor"))==null?null:_.invalid)&&((_=E.get("instructor"))==null?null:_.touched)),l(4),d("value",(B=E.get("status"))==null?null:B.value),l(),d("ngIf",((T=E.get("status"))==null?null:T.invalid)&&((T=E.get("status"))==null?null:T.touched)),l(7),d("ngForOf",se.certificationTypeList),l(),d("ngIf",(f=E.get("certification.certificationType"))==null?null:f.invalid),l(4),d("value",(ge=E.get("certification.certificationStatus"))==null?null:ge.value),l(4),d("value",(fe=E.get("certification.certificationDate"))==null?null:fe.value),l(4),d("value",(_e=E.get("certification.certificateId"))==null?null:_e.value)}}function bt(r,s){if(r&1){let e=k();n(0,"button",64),h("click",function(){C(e);let a=p(2);return b(a.addCourse())}),i(1,"+ Add Course"),t()}}function St(r,s){if(r&1){let e=k();n(0,"button",41),h("click",function(){C(e);let a=p(3);return b(a.onSubmit())}),i(1,"Create"),t()}}function yt(r,s){if(r&1){let e=k();n(0,"button",41),h("click",function(){C(e);let a=p(3);return b(a.updateStudent())}),i(1,"Update Student"),t()}}function Et(r,s){if(r&1&&(V(0),m(1,St,2,0,"button",7)(2,yt,2,0,"button",7),q()),r&2){let e=p(2);l(),d("ngIf",!e.isEditMode),l(),d("ngIf",e.isEditMode)}}function kt(r,s){if(r&1){let e=k();n(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),m(5,Ke,2,0,"h5",6)(6,Ye,2,1,"h5",6)(7,Ze,2,0,"button",7),t(),n(8,"button",8),h("click",function(){C(e);let a=p();return b(a.closeModal())}),n(9,"span",9),i(10,"\xD7"),t()()(),n(11,"form",10)(12,"div",11)(13,"div",12)(14,"div",13)(15,"label"),i(16,"Full Name*"),t(),u(17,"input",14),m(18,He,2,0,"div",15),t(),n(19,"div",13)(20,"label"),i(21,"Age*"),t(),u(22,"input",16),m(23,Je,2,0,"div",15),t(),n(24,"div",13)(25,"label"),i(26,"Gender*"),t(),n(27,"select",17)(28,"option",18),i(29,"Select"),t(),n(30,"option",19),i(31,"Male"),t(),n(32,"option",20),i(33,"Female"),t(),n(34,"option",21),i(35,"Other"),t()(),m(36,Qe,2,0,"div",15),t()(),n(37,"div",22)(38,"div",12)(39,"div",13)(40,"label"),i(41,"Email*"),t(),u(42,"input",23),m(43,Xe,2,0,"div",15),t(),n(44,"div",13)(45,"label"),i(46,"Phone*"),t(),u(47,"input",24),m(48,et,2,0,"div",15),t(),n(49,"div",13)(50,"label"),i(51,"Alternate Phone"),t(),u(52,"input",25),t()()(),n(53,"div",26)(54,"div",27)(55,"div",13)(56,"label"),i(57,"Street*"),t(),u(58,"input",28),m(59,tt,2,0,"div",15),t(),n(60,"div",13)(61,"label"),i(62,"City*"),t(),u(63,"input",29),m(64,nt,2,0,"div",15),t(),n(65,"div",13)(66,"label"),i(67,"State*"),t(),u(68,"input",30),m(69,it,2,0,"div",15),t(),n(70,"div",13)(71,"label"),i(72,"Zip*"),t(),u(73,"input",31),m(74,ot,2,0,"div",15),t(),n(75,"div",13)(76,"label"),i(77,"Country*"),t(),u(78,"input",32),m(79,rt,2,0,"div",15),t()()(),n(80,"div",33),m(81,Ct,71,18,"div",34)(82,bt,2,0,"button",35),t()(),u(83,"app-loader",36),n(84,"div",37),m(85,Et,3,2,"ng-container",38),n(86,"button",39),h("click",function(){C(e);let a=p();return b(a.closeModal())}),i(87,"Cancel"),t()()()()()()}if(r&2){let e,o,a,c,v,S,y,_,B,T,f=p();l(5),d("ngIf",!f.isEditMode),l(),d("ngIf",f.isEditMode),l(),d("ngIf",f.isReadyToCertify),l(4),d("formGroup",f.studentForm),l(),$("hidden",f.creatingStudent),l(6),d("ngIf",((e=f.studentForm.get("name"))==null?null:e.invalid)&&((e=f.studentForm.get("name"))==null?null:e.touched)),l(5),d("ngIf",((o=f.studentForm.get("age"))==null?null:o.invalid)&&((o=f.studentForm.get("age"))==null?null:o.touched)),l(13),d("ngIf",((a=f.studentForm.get("gender"))==null?null:a.invalid)&&((a=f.studentForm.get("gender"))==null?null:a.touched)),l(7),d("ngIf",((c=f.studentForm.get("contact.email"))==null?null:c.invalid)&&((c=f.studentForm.get("contact.email"))==null?null:c.touched)),l(5),d("ngIf",((v=f.studentForm.get("contact.phone"))==null?null:v.invalid)&&((v=f.studentForm.get("contact.phone"))==null?null:v.touched)),l(11),d("ngIf",((S=f.studentForm.get("address.street"))==null?null:S.invalid)&&((S=f.studentForm.get("address.street"))==null?null:S.touched)),l(5),d("ngIf",((y=f.studentForm.get("address.city"))==null?null:y.invalid)&&((y=f.studentForm.get("address.city"))==null?null:y.touched)),l(5),d("ngIf",((_=f.studentForm.get("address.state"))==null?null:_.invalid)&&((_=f.studentForm.get("address.state"))==null?null:_.touched)),l(5),d("ngIf",((B=f.studentForm.get("address.zip"))==null?null:B.invalid)&&((B=f.studentForm.get("address.zip"))==null?null:B.touched)),l(5),d("ngIf",((T=f.studentForm.get("address.country"))==null?null:T.invalid)&&((T=f.studentForm.get("address.country"))==null?null:T.touched)),l(),$("pointer-events-none",f.isCertified),l(),d("ngForOf",f.courses.controls),l(),d("ngIf",!f.isEditMode),l(),d("loading",f.creatingStudent),l(),$("disabled",f.creatingStudent),l(),d("ngIf",!f.isCertified)}}var Le=(()=>{class r{set SelectedStudent(e){if(e){this.courses.clear(),this.studentForm.reset(),this.isOpen=!0,this.isEditMode=!!e.id;let o=me({},e);o.course=o.course?[o.course]:[],this.studentForm.patchValue(o),this.addCourse(o.course[0]),this.studentForm.updateValueAndValidity()}}constructor(e,o){this.fb=e,this.firebaseService=o,this.isOpen=!1,this.onClose=new be,this.isEditMode=!1,this.courseList=[],this.courseStatusList=Object.values(A),this.certificationStatusList=Object.values(L),this.certificationTypeList=Object.values(qe),this.creatingStudent=!1,this.subscriptions=new F,this.studentForm=this.fb.group({id:[null],name:["",g.required],age:[null,[g.required,g.min(1)]],gender:["",g.required],contact:this.fb.group({email:["",[g.required,g.email]],phone:["",g.required],alternatePhone:[""]}),address:this.fb.group({street:["",g.required],city:["",g.required],state:["",g.required],zip:[null,[g.required,g.pattern("^[0-9]{6}$")]],country:["",g.required]}),course:this.fb.array([])})}ngOnInit(){this.loadAllCourses()}get courses(){return this.studentForm.get("course")}addCourse(e){let o=this.fb.group({batchName:[e?.batchName||null],name:[e?.name||"",g.required],customName:[e?.customName||""],defaultDuration:[e?.defaultDuration||null,g.required],enrollmentDate:[e?.enrollmentDate||null,g.required],completionDate:[e?.completionDate||null,this.completionAfterEnrollmentValidator],technology:[e?.technology||[],g.required],price:[e?.price||null,g.required],instructor:[e?.instructor||"",g.required],status:[e?.status||A.notStarted,g.required],certification:this.fb.group({certificationType:[e?.certification?.certificationType||""],certificationStatus:[e?.certification?.certificationStatus||L.notApplicable,g.required],certificationDate:[e?.certification?.certificationDate||""],certificateId:[e?.certification?.certificateId||""]})});this.nameValueChanges(o),this.completionDateValueChanges(o),this.batchNameValueChanges(o),e&&(e.name?.toLowerCase()==="custom"?o.get("customName")?.addValidators(g.required):(o.get("customName")?.removeValidators(g.required),o.get("customName")?.setErrors(null)),o.updateValueAndValidity()),this.courses.push(o)}nameValueChanges(e){let o=e.controls.name.valueChanges.subscribe(a=>{let c=this.courseList.find(v=>v.title===a);c&&(e.patchValue({defaultDuration:c.durationInMonth,price:c.discountPrice,technology:c.allTechItems||[]}),c.title.toLowerCase()==="custom"?e.get("customName")?.addValidators(g.required):(e.get("customName")?.removeValidators(g.required),e.get("customName")?.setErrors(null)),e.updateValueAndValidity())});this.subscriptions.add(o)}completionDateValueChanges(e){let o=e.controls.completionDate.valueChanges.subscribe(a=>{a&&(e.patchValue({certification:{certificationStatus:L.pending},status:A.completed}),e.get("certification.certificationType")?.setValidators([g.required]),e.get("certification.certificationType")?.updateValueAndValidity(),e.get("certification.certificationType")?.markAllAsTouched())});this.subscriptions.add(o)}batchNameValueChanges(e){let o=e.controls.batchName.valueChanges.subscribe(()=>{e.controls.status.value===A.notStarted&&(e.patchValue({status:A.inProgress}),e.updateValueAndValidity())});this.subscriptions.add(o)}closeModal(){this.isOpen=!1,this.isEditMode=!1,this.courses.clear(),this.studentForm.reset(),window.history.replaceState({},document.title,window.location.pathname),this.onClose.emit()}onSubmit(){if(this.studentForm.valid){this.creatingStudent=!0;let e=[];this.getFlatStudents().forEach(a=>{e.push(this.firebaseService.saveNewData(P.students,a,a.id))});let o=w(Promise.all(e)).subscribe({next:()=>{this.closeModal(),this.creatingStudent=!1,window.alert("Student created successfully!")},error:a=>{console.error("Error creating student:",a),this.creatingStudent=!1,window.alert("Failed to create student. Please try again.")}});this.subscriptions.add(o)}else this.studentForm.markAllAsTouched(),console.error("Form is invalid")}getFlatStudents(){let e=[],o=0;return this.studentForm.value.course.forEach(a=>{++o;let c=xe(me({},this.studentForm.value),{course:a});c.id=this.createId()+o,e.push(c)}),e}updateStudent(){let e=this.studentForm.value;e.course=e.course[0];let o=e.id;if(this.studentForm.valid&&o){this.creatingStudent=!0;let a=w(this.firebaseService.updateData(P.students,o,e)).subscribe({next:()=>{this.closeModal(),this.creatingStudent=!1,window.alert("Student updated successfully!")},error:c=>{console.error("Error updating student:",c),this.creatingStudent=!1,window.alert("Failed to update student. Please try again.")}});this.subscriptions.add(a)}else this.studentForm.markAllAsTouched(),console.error("Form is invalid or student ID is missing")}certifyStudent(){let e=this.studentForm.value;if(!e.id||e.course[0].status!==A.completed){window.alert("Student is not eligible for certification.");return}this.subscriptions.add(this.firebaseService.getAllFromCollection(P.reviews).subscribe(o=>{if(o.findIndex(a=>a.studentId===e.id)===-1){window.alert("Student review not submitted. Certification cannot be processed.");return}this.studentForm.get("course")?.at(0)?.get("certification")?.patchValue({certificationStatus:L.certified,certificationDate:new Date().toDateString(),certificateId:e.id}),this.studentForm.updateValueAndValidity(),this.updateStudent(),this.generateCertificate()}))}generateCertificate(){let e=this.studentForm.value,o={id:e.id??"",issuedTo:e.name,courseTitle:e.course.name==="CUSTOM"?e.course.name:e.course.customName,technologiesCovered:e.course.technology,duration:`${e.course.defaultDuration} months`,completionDate:e.course.certification?.certificationDate,certifiedBy:e.course.instructor??"",modeOfLearning:"Online",certificationType:e.course.certification?.certificationType,IssuedUnder:"Code Craft Learning"};this.subscriptions.add(w(this.firebaseService.saveNewData(P.certificates,o,e.id)).subscribe({next:()=>{console.log("Certificate generated successfully:",o),window.alert("Certificate generated successfully!")},error:a=>{console.error("Error generating certificate:",a),window.alert("Failed to generate certificate. Please try again.")}}))}loadAllCourses(){let e={description:"Custom Course",title:"CUSTOM",index:0,regularPrice:0,discountPrice:0,durationInMonth:0,technologies:[],allTechItems:[]},o=this.firebaseService.getAllFromCollection(P.coursePackages).subscribe(a=>{this.courseList=[e,...a]});this.subscriptions.add(o)}createId(){let o=this.studentForm.value.name.substring(0,2).toLowerCase(),a=Math.random().toString(36).substring(2,6);return o+a}ngOnDestroy(){this.subscriptions.unsubscribe()}get isReadyToCertify(){if(this.isEditMode){let e=this.studentForm.get("course")?.value[0];if(e.status===A.completed&&e.completionDate)return e.certification.certificationStatus===L.pending}return!1}get isCertified(){return this.studentForm.get("course")?.value[0]?.certification?.certificationStatus===L.certified}completionAfterEnrollmentValidator(e){let o=e.parent;if(!o)return null;let a=o.get("enrollmentDate")?.value,c=e.value;return a&&c&&new Date(c)<=new Date(a)?{completionBeforeEnrollment:!0}:null}static{this.\u0275fac=function(o){return new(o||r)(M(le),M(j))}}static{this.\u0275cmp=N({type:r,selectors:[["app-create-student-modal"]],inputs:{isOpen:"isOpen",SelectedStudent:"SelectedStudent"},outputs:{onClose:"onClose"},decls:1,vars:1,consts:[["class","modal","tabindex","-1","role","dialog",4,"ngIf"],["tabindex","-1","role","dialog",1,"modal"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"flex","flex-row","gap-2","items-center"],["class","modal-title",4,"ngIf"],["class","button-accent-sm",3,"click",4,"ngIf"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[3,"formGroup"],[1,"modal-body"],[1,"grid","grid-cols-3","gap-8"],[1,"form-group"],["formControlName","name",1,"form-control"],["class","text-red-500",4,"ngIf"],["type","number","formControlName","age",1,"form-control"],["formControlName","gender",1,"form-control"],["value",""],["value","Male"],["value","Female"],["value","Other"],["formGroupName","contact"],["formControlName","email",1,"form-control"],["formControlName","phone",1,"form-control"],["formControlName","alternatePhone",1,"form-control"],["formGroupName","address"],[1,"grid","grid-cols-5","gap-8"],["formControlName","street",1,"form-control"],["formControlName","city",1,"form-control"],["formControlName","state",1,"form-control"],["formControlName","zip",1,"form-control"],["formControlName","country",1,"form-control"],["formArrayName","course"],["class","border p-2 mb-2",3,"formGroupName",4,"ngFor","ngForOf"],["type","button","class","button-primary-sm",3,"click",4,"ngIf"],[3,"loading"],[1,"modal-footer"],[4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"modal-title"],[1,"button-accent-sm",3,"click"],[1,"text-red-500"],[1,"border","p-2","mb-2",3,"formGroupName"],["class","flex flex-row gap-4 align-middle",4,"ngIf"],[1,"grid","grid-cols-2","gap-8"],["formControlName","batchName",1,"form-control"],["class","form-group",4,"ngIf"],[1,"grid","grid-cols-4","gap-8"],[3,"value",4,"ngFor","ngForOf"],["formControlName","defaultDuration",1,"form-control"],["formControlName","technology",1,"form-control"],["type","number","formControlName","price",1,"form-control"],["type","date","formControlName","enrollmentDate",1,"form-control"],["type","date","formControlName","completionDate",1,"form-control"],["formControlName","instructor",1,"form-control"],["readonly","",1,"bg-slate-300","form-control",3,"value"],["formGroupName","certification"],["formControlName","certificationType",1,"form-control"],[1,"flex","flex-row","gap-4","align-middle"],[1,"mb-2","text-text","underline","underline-offset-2"],["type","button",1,"mt-2","bg-red-300","px-4","rounded-lg",3,"click"],["formControlName","customName",1,"form-control"],[3,"value"],["type","button",1,"button-primary-sm",3,"click"]],template:function(o,a){o&1&&m(0,kt,88,24,"div",0),o&2&&d("ngIf",a.isOpen)},dependencies:[D,Y,Q,re,ae,H,X,oe,R,J,ee,ie,te,ne,z],styles:[".modal[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:#00000080;position:fixed;inset:0;height:100vh;width:100vw;z-index:1050}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:8px;width:70%;height:90%;overflow-y:auto;margin:2rem auto;box-shadow:0 4px 24px #0003}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{border:none;border-radius:8px;overflow:hidden}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.5rem;border-bottom:1px solid #e9ecef;background:#f8f9fa}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{background:transparent;border:none;font-size:1.5rem;cursor:pointer;color:#333;transition:color .2s}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover{color:#d9534f}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid #ced4da;border-radius:4px;font-size:1rem;transition:border-color .2s}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#d9534f;font-size:.875rem;margin-top:.25rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:1rem 1.5rem;border-top:1px solid #e9ecef;background:#f8f9fa}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px;margin-left:.5rem}"]})}}return r})();function wt(r,s){if(r&1){let e=k();V(0),n(1,"tr",12)(2,"td",13),i(3),t(),n(4,"td",13),i(5),t(),n(6,"td",13),i(7),t(),n(8,"td",13),i(9),t(),n(10,"td",13),i(11),t(),n(12,"td",13),i(13),t(),n(14,"td",13),i(15),t(),n(16,"td",13),i(17),t(),n(18,"td",13),i(19),t(),n(20,"td",13),i(21),t(),n(22,"td",14)(23,"a",15),h("click",function(){let a=C(e).$implicit,c=p();return b(c.openStudent(a))}),i(24,"View"),t()()(),q()}if(r&2){let e=s.$implicit;l(3),x(e.id),l(2),x(e.name),l(2),x(e.age),l(2),x(e.gender),l(2),x(e.contact.email),l(2),x(e.contact.phone),l(2),x(e.course.name),l(2),x(e.course.batchName),l(2),x(e.course.status),l(2),x(e.course.certification==null?null:e.course.certification.certificationStatus)}}var $e=(()=>{class r{constructor(e,o){this.firebasseService=e,this.activatedRoute=o,this.createStudentModal=!1,this.allStudents=[],this.subscriptions=new F,this.courses=[]}ngOnInit(){this.loadAllCourses(),this.loadAllStudents(),this.loadParams()}loadAllCourses(){this.subscriptions.add(this.firebasseService.getAllFromCollection(P.coursePackages,"title").subscribe(e=>{this.courses=e}))}loadParams(){this.subscriptions.add(this.activatedRoute.queryParams.subscribe(e=>{e.enquiryId&&this.firebasseService.getFromCollectionById(P.enquiries,e.enquiryId).subscribe(o=>{this.openStudent(this.loadStudentWithEnquiry(o))})}))}loadStudentWithEnquiry(e){let o={name:e.fullName,age:e.age,contact:{email:e.email,phone:e.contactNumber}};(e.packageName===void 0||e.packageName===null)&&(o.course={name:"CUSTOM",technology:e.technologies});let a=this.courses.find(c=>c.title===e.packageName);return a&&(o.course={name:a.title,defaultDuration:a.durationInMonth,technology:a.allTechItems,price:a.discountPrice}),o}openStudent(e){this.selectedStudent=e,this.createStudentModal=!0}closeStudentModal(){this.createStudentModal=!1,this.selectedStudent=void 0}loadAllStudents(){this.subscriptions.add(this.firebasseService.getAllFromCollection(P.students,"id").subscribe(e=>{this.allStudents=e}))}ngOnDestroy(){this.subscriptions.unsubscribe()}static{this.\u0275fac=function(o){return new(o||r)(M(j),M(Ie))}}static{this.\u0275cmp=N({type:r,selectors:[["app-students"]],decls:35,vars:3,consts:[[1,"flex","flex-col","gap-6","absolute","left-0","px-10","w-full"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","p-4","text-left","rounded-lg"],[1,"flex","flex-row","gap-6","align-middle","h-10"],[1,"button-primary-sm",3,"click"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],[3,"onClose","isOpen","SelectedStudent"],[1,"bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text"],[1,"px-6","py-4"],[1,"px-6","py-4","text-center"],[1,"text-blue","underline","underline-offset-2","cursor-pointer",3,"click"]],template:function(o,a){o&1&&(n(0,"div",0)(1,"div",1)(2,"table",2)(3,"caption",3)(4,"div",4)(5,"span"),i(6,"Student List"),t(),n(7,"button",5),h("click",function(){return a.createStudentModal=!0}),i(8,"+ Create Student"),t()()(),n(9,"thead",6)(10,"tr",7)(11,"th",8),i(12,"Id"),t(),n(13,"th",8),i(14,"Name"),t(),n(15,"th",8),i(16,"Age"),t(),n(17,"th",8),i(18,"Gender"),t(),n(19,"th",8),i(20,"Email"),t(),n(21,"th",8),i(22,"Phone"),t(),n(23,"th",8),i(24,"Course Name"),t(),n(25,"th",8),i(26,"Batch Name"),t(),n(27,"th",8),i(28,"Course Status"),t(),n(29,"th",8),i(30,"Certification Status"),t(),u(31,"th",8),t()(),n(32,"tbody",9),m(33,wt,25,10,"ng-container",10),t()()()(),n(34,"app-create-student-modal",11),h("onClose",function(){return a.closeStudentModal()}),t()),o&2&&(l(33),d("ngForOf",a.allStudents),l(),d("isOpen",a.createStudentModal)("SelectedStudent",a.selectedStudent))},dependencies:[D,Le]})}}return r})();var ce=(r,s)=>{let e=Ce(De);return Ae(e).pipe(he(1),ve(o=>o?!0:(window.alert("You must be logged in to access this page"),!1)))};function It(r,s){if(r&1){let e=k();n(0,"label",15)(1,"input",16),ke("ngModelChange",function(a){let c=C(e).$implicit,v=p();return Ee(v.selectedStatuses[c],a)||(v.selectedStatuses[c]=a),b(a)}),t(),n(2,"span"),i(3),t()()}if(r&2){let e=s.$implicit,o=p();l(),d("value",e),ye("ngModel",o.selectedStatuses[e]),l(2),x(e)}}function Ot(r,s){if(r&1){let e=k();V(0),n(1,"tr",17)(2,"td",18),i(3),t(),n(4,"td",18),i(5),t(),n(6,"td",18),i(7),t(),n(8,"td",18),i(9),t(),n(10,"td",18),i(11),t(),n(12,"td",18),i(13),Pe(14,"timestampPipe"),t(),n(15,"td",18),i(16),t(),n(17,"td",18),i(18),t(),n(19,"td",18),i(20),t(),n(21,"td",18),i(22),t(),n(23,"td",19)(24,"a",20),h("click",function(){let a=C(e).$implicit,c=p();return b(c.viewEnquiry(a))}),i(25,"View"),t(),n(26,"a",21),h("click",function(){let a=C(e).$implicit,c=p();return b(c.confirmEnquiry(a))}),i(27,"Confirm"),t(),n(28,"a",22),h("click",function(){let a=C(e).$implicit,c=p();return b(c.cancelEnquiry(a))}),i(29,"Cancel"),t()()(),q()}if(r&2){let e=s.$implicit;l(),Se(e.status),l(2),x(e.id),l(2),x(e.fullName),l(2),x(e.age),l(2),x(e.email),l(2),x(e.contactNumber),l(2),x(Me(14,12,e.createdDate)),l(3),x(e.packageName),l(2),x(e.technologies.join(", ")),l(2),x(e.status),l(2),x(e.notes)}}var Re=(()=>{class r{constructor(e,o){this.firebaseService=e,this.router=o,this.loading=!1,this.enquiries=[],this.enquiryStatus=Object.values(O),this.selectedStatuses={[O.pending]:!0,[O.confirmed]:!0,[O.cancelled]:!0,[O.contacted]:!0},this.subscription=new F}ngOnInit(){this.getEnquiries()}get filteredEnquiries(){return this.enquiries.filter(e=>this.selectedStatuses[e.status||O.pending])}removeEnquiry(e){if(!e||!e.id){console.error("Invalid enquiry data:",e);return}if(confirm(`Are you sure you want to delete the enquiry from ${e.fullName}?`)){this.loading=!0;let o=w(this.firebaseService.deleteData(P.enquiries,e.id)).subscribe(()=>{this.enquiries=this.enquiries.filter(a=>a.id!==e.id),this.loading=!1},a=>{console.error("Error deleting enquiry:",a),this.loading=!1});this.subscription.add(o)}}cancelEnquiry(e){let o=window.prompt("Reason for cancellation:");if(!o){window.alert("Cancellation reason is required.");return}e.notes=o,e.status=O.cancelled,this.updateEnquiry(e)}viewEnquiry(e){let o=window.prompt("Message / updates:");if(!o){window.alert("message is required.");return}e.notes=o,e.status=O.contacted,this.updateEnquiry(e)}confirmEnquiry(e){window.confirm(`Are you sure you want to confirm the enquiry from ${e.fullName}?`)&&(e.status=O.confirmed,this.updateEnquiry(e),this.router.navigate(["/admin/students"],{queryParams:{enquiryId:e.id}}))}updateEnquiry(e){if(!e||!e.id){console.error("Invalid enquiry data:",e);return}this.loading=!0;let o=w(this.firebaseService.updateData(P.enquiries,e.id,e)).subscribe(()=>{let a=this.enquiries.findIndex(c=>c.id===e.id);a!==-1&&(this.enquiries[a]=e),this.loading=!1},a=>{console.error("Error updating enquiry:",a),this.loading=!1});this.subscription.add(o)}getEnquiries(){this.loading=!0;let e=this.firebaseService.getAllFromCollection(P.enquiries,"id").subscribe(o=>{this.enquiries=o,this.loading=!1},o=>{console.error("Error fetching enquiries:",o),this.loading=!1});this.subscription.add(e)}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(o){return new(o||r)(M(j),M(Oe))}}static{this.\u0275cmp=N({type:r,selectors:[["app-enquiry"]],decls:38,vars:3,consts:[[1,"flex","flex-col","gap-6","absolute","left-0","px-10","w-full"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","p-4","text-left","rounded-lg"],[1,"flex","flex-row","justify-between"],[1,"flex","flex-row","gap-6","align-middle","h-10","items-center"],[1,"text-gray-500","text-sm"],[1,"flex","flex-row","gap-6"],[1,"flex","flex-row","gap-4","items-center"],["class","flex flex-row items-center gap-1",4,"ngFor","ngForOf"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],[1,"flex","flex-row","items-center","gap-1"],["type","checkbox",1,"accent-primary",3,"ngModelChange","value","ngModel"],[1,"bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text","status"],[1,"px-6","py-4"],[1,"px-6","py-4","text-center","flex","flex-row","gap-2"],[1,"text-","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"text-black","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"text-red-500","underline","underline-offset-2","cursor-pointer",3,"click"]],template:function(o,a){o&1&&(n(0,"div",0)(1,"div",1)(2,"table",2)(3,"caption",3)(4,"div",4)(5,"div",5)(6,"span"),i(7,"Enquiry List"),t(),n(8,"span",6),i(9),t()(),n(10,"div",7)(11,"div",8),m(12,It,4,3,"label",9),t()()()(),n(13,"thead",10)(14,"tr",11)(15,"th",12),i(16,"Id"),t(),n(17,"th",12),i(18,"Name"),t(),n(19,"th",12),i(20,"Age"),t(),n(21,"th",12),i(22,"Email"),t(),n(23,"th",12),i(24,"Phone"),t(),n(25,"th",12),i(26,"Date"),t(),n(27,"th",12),i(28,"Package Name"),t(),n(29,"th",12),i(30,"Technologies"),t(),n(31,"th",12),i(32,"Status"),t(),n(33,"th",12),i(34,"Notes"),t(),u(35,"th",12),t()(),n(36,"tbody",13),m(37,Ot,30,14,"ng-container",14),t()()()()),o&2&&(l(9),I("Total Enquiries: ",a.enquiries.length,""),l(3),d("ngForOf",a.enquiryStatus),l(25),d("ngForOf",a.filteredEnquiries))},dependencies:[D,Z,R,Te,je],styles:[".status.pending[_ngcontent-%COMP%]{background-color:#ffe082}.status.contacted[_ngcontent-%COMP%]{background-color:#b3e5fc}.status.cancelled[_ngcontent-%COMP%]{background-color:#ffcdd2}.status.confirmed[_ngcontent-%COMP%]{background-color:#c8e6c9}"]})}}return r})();function Tt(r,s){if(r&1){let e=k();V(0),n(1,"tr",16)(2,"td",17),i(3),t(),n(4,"td",17),i(5),t(),n(6,"td",17),i(7),t(),n(8,"td",17),i(9),t(),n(10,"td",17),i(11),t(),n(12,"td",17),i(13),t(),n(14,"td",18)(15,"a",19),h("click",function(){let a=C(e).$implicit,c=p(2);return b(c.viewCourse(a))}),i(16,"View"),t()()(),q()}if(r&2){let e=s.$implicit;l(3),x(e.index),l(2),x(e.title),l(2),x(e.description),l(2),x(e.regularPrice),l(2),x(e.discountPrice),l(2),x(e.durationInMonth)}}function Ft(r,s){if(r&1){let e=k();n(0,"table",5)(1,"caption",6)(2,"div",7)(3,"div",8)(4,"span"),i(5,"Package List"),t(),n(6,"span",9),i(7),t(),n(8,"button",10),h("click",function(){C(e);let a=p();return b(a.createNewPackage())}),i(9,"Create new package"),t()()()(),n(10,"thead",11)(11,"tr",12)(12,"th",13),i(13,"Index"),t(),n(14,"th",13),i(15,"Title"),t(),n(16,"th",13),i(17,"Description"),t(),n(18,"th",13),i(19,"Regular Price"),t(),n(20,"th",13),i(21,"Discounted Price"),t(),n(22,"th",13),i(23,"Duration"),t(),u(24,"th",13),t()(),n(25,"tbody",14),m(26,Tt,17,6,"ng-container",15),t()()}if(r&2){let e=p();l(7),I("Total Packages: ",e.packages.length,""),l(19),d("ngForOf",e.packages)}}function Nt(r,s){r&1&&(n(0,"h3",43),i(1,"Create Package"),t())}function Vt(r,s){r&1&&(n(0,"h3",43),i(1,"Update Package"),t())}function qt(r,s){r&1&&(n(0,"div",44),i(1," Index is required and must be 0 or greater. "),t())}function Dt(r,s){r&1&&(n(0,"div",44),i(1," Title is required. "),t())}function At(r,s){r&1&&(n(0,"div",44),i(1," Regular price is required and must be 0 or greater. "),t())}function jt(r,s){r&1&&(n(0,"div",44),i(1," Discounted price is required and must be 0 or greater. "),t())}function Bt(r,s){r&1&&(n(0,"div",44),i(1," Duration is required and must be at least 1 month. "),t())}function Lt(r,s){r&1&&(n(0,"div",44),i(1," Description is required. "),t())}function $t(r,s){if(r&1&&(n(0,"div",45)(1,"span",46),i(2),t()()),r&2){let e,o=p(2);l(2),I(" ",(e=o.packageForm.get("allTechItems"))==null||e.value==null?null:e.value.join(", ")," ")}}function Rt(r,s){if(r&1&&u(0,"app-dropdown",55),r&2){let e=p(3);d("items",e.availableTechnologies)("multiselect",!0)}}function zt(r,s){if(r&1&&u(0,"app-dropdown",56),r&2){let e=p(3);d("items",e.packages)("multiselect",!0)}}function Gt(r,s){r&1&&(n(0,"select",57)(1,"option",58),i(2,"None"),t(),n(3,"option",59),i(4,"+"),t(),n(5,"option",60),i(6,"/"),t()())}function Ut(r,s){if(r&1){let e=k();n(0,"div",47)(1,"label",48)(2,"input",49),h("ngModelChange",function(){let a=C(e).$implicit,c=p(2);return b(c.resetTechs(a))}),t(),n(3,"span"),i(4,"Is Package"),t()(),m(5,Rt,1,2,"app-dropdown",50)(6,zt,1,2,"app-dropdown",51)(7,Gt,7,0,"select",52),n(8,"button",53),h("click",function(){let a=C(e).index,c=p(2);return b(c.technologies.removeAt(a))}),i(9,"-Remove"),t(),n(10,"span",54),i(11),t()()}if(r&2){let e,o,a,c=s.$implicit,v=s.index,S=p(2);d("formGroupName",v),l(5),d("ngIf",!((e=c.get("isPackage"))!=null&&e.value)),l(),d("ngIf",(o=c.get("isPackage"))==null?null:o.value),l(),d("ngIf",((a=c.get("techs"))==null||a.value==null?null:a.value.length)>1||((a=c.get("packages"))==null||a.value==null?null:a.value.length)>1),l(4),x(S.getTechString(c))}}function Wt(r,s){if(r&1){let e=k();n(0,"button",61),h("click",function(){C(e);let a=p(2);return b(a.deletePackage())}),i(1," Delete Package "),t()}}function Kt(r,s){if(r&1){let e=k();n(0,"div",20)(1,"div",21)(2,"div",22),m(3,Nt,2,0,"h3",23)(4,Vt,2,0,"h3",23),n(5,"button",24),h("click",function(){C(e);let a=p();return b(a.closeCourse())}),i(6," \xD7 "),t()(),u(7,"app-loader",2),n(8,"form",25)(9,"div",26)(10,"div")(11,"label",27),i(12,"Index"),t(),u(13,"input",28),m(14,qt,2,0,"div",29),t(),n(15,"div")(16,"label",27),i(17,"Title"),t(),u(18,"input",30),m(19,Dt,2,0,"div",29),t(),n(20,"div")(21,"label",27),i(22,"Regular Price"),t(),u(23,"input",31),m(24,At,2,0,"div",29),t()(),n(25,"div",26)(26,"div")(27,"label",27),i(28,"Discounted Price"),t(),u(29,"input",32),m(30,jt,2,0,"div",29),t(),n(31,"div")(32,"label",27),i(33,"Duration (Months)"),t(),u(34,"input",33),m(35,Bt,2,0,"div",29),t(),n(36,"div")(37,"label",27),i(38,"Description"),t(),u(39,"input",34),m(40,Lt,2,0,"div",29),t()(),m(41,$t,3,1,"div",35),n(42,"div")(43,"label",27),i(44,"Technologies"),t(),n(45,"div",36),m(46,Ut,12,5,"div",37),n(47,"button",38),h("click",function(){C(e);let a=p();return b(a.addTechnology())}),i(48,"Add Technology"),t()()(),n(49,"div",39)(50,"button",40),h("click",function(){C(e);let a=p();return b(a.onSubmit())}),i(51),t(),m(52,Wt,2,0,"button",41),n(53,"button",42),h("click",function(){C(e);let a=p();return b(a.closeCourse())}),i(54,"Cancel"),t()()()()()}if(r&2){let e,o,a,c,v,S,y,_=p();l(3),d("ngIf",!_.selectedPackage),l(),d("ngIf",_.selectedPackage),l(3),d("loading",_.packageProcessing),l(),$("hidden",_.packageProcessing),d("formGroup",_.packageForm),l(6),d("ngIf",((e=_.packageForm.get("index"))==null?null:e.invalid)&&((e=_.packageForm.get("index"))==null?null:e.touched)),l(5),d("ngIf",((o=_.packageForm.get("title"))==null?null:o.invalid)&&((o=_.packageForm.get("title"))==null?null:o.touched)),l(5),d("ngIf",((a=_.packageForm.get("regularPrice"))==null?null:a.invalid)&&((a=_.packageForm.get("regularPrice"))==null?null:a.touched)),l(6),d("ngIf",((c=_.packageForm.get("discountPrice"))==null?null:c.invalid)&&((c=_.packageForm.get("discountPrice"))==null?null:c.touched)),l(5),d("ngIf",((v=_.packageForm.get("durationInMonth"))==null?null:v.invalid)&&((v=_.packageForm.get("durationInMonth"))==null?null:v.touched)),l(5),d("ngIf",((S=_.packageForm.get("description"))==null?null:S.invalid)&&((S=_.packageForm.get("description"))==null?null:S.touched)),l(),d("ngIf",(y=_.packageForm.get("allTechItems"))==null||y.value==null?null:y.value.length),l(5),d("ngForOf",_.technologies.controls),l(5),I(" ",_.selectedPackage?"Update":"Create"," Package "),l(),d("ngIf",!!_.selectedPackage)}}var ze=(()=>{class r{constructor(e,o){this.firebaseService=e,this.fb=o,this.loading=!0,this.packages=[],this.isOpen=!1,this.subscription=new F,this.availableTechnologies=[],this.packageProcessing=!1,this.packageForm=this.fb.group({index:[null,[g.required,g.min(0)]],title:[null,g.required],description:[null,g.required],regularPrice:[null,[g.required,g.min(0)]],discountPrice:[null,[g.required,g.min(0)]],durationInMonth:[null,[g.required,g.min(1)]],allTechItems:[[]],technologies:this.fb.array([])})}get technologies(){return this.packageForm.get("technologies")}addTechnology(e){this.technologies.push(this.fb.group({techs:[[]],packages:[[]],isPackage:[e?.isPackage||!1],combinationBy:[e?.combinationBy||""]}))}removeTechnology(e){this.technologies.removeAt(e)}ngOnInit(){this.fetchPackages()}createNewPackage(){this.isOpen=!0,this.selectedPackage=void 0,this.packageForm.reset(),this.technologies.clear(),this.packageForm.setControl("technologies",this.fb.array([])),this.packageForm.patchValue({index:this.packages.length+1,title:null,description:null,regularPrice:null,discountPrice:null,durationInMonth:null,allTechItems:[]}),this.packageForm.updateValueAndValidity(),this.addTechnology()}viewCourse(e){this.isOpen=!0,this.selectedPackage=e,this.packageForm.reset(),this.technologies.clear();let o=e.technologies||[];o.forEach(a=>{if(a.isPackage){let c=[];a.name.forEach(v=>{let S=this.packages.find(y=>y.title===v);S&&c.push(S)}),this.technologies.push(this.fb.group({packages:[c],techs:[[]],isPackage:[!0],combinationBy:[a.combinationBy||""]}))}else this.technologies.push(this.fb.group({techs:[a.name],packages:[[]],isPackage:[!1],combinationBy:[a.combinationBy||""]}))}),this.packageForm.patchValue({index:e.index,title:e.title,description:e.description,regularPrice:e.regularPrice,discountPrice:e.discountPrice,durationInMonth:e.durationInMonth,allTechItems:e.allTechItems||[],technologies:o}),this.packageForm.updateValueAndValidity()}closeCourse(){this.selectedPackage=void 0,this.technologies.clear(),this.isOpen=!1}getTechString(e){return e.get("isPackage")?.value?`${e.get("packages")?.value?.map(o=>o.title)?.join(" "+e.get("combinationBy")?.value+" ")}`:`${e.get("techs")?.value?.join(" "+e.get("combinationBy")?.value+" ")}`}resetTechs(e){e.get("packages")?.setValue([]),e.get("techs")?.setValue([]),e.updateValueAndValidity()}deletePackage(){if(!this.selectedPackage)return;let e=this.selectedPackage.id;e&&confirm("Are you sure you want to delete this package?")&&(this.packageProcessing=!0,this.subscription.add(w(this.firebaseService.deleteData(P.coursePackages,e)).subscribe({next:()=>{window.alert("Package deleted successfully"),this.selectedPackage=void 0,this.technologies.clear(),this.packageForm.reset(),this.packageProcessing=!1,this.isOpen=!1,this.fetchPackages()},error:o=>{this.packageProcessing=!1,window.alert("Error deleting package:")}})))}onSubmit(){if(this.packageForm.invalid){this.packageForm.markAllAsTouched();return}this.packageProcessing=!0;let e=this.packageForm.value,o={index:e.index,title:e.title,description:e.description,regularPrice:e.regularPrice,discountPrice:e.discountPrice,durationInMonth:e.durationInMonth,allTechItems:e.allTechItems||[]},a=[],c=new Set;e.technologies.forEach(v=>{if(v.isPackage){let S={name:v.packages.map(y=>y.title),isPackage:!0,combinationBy:v.combinationBy,iconUrl:[]};v.packages.forEach(y=>{y.allTechItems.forEach(_=>{c.add(_)})}),a.push(S)}else{let S={name:v.techs,isPackage:!1,combinationBy:v.combinationBy,iconUrl:[]};v.techs.forEach(y=>{c.add(y)}),a.push(S)}}),o.technologies=a,o.allTechItems=Array.from(c),this.subscription.add(w(this.firebaseService.saveNewData(P.coursePackages,o)).subscribe({next:()=>{window.alert("Package created successfully"),this.fetchPackages(),this.packageProcessing=!1,this.isOpen=!1},error:v=>{window.alert("Error creating package:"),this.packageProcessing=!1}}))}loadAllTechnologies(){let e=new Set;this.packages.forEach(o=>{o.allTechItems.forEach(a=>{e.add(a)})}),this.availableTechnologies=Array.from(e)}fetchPackages(){this.loading=!0,this.subscription.add(this.firebaseService.getAllFromCollection(P.coursePackages).subscribe({next:e=>{console.log(e),this.packages=e.sort((o,a)=>o.index-a.index),this.loading=!1,this.loadAllTechnologies()},error:e=>{console.error("Error fetching packages:",e),this.loading=!1}}))}static{this.\u0275fac=function(o){return new(o||r)(M(j),M(le))}}static{this.\u0275cmp=N({type:r,selectors:[["app-packages"]],decls:5,vars:3,consts:[[1,"flex","flex-col","gap-6","absolute","left-0","px-10","w-full"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg","mb-32"],[3,"loading"],["class","w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400 rounded-lg",4,"ngIf"],["class","fixed inset-0 z-30 flex items-center justify-center bg-black bg-opacity-40 backdrop-blur-sm ",4,"ngIf"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","p-4","text-left","rounded-lg"],[1,"flex","flex-row","justify-between"],[1,"flex","flex-row","gap-6","align-middle","h-10","items-center"],[1,"text-gray-500","text-sm"],[1,"button-primary-sm",3,"click"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],[1,"bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text"],[1,"px-6","py-4"],[1,"px-6","py-4","text-center","flex","flex-row","gap-2"],[1,"text-","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"fixed","inset-0","z-30","flex","items-center","justify-center","bg-black","bg-opacity-40","backdrop-blur-sm"],[1,"relative","z-40","bg-secondary","rounded-lg","shadow-lg","p-6","w-1/2","max-h-[85vh]","overflow-y-auto"],[1,"flex","flex-row","justify-between","w-full","bg-primary","py-3","px-5","text-white","rounded-lg","align-middle"],["class","text-lg font-semibold ",4,"ngIf"],["aria-label","Close",1,"text-3xl","font-semibold","cursor-pointer","hover:text-gray-300","transition-colors",3,"click"],[1,"mt-6","flex","flex-col","gap-6",3,"formGroup"],[1,"grid","grid-cols-3","gap-4"],[1,"block","mb-1","font-medium"],["type","number","formControlName","index","min","0","readonly","",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["class","text-red-500 text-xs",4,"ngIf"],["type","text","formControlName","title",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","number","formControlName","regularPrice","min","0",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","number","formControlName","discountPrice","min","0",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","number","formControlName","durationInMonth","min","1",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["formControlName","description","rows","3",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["class","bg-slate-300 px-4 py-2 border border-1 border-primary rounded-lg w-full",4,"ngIf"],["formArrayName","technologies",1,"flex","flex-col","w-full","gap-4"],["class","flex flex-row gap-4 items-center",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"button-primary-sm","mt-2","w-fit",3,"click"],[1,"flex","justify-end","gap-4","mt-4"],["type","submit",1,"button-primary-sm",3,"click"],["type","submit","class","button-primary-sm bg-red-500",3,"click",4,"ngIf"],["type","button",1,"button-secondary-sm",3,"click"],[1,"text-lg","font-semibold"],[1,"text-red-500","text-xs"],[1,"bg-slate-300","px-4","py-2","border","border-1","border-primary","rounded-lg","w-full"],[1,"text-primary","text-lg","font-outfit"],[1,"flex","flex-row","gap-4","items-center",3,"formGroupName"],[1,"flex","items-center","gap-1"],["type","checkbox","formControlName","isPackage",3,"ngModelChange"],["formControlName","techs",3,"items","multiselect",4,"ngIf"],["formControlName","packages","labelKey","title",3,"items","multiselect",4,"ngIf"],["formControlName","combinationBy","class","px-4 py-2 border border-black rounded-lg",4,"ngIf"],["type","button",1,"text-red-600","font-semibold","text-lg",3,"click"],[1,"text-gray-600"],["formControlName","techs",3,"items","multiselect"],["formControlName","packages","labelKey","title",3,"items","multiselect"],["formControlName","combinationBy",1,"px-4","py-2","border","border-black","rounded-lg"],["value",""],["value","+"],["value","/"],["type","submit",1,"button-primary-sm","bg-red-500",3,"click"]],template:function(o,a){o&1&&(n(0,"div",0)(1,"div",1),u(2,"app-loader",2),m(3,Ft,27,2,"table",3),t()(),m(4,Kt,55,16,"div",4)),o&2&&(l(2),d("loading",a.loading),l(),d("ngIf",!a.loading),l(),d("ngIf",a.isOpen))},dependencies:[D,Y,Q,re,ae,H,X,Z,oe,R,J,Fe,ee,ie,te,ne,z,de]})}}return r})();var Yt=[{path:"students",component:$e,canActivate:[ce]},{path:"enquiries",component:Re,canActivate:[ce]},{path:"packages",component:ze,canActivate:[ce]}],Ge=(()=>{class r{static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275mod=K({type:r})}static{this.\u0275inj=W({imports:[G.forChild(Yt),G]})}}return r})();var Rn=(()=>{class r{static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275mod=K({type:r})}static{this.\u0275inj=W({imports:[we,Ge,Ve,Ne,G,z,de]})}}return r})();export{Rn as AdminModule};
