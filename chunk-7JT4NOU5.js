import{a as de,b as P,c as Le,d as F,e as q,f as O,g as B,h as Q,i as $e}from"./chunk-TZ7XJE5V.js";import{$ as ue,A as Ee,Aa as j,Ba as W,Ca as Ve,Da as z,E as i,Ea as ae,F as t,G as p,Ga as U,H as N,Ha as le,I as V,Ia as ce,J as k,Ja as K,K as v,Ka as Y,L as g,La as Z,Ma as H,Na as qe,Pa as J,Qa as De,R as o,Ra as Ae,S as _,Sa as je,T as M,U as ke,Ua as Be,V as Pe,W as we,a as D,aa as Me,b as I,ba as Ie,c as be,d as Ce,ea as Fe,fa as L,g as ie,ga as oe,i as Se,ia as Oe,j as A,k as ne,n as b,o as C,pa as Te,r as ye,ra as Ne,u as l,v as w,va as X,x as m,xa as re,y as c,ya as R,z as G,za as f}from"./chunk-FPBIDQN7.js";import{a as me,b as ve}from"./chunk-EMNZ2YI5.js";function Ze(r,s){r&1&&(i(0,"h5",40),o(1,"Create Student"),t())}function He(r,s){if(r&1&&(i(0,"h5",40),o(1),t()),r&2){let e,n=g(2);l(),M("Update Student - ",(e=n.studentForm.get("id"))==null?null:e.value,"")}}function Je(r,s){if(r&1){let e=k();i(0,"button",41),v("click",function(){b(e);let a=g(2);return C(a.certifyStudent())}),o(1,"Verified and Certify"),t()}}function Qe(r,s){r&1&&(i(0,"div",42),o(1," Name is required. "),t())}function Xe(r,s){r&1&&(i(0,"div",42),o(1," Valid age is required. "),t())}function et(r,s){r&1&&(i(0,"div",42),o(1," Gender is required. "),t())}function tt(r,s){r&1&&(i(0,"div",42),o(1,'"> Valid email is required. '),t())}function it(r,s){r&1&&(i(0,"div",42),o(1,'"> Phone is required. '),t())}function nt(r,s){r&1&&(i(0,"div",42),o(1,'"> Street is required. '),t())}function ot(r,s){r&1&&(i(0,"div",42),o(1,'"> City is required. '),t())}function rt(r,s){r&1&&(i(0,"div",42),o(1,'"> State is required. '),t())}function at(r,s){r&1&&(i(0,"div",42),o(1,'"> Valid zip is required. '),t())}function lt(r,s){r&1&&(i(0,"div",42),o(1,'"> Country is required. '),t())}function ct(r,s){if(r&1){let e=k();i(0,"div",61)(1,"h6",62),o(2),t(),i(3,"button",63),v("click",function(){b(e);let a=g().index,d=g(2);return C(d.courses.removeAt(a))}),o(4," - Remove Course"),t()()}if(r&2){let e=g().index;l(2),M("Course ",e+1,"")}}function dt(r,s){if(r&1){let e=k();i(0,"a",67),v("click",function(){b(e);let a=g().index,d=g().$implicit,u=g(2);return C(u.removeTechAt(d,a))}),o(1,"x"),t()}}function st(r,s){if(r&1&&(N(0),i(1,"div",64)(2,"span",65),o(3),t(),m(4,dt,2,0,"a",66),t(),V()),r&2){let e=s.$implicit,n=g().$implicit,a=g(2);l(3),_(e),l(),c("ngIf",a.getTechStack(n).length>1)}}function mt(r,s){if(r&1&&(i(0,"option",68),o(1),t()),r&2){let e=s.$implicit;c("value",e.title),l(),_(e.title)}}function ut(r,s){r&1&&(i(0,"div",42),o(1," Course name is required. "),t())}function pt(r,s){r&1&&(i(0,"div",42),o(1," Custom Course Name is required. "),t())}function gt(r,s){r&1&&(i(0,"div",42),o(1," Duration is required. "),t())}function ft(r,s){r&1&&(i(0,"div",42),o(1," Monthly Price is required. "),t())}function _t(r,s){r&1&&(i(0,"div",42),o(1," Enrollment Date is required. "),t())}function xt(r,s){r&1&&(i(0,"div",42),o(1," Completion Date cannot be before Enrollment Date. "),t())}function ht(r,s){r&1&&(i(0,"div",42),o(1," instructor name is required. "),t())}function vt(r,s){r&1&&(i(0,"div",42),o(1," Course current status is required. "),t())}function bt(r,s){if(r&1&&(i(0,"option",68),o(1),t()),r&2){let e=s.$implicit;c("value",e),l(),M("",e," ")}}function Ct(r,s){r&1&&(i(0,"div",42),o(1," Certification type is required. "),t())}function St(r,s){if(r&1&&(i(0,"div",43),m(1,ct,5,1,"div",44),i(2,"div",45)(3,"div",13)(4,"label"),o(5,"Batch name"),t(),p(6,"input",46),t()(),i(7,"div",47)(8,"label"),o(9,"Tech Stack"),t(),i(10,"div",48),m(11,st,5,2,"ng-container",49),t()(),i(12,"div",50)(13,"div",13)(14,"label"),o(15,"Course Name*"),t(),i(16,"select",14),m(17,mt,2,2,"option",51),t(),m(18,ut,2,0,"div",15),t(),i(19,"div",13)(20,"label"),o(21,"Custom Course Name"),t(),p(22,"input",52),m(23,pt,2,0,"div",15),t(),i(24,"div",13)(25,"label"),o(26,"Default Duration*"),t(),p(27,"input",53),m(28,gt,2,0,"div",15),t(),i(29,"div",13)(30,"label"),o(31,"Monthly Price*"),t(),p(32,"input",54),m(33,ft,2,0,"div",15),t()(),i(34,"div",50)(35,"div",13)(36,"label"),o(37,"Enrollment Date*"),t(),p(38,"input",55),m(39,_t,2,0,"div",15),t(),i(40,"div",13)(41,"label"),o(42,"Completion Date"),t(),p(43,"input",56),m(44,xt,2,0,"div",15),t(),i(45,"div",13)(46,"label"),o(47,"Instructor*"),t(),p(48,"input",57),m(49,ht,2,0,"div",15),t(),i(50,"div",13)(51,"label"),o(52,"Status*"),t(),p(53,"input",58),m(54,vt,2,0,"div",15),t()(),i(55,"div",59)(56,"div",50)(57,"div",13)(58,"label"),o(59,"Certification Type"),t(),i(60,"select",60),m(61,bt,2,2,"option",51),t(),m(62,Ct,2,0,"div",15),t(),i(63,"div",13)(64,"label"),o(65,"Certification Status*"),t(),p(66,"input",58),t(),i(67,"div",13)(68,"label"),o(69,"Certification Date"),t(),p(70,"input",58),t(),i(71,"div",13)(72,"label"),o(73,"Certificate ID"),t(),p(74,"input",58),t()()()()),r&2){let e,n,a,d,u,S,E,h,$,T,x,_e,xe,he,y=s.$implicit,Ke=s.index,te=g(2);c("formGroupName",Ke),l(),c("ngIf",!te.isEditMode),l(10),c("ngForOf",te.getTechStack(y)),l(6),c("ngForOf",te.courseList),l(),c("ngIf",((e=y.get("name"))==null?null:e.invalid)&&((e=y.get("name"))==null?null:e.touched)),l(),G("disabled",((n=y.get("name"))==null?null:n.value)!=="CUSTOM"),l(4),c("ngIf",((a=y.get("customName"))==null?null:a.invalid)&&((a=y.get("customName"))==null?null:a.touched)),l(5),c("ngIf",((d=y.get("defaultDuration"))==null?null:d.invalid)&&((d=y.get("defaultDuration"))==null?null:d.touched)),l(5),c("ngIf",((u=y.get("price"))==null?null:u.invalid)&&((u=y.get("price"))==null?null:u.touched)),l(6),c("ngIf",((S=y.get("enrollmentDate"))==null?null:S.invalid)&&((S=y.get("enrollmentDate"))==null?null:S.touched)),l(5),c("ngIf",((E=y.get("completionDate"))==null||E.errors==null?null:E.errors.completionBeforeEnrollment)&&((E=y.get("completionDate"))==null?null:E.touched)),l(5),c("ngIf",((h=y.get("instructor"))==null?null:h.invalid)&&((h=y.get("instructor"))==null?null:h.touched)),l(4),c("value",($=y.get("status"))==null?null:$.value),l(),c("ngIf",((T=y.get("status"))==null?null:T.invalid)&&((T=y.get("status"))==null?null:T.touched)),l(7),c("ngForOf",te.certificationTypeList),l(),c("ngIf",(x=y.get("certification.certificationType"))==null?null:x.invalid),l(4),c("value",(_e=y.get("certification.certificationStatus"))==null?null:_e.value),l(4),c("value",(xe=y.get("certification.certificationDate"))==null?null:xe.value),l(4),c("value",(he=y.get("certification.certificateId"))==null?null:he.value)}}function yt(r,s){if(r&1){let e=k();i(0,"button",69),v("click",function(){b(e);let a=g(2);return C(a.addCourse())}),o(1,"+ Add Course"),t()}}function Et(r,s){if(r&1){let e=k();i(0,"button",41),v("click",function(){b(e);let a=g(3);return C(a.onSubmit())}),o(1,"Create"),t()}}function kt(r,s){if(r&1){let e=k();i(0,"button",41),v("click",function(){b(e);let a=g(3);return C(a.updateStudent())}),o(1,"Update Student"),t()}}function Pt(r,s){if(r&1&&(N(0),m(1,Et,2,0,"button",7)(2,kt,2,0,"button",7),V()),r&2){let e=g(2);l(),c("ngIf",!e.isEditMode),l(),c("ngIf",e.isEditMode)}}function wt(r,s){if(r&1){let e=k();i(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),m(5,Ze,2,0,"h5",6)(6,He,2,1,"h5",6)(7,Je,2,0,"button",7),t(),i(8,"button",8),v("click",function(){b(e);let a=g();return C(a.closeModal())}),i(9,"span",9),o(10,"\xD7"),t()()(),i(11,"form",10)(12,"div",11)(13,"div",12)(14,"div",13)(15,"label"),o(16,"Full Name*"),t(),p(17,"input",14),m(18,Qe,2,0,"div",15),t(),i(19,"div",13)(20,"label"),o(21,"Age*"),t(),p(22,"input",16),m(23,Xe,2,0,"div",15),t(),i(24,"div",13)(25,"label"),o(26,"Gender*"),t(),i(27,"select",17)(28,"option",18),o(29,"Select"),t(),i(30,"option",19),o(31,"Male"),t(),i(32,"option",20),o(33,"Female"),t(),i(34,"option",21),o(35,"Other"),t()(),m(36,et,2,0,"div",15),t()(),i(37,"div",22)(38,"div",12)(39,"div",13)(40,"label"),o(41,"Email*"),t(),p(42,"input",23),m(43,tt,2,0,"div",15),t(),i(44,"div",13)(45,"label"),o(46,"Phone*"),t(),p(47,"input",24),m(48,it,2,0,"div",15),t(),i(49,"div",13)(50,"label"),o(51,"Alternate Phone"),t(),p(52,"input",25),t()()(),i(53,"div",26)(54,"div",27)(55,"div",13)(56,"label"),o(57,"Street*"),t(),p(58,"input",28),m(59,nt,2,0,"div",15),t(),i(60,"div",13)(61,"label"),o(62,"City*"),t(),p(63,"input",29),m(64,ot,2,0,"div",15),t(),i(65,"div",13)(66,"label"),o(67,"State*"),t(),p(68,"input",30),m(69,rt,2,0,"div",15),t(),i(70,"div",13)(71,"label"),o(72,"Zip*"),t(),p(73,"input",31),m(74,at,2,0,"div",15),t(),i(75,"div",13)(76,"label"),o(77,"Country*"),t(),p(78,"input",32),m(79,lt,2,0,"div",15),t()()(),i(80,"div",33),m(81,St,75,20,"div",34)(82,yt,2,0,"button",35),t()(),p(83,"app-loader",36),i(84,"div",37),m(85,Pt,3,2,"ng-container",38),i(86,"button",39),v("click",function(){b(e);let a=g();return C(a.closeModal())}),o(87,"Cancel"),t()()()()()()}if(r&2){let e,n,a,d,u,S,E,h,$,T,x=g();l(5),c("ngIf",!x.isEditMode),l(),c("ngIf",x.isEditMode),l(),c("ngIf",x.isReadyToCertify),l(4),c("formGroup",x.studentForm),l(),G("hidden",x.creatingStudent),l(6),c("ngIf",((e=x.studentForm.get("name"))==null?null:e.invalid)&&((e=x.studentForm.get("name"))==null?null:e.touched)),l(5),c("ngIf",((n=x.studentForm.get("age"))==null?null:n.invalid)&&((n=x.studentForm.get("age"))==null?null:n.touched)),l(13),c("ngIf",((a=x.studentForm.get("gender"))==null?null:a.invalid)&&((a=x.studentForm.get("gender"))==null?null:a.touched)),l(7),c("ngIf",((d=x.studentForm.get("contact.email"))==null?null:d.invalid)&&((d=x.studentForm.get("contact.email"))==null?null:d.touched)),l(5),c("ngIf",((u=x.studentForm.get("contact.phone"))==null?null:u.invalid)&&((u=x.studentForm.get("contact.phone"))==null?null:u.touched)),l(11),c("ngIf",((S=x.studentForm.get("address.street"))==null?null:S.invalid)&&((S=x.studentForm.get("address.street"))==null?null:S.touched)),l(5),c("ngIf",((E=x.studentForm.get("address.city"))==null?null:E.invalid)&&((E=x.studentForm.get("address.city"))==null?null:E.touched)),l(5),c("ngIf",((h=x.studentForm.get("address.state"))==null?null:h.invalid)&&((h=x.studentForm.get("address.state"))==null?null:h.touched)),l(5),c("ngIf",(($=x.studentForm.get("address.zip"))==null?null:$.invalid)&&(($=x.studentForm.get("address.zip"))==null?null:$.touched)),l(5),c("ngIf",((T=x.studentForm.get("address.country"))==null?null:T.invalid)&&((T=x.studentForm.get("address.country"))==null?null:T.touched)),l(),G("pointer-events-none",x.isCertified),l(),c("ngForOf",x.courses.controls),l(),c("ngIf",!x.isEditMode),l(),c("loading",x.creatingStudent),l(),G("disabled",x.creatingStudent),l(),c("ngIf",!x.isCertified)}}var Ge=(()=>{class r{set SelectedStudent(e){if(e){this.courses.clear(),this.studentForm.reset(),this.isOpen=!0,this.isEditMode=!!e.id;let n=me({},e);n.course=n.course?[n.course]:[],this.studentForm.patchValue(n),this.addCourse(n.course[0]),this.studentForm.updateValueAndValidity()}}constructor(e,n){this.fb=e,this.firebaseService=n,this.isOpen=!1,this.onClose=new ye,this.isEditMode=!1,this.courseList=[],this.courseStatusList=Object.values(F),this.certificationStatusList=Object.values(q),this.certificationTypeList=Object.values(Le),this.creatingStudent=!1,this.subscriptions=new D,this.studentForm=this.fb.group({id:[null],name:["",f.required],age:[null,[f.required,f.min(1)]],gender:["",f.required],contact:this.fb.group({email:["",[f.required,f.email]],phone:["",f.required],alternatePhone:[""]}),address:this.fb.group({street:["",f.required],city:["",f.required],state:["",f.required],zip:[null,[f.required,f.pattern("^[0-9]{6}$")]],country:["",f.required]}),course:this.fb.array([])})}ngOnInit(){this.loadAllCourses()}get courses(){return this.studentForm.get("course")}getTechStack(e){return e.get("technology")?.value??[]}addCourse(e){let n=this.fb.group({batchName:[e?.batchName||null],name:[e?.name||"",f.required],customName:[e?.customName||""],defaultDuration:[e?.defaultDuration||null,f.required],enrollmentDate:[e?.enrollmentDate||null,f.required],completionDate:[e?.completionDate||null,this.completionAfterEnrollmentValidator],technology:[e?.technology||[],f.required],price:[e?.price||0,[f.required,f.min(0)]],instructor:[e?.instructor||"",f.required],status:[e?.status||F.notStarted,f.required],certification:this.fb.group({certificationType:[e?.certification?.certificationType||""],certificationStatus:[e?.certification?.certificationStatus||q.notApplicable,f.required],certificationDate:[e?.certification?.certificationDate||""],certificateId:[e?.certification?.certificateId||""]})});this.nameValueChanges(n),this.completionDateValueChanges(n),this.batchNameValueChanges(n),e&&(e.name?.toLowerCase()==="custom"?n.get("customName")?.addValidators(f.required):(n.get("customName")?.removeValidators(f.required),n.get("customName")?.setErrors(null)),n.updateValueAndValidity()),this.courses.push(n)}nameValueChanges(e){let n=e.controls.name.valueChanges.subscribe(a=>{let d=this.courseList.find(u=>u.title===a);d&&(e.patchValue({defaultDuration:d.durationInMonth,price:d.discountPrice,technology:d.allTechItems||[]}),d.title.toLowerCase()==="custom"?e.get("customName")?.addValidators(f.required):(e.get("customName")?.removeValidators(f.required),e.get("customName")?.setErrors(null)),e.updateValueAndValidity())});this.subscriptions.add(n)}completionDateValueChanges(e){let n=e.controls.completionDate.valueChanges.subscribe(a=>{a&&(e.patchValue({certification:{certificationStatus:q.pending},status:F.completed}),e.get("certification.certificationType")?.setValidators([f.required]),e.get("certification.certificationType")?.updateValueAndValidity(),e.get("certification.certificationType")?.markAllAsTouched())});this.subscriptions.add(n)}batchNameValueChanges(e){let n=e.controls.batchName.valueChanges.subscribe(()=>{e.controls.status.value===F.notStarted&&(e.patchValue({status:F.inProgress}),e.updateValueAndValidity())});this.subscriptions.add(n)}removeTechAt(e,n){let a=e.get("technology")?.value??[];a.length!==1&&(a.splice(n,1),e.patchValue({technology:a}),e.updateValueAndValidity())}closeModal(){this.isOpen=!1,this.isEditMode=!1,this.courses.clear(),this.studentForm.reset(),window.history.replaceState({},document.title,window.location.pathname),this.onClose.emit()}onSubmit(){if(this.studentForm.valid){this.creatingStudent=!0;let e=[];this.getFlatStudents().forEach(a=>{e.push(this.firebaseService.saveNewData(P.students,a,a.id)),this.updateStudentLog(a)});let n=I(Promise.all(e)).subscribe({next:()=>{this.closeModal(),this.creatingStudent=!1,window.alert("Student created successfully!")},error:a=>{console.error("Error creating student:",a),this.creatingStudent=!1,window.alert("Failed to create student. Please try again.")}});this.subscriptions.add(n)}else this.studentForm.markAllAsTouched(),console.error("Form is invalid")}getFlatStudents(){let e=[],n=0;return this.studentForm.value.course.forEach(a=>{++n;let d=ve(me({},this.studentForm.value),{course:a});d.id=this.createId()+n,e.push(d)}),e}updateStudent(){let e=this.studentForm.value;e.course=e.course[0];let n=e.id;if(this.studentForm.valid&&n){this.creatingStudent=!0;let a=I(this.firebaseService.updateData(P.students,n,e)).subscribe({next:()=>{this.closeModal(),this.creatingStudent=!1,window.alert("Student updated successfully!"),this.updateStudentLog(e)},error:d=>{console.error("Error updating student:",d),this.creatingStudent=!1,window.alert("Failed to update student. Please try again.")}});this.subscriptions.add(a)}else this.studentForm.markAllAsTouched(),console.error("Form is invalid or student ID is missing")}updateStudentLog(e){let n={id:e.id??"",email:e.contact.email,name:e.name,gender:e.gender??"",courseTitle:e.course.name==="CUSTOM"?e.course.customName??"":e.course.name};this.subscriptions.add(I(this.firebaseService.saveNewData(P.studentLog,n,e.id)).subscribe())}certifyStudent(){let e=this.studentForm.value;if(!e.id||e.course[0].status!==F.completed){window.alert("Student is not eligible for certification.");return}this.subscriptions.add(this.firebaseService.getAllFromCollection(P.reviews).subscribe(n=>{if(n.findIndex(a=>a.studentId===e.id)===-1){window.alert("Student review not submitted. Certification cannot be processed.");return}this.studentForm.get("course")?.at(0)?.get("certification")?.patchValue({certificationStatus:q.certified,certificationDate:new Date().toDateString(),certificateId:e.id}),this.studentForm.updateValueAndValidity(),this.updateStudent(),this.generateCertificate()}))}generateCertificate(){let e=this.studentForm.value,n={id:e.id??"",issuedTo:e.name,courseTitle:e.course.name!=="CUSTOM"?e.course.name:e.course.customName,technologiesCovered:e.course.technology,duration:`${e.course.defaultDuration} months`,completionDate:e.course.certification?.certificationDate,certifiedBy:e.course.instructor??"",modeOfLearning:"Online",certificationType:e.course.certification?.certificationType,IssuedUnder:"Code Craft Learning"};this.subscriptions.add(I(this.firebaseService.saveNewData(P.certificates,n,e.id)).subscribe({next:()=>{console.log("Certificate generated successfully:",n),window.alert("Certificate generated successfully!")},error:a=>{console.error("Error generating certificate:",a),window.alert("Failed to generate certificate. Please try again.")}}))}loadAllCourses(){let e={description:"Custom Course",title:"CUSTOM",index:0,regularPrice:0,discountPrice:0,durationInMonth:0,technologies:[],allTechItems:[]},n=this.firebaseService.getAllFromCollection(P.coursePackages).subscribe(a=>{this.courseList=[e,...a]});this.subscriptions.add(n)}createId(){let n=this.studentForm.value.name.substring(0,2).toLowerCase(),a=Math.random().toString(36).substring(2,6);return n+a}ngOnDestroy(){this.subscriptions.unsubscribe()}get isReadyToCertify(){if(this.isEditMode){let e=this.studentForm.get("course")?.value[0];if(e.status===F.completed&&e.completionDate)return e.certification.certificationStatus===q.pending}return!1}get isCertified(){return this.studentForm.get("course")?.value[0]?.certification?.certificationStatus===q.certified}completionAfterEnrollmentValidator(e){let n=e.parent;if(!n)return null;let a=n.get("enrollmentDate")?.value,d=e.value;return a&&d&&new Date(d)<=new Date(a)?{completionBeforeEnrollment:!0}:null}static{this.\u0275fac=function(n){return new(n||r)(w(J),w(B))}}static{this.\u0275cmp=A({type:r,selectors:[["app-create-student-modal"]],inputs:{isOpen:"isOpen",SelectedStudent:"SelectedStudent"},outputs:{onClose:"onClose"},decls:1,vars:1,consts:[["class","modal","tabindex","-1","role","dialog",4,"ngIf"],["tabindex","-1","role","dialog",1,"modal"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"flex","flex-row","gap-2","items-center"],["class","modal-title",4,"ngIf"],["class","button-accent-sm",3,"click",4,"ngIf"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[3,"formGroup"],[1,"modal-body"],[1,"grid","grid-cols-3","gap-8"],[1,"form-group"],["formControlName","name",1,"form-control"],["class","text-red-500",4,"ngIf"],["type","number","formControlName","age",1,"form-control"],["formControlName","gender",1,"form-control"],["value",""],["value","Male"],["value","Female"],["value","Other"],["formGroupName","contact"],["formControlName","email",1,"form-control"],["formControlName","phone",1,"form-control"],["formControlName","alternatePhone",1,"form-control"],["formGroupName","address"],[1,"grid","grid-cols-5","gap-8"],["formControlName","street",1,"form-control"],["formControlName","city",1,"form-control"],["formControlName","state",1,"form-control"],["formControlName","zip",1,"form-control"],["formControlName","country",1,"form-control"],["formArrayName","course"],["class","border p-2 mb-2",3,"formGroupName",4,"ngFor","ngForOf"],["type","button","class","button-primary-sm",3,"click",4,"ngIf"],[3,"loading"],[1,"modal-footer"],[4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"modal-title"],[1,"button-accent-sm",3,"click"],[1,"text-red-500"],[1,"border","p-2","mb-2",3,"formGroupName"],["class","flex flex-row gap-4 align-middle",4,"ngIf"],[1,"grid","grid-cols-2","gap-8"],["formControlName","batchName",1,"form-control"],[1,"form-group","flex","flex-col","w-full","mb-3","border","border-dotted","border-1","border-black","px-4","py-1"],[1,"flex","flex-row","gap-2","flex-wrap","mb-2"],[4,"ngFor","ngForOf"],[1,"grid","grid-cols-4","gap-8"],[3,"value",4,"ngFor","ngForOf"],["formControlName","customName",1,"form-control"],["formControlName","defaultDuration",1,"form-control"],["type","number","formControlName","price",1,"form-control"],["type","date","formControlName","enrollmentDate",1,"form-control"],["type","date","formControlName","completionDate",1,"form-control"],["formControlName","instructor",1,"form-control"],["readonly","",1,"bg-slate-300","form-control",3,"value"],["formGroupName","certification"],["formControlName","certificationType",1,"form-control"],[1,"flex","flex-row","gap-4","align-middle"],[1,"mb-2","text-text","underline","underline-offset-2"],["type","button",1,"mt-2","bg-red-300","px-4","rounded-lg",3,"click"],[1,"bg-blue-300","rounded-lg","px-2","flex","flex-row","gap-4","items-center"],[1,"text-primary","text-sm"],["class","cursor-pointer text-black text-sm hover:text-red-500",3,"click",4,"ngIf"],[1,"cursor-pointer","text-black","text-sm","hover:text-red-500",3,"click"],[3,"value"],["type","button",1,"button-primary-sm",3,"click"]],template:function(n,a){n&1&&m(0,wt,88,24,"div",0),n&2&&c("ngIf",a.isOpen)},dependencies:[L,oe,z,Z,H,R,ae,Y,j,W,U,K,le,ce,Q],styles:[".modal[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:#00000080;position:fixed;inset:0;height:100vh;width:100vw;z-index:1050}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:8px;width:70%;height:90%;overflow-y:auto;margin:2rem auto;box-shadow:0 4px 24px #0003}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{border:none;border-radius:8px;overflow:hidden}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.5rem;border-bottom:1px solid #e9ecef;background:#f8f9fa}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{background:transparent;border:none;font-size:1.5rem;cursor:pointer;color:#333;transition:color .2s}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]:hover{color:#d9534f}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid #ced4da;border-radius:4px;font-size:1rem;transition:border-color .2s}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#d9534f;font-size:.875rem;margin-top:.25rem}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:1rem 1.5rem;border-top:1px solid #e9ecef;background:#f8f9fa}.modal[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px;margin-left:.5rem}"]})}}return r})();var Ft=(r,s,e)=>({"course-completed":r,"course-in-progress":s,"course-not-started":e}),Ot=(r,s,e)=>({"certification-certified":r,"certification-pending":s,"certification-not-applicable":e});function Tt(r,s){if(r&1&&(i(0,"option",33),o(1),t()),r&2){let e=s.$implicit;c("value",e),l(),_(e)}}function Nt(r,s){if(r&1&&(i(0,"option",33),o(1),t()),r&2){let e=s.$implicit;c("value",e),l(),_(e)}}function Vt(r,s){if(r&1){let e=k();N(0),i(1,"tr",34)(2,"td",35),o(3),t(),i(4,"td",35),o(5),t(),i(6,"td",35),o(7),t(),i(8,"td",35),o(9),t(),i(10,"td",35),o(11),t(),i(12,"td",35),o(13),t(),i(14,"td",35),o(15),t(),i(16,"td",35),o(17),t(),i(18,"td",36),o(19),t(),i(20,"td",36),o(21),t(),i(22,"td",37)(23,"a",38),v("click",function(){let a=b(e).$implicit,d=g();return C(d.openStudent(a))}),o(24,"View"),t()()(),V()}if(r&2){let e=s.$implicit;l(3),_(e.id),l(2),_(e.name),l(2),_(e.age),l(2),_(e.gender),l(2),_(e.contact.email),l(2),_(e.contact.phone),l(2),_(e.course.name),l(2),_(e.course.batchName),l(),c("ngClass",ue(12,Ft,(e.course.status==null?null:e.course.status.toString())==="completed",(e.course.status==null?null:e.course.status.toString())==="in-progress",(e.course.status==null?null:e.course.status.toString())==="not-started")),l(),M(" ",e.course.status," "),l(),c("ngClass",ue(16,Ot,(e.course.certification==null||e.course.certification.certificationStatus==null?null:e.course.certification.certificationStatus.toString())==="Certified",(e.course.certification==null||e.course.certification.certificationStatus==null?null:e.course.certification.certificationStatus.toString())==="Pending",(e.course.certification==null||e.course.certification.certificationStatus==null?null:e.course.certification.certificationStatus.toString())==="Not applicable")),l(),M(" ",e.course.certification==null?null:e.course.certification.certificationStatus," ")}}var Re=(()=>{class r{constructor(e,n,a){this.firebaseService=e,this.activatedRoute=n,this.fb=a,this.createStudentModal=!1,this.allStudents=[],this.filteredStudents=[],this.courseStatus=["",...Object.values(F)],this.certificationStatus=["",...Object.values(q)],this.subscriptions=new D,this.courses=[],this.filterForm=this.fb.group({id:[""],name:[""],email:[""],phone:[""],courseName:[""],batchName:[""],courseStatus:[""],certificationStatus:[""]})}ngOnInit(){this.loadAllCourses(),this.loadAllStudents(),this.loadParams(),this.filterFormChange()}filterFormChange(){let e=this.filterForm.valueChanges.subscribe(()=>{this.filterStudentsOnChange()});this.subscriptions.add(e)}filterStudentsOnChange(){let e=this.filterForm.value,n=this.allStudents;Object.keys(e).forEach(a=>{let d=""+e[a];if(d)switch(a){case"id":n=n.filter(u=>u.id?.toLowerCase().startsWith(d.trim().toLowerCase()));break;case"name":n=n.filter(u=>u.name?.toLowerCase().startsWith(d.trim().toLowerCase()));break;case"email":n=n.filter(u=>u.contact.email?.toLowerCase().startsWith(d.trim().toLowerCase()));break;case"phone":n=n.filter(u=>u.contact.phone?.toLowerCase().startsWith(d.trim().toLowerCase()));break;case"courseName":n=n.filter(u=>u.course.name?.toLowerCase().startsWith(d.trim().toLowerCase())||u.course.customName?.toLowerCase().startsWith(d.trim().toLowerCase()));break;case"batchName":n=n.filter(u=>u.course.batchName?.toLowerCase().startsWith(d.trim().toLowerCase()));break;case"courseStatus":n=n.filter(u=>u.course.status?.toLowerCase().startsWith(d.trim().toLowerCase()));break;case"certificationStatus":n=n.filter(u=>u.course.certification?.certificationStatus?.toLowerCase().startsWith(d.trim().toLowerCase()));break}}),this.filteredStudents=n}loadAllCourses(){this.subscriptions.add(this.firebaseService.getAllFromCollection(P.coursePackages,"title").subscribe(e=>{this.courses=e}))}loadParams(){this.subscriptions.add(this.activatedRoute.queryParams.subscribe(e=>{e.enquiryId&&this.firebaseService.getFromCollectionById(P.enquiries,e.enquiryId).subscribe(n=>{this.openStudent(this.loadStudentWithEnquiry(n))})}))}loadStudentWithEnquiry(e){let n={name:e.fullName,age:e.age,contact:{email:e.email,phone:e.contactNumber}};(e.packageName===void 0||e.packageName===null)&&(n.course={name:"CUSTOM",technology:e.technologies});let a=this.courses.find(d=>d.title===e.packageName);return a&&(n.course={name:a.title,defaultDuration:a.durationInMonth,technology:a.allTechItems,price:a.discountPrice}),n}openStudent(e){this.selectedStudent=e,this.createStudentModal=!0}closeStudentModal(){this.createStudentModal=!1,this.selectedStudent=void 0}loadAllStudents(){this.subscriptions.add(this.firebaseService.getAllFromCollection(P.students,"id").subscribe(e=>{this.allStudents=e.sort((n,a)=>(n?.course?.enrollmentDate??1)<(a?.course?.enrollmentDate??0)?-1:1),this.filteredStudents=this.allStudents}))}ngOnDestroy(){this.subscriptions.unsubscribe()}static{this.\u0275fac=function(n){return new(n||r)(w(B),w(Te),w(J))}}static{this.\u0275cmp=A({type:r,selectors:[["app-students"]],decls:73,vars:6,consts:[[1,"flex","flex-col","gap-2","absolute","left-0","px-10","w-full","-mt-12"],[1,"border","border-primary","rounded-lg","px-4","py-2"],[1,"text-base","font-semibold","text-primary","px-2"],[1,"flex","flex-row","justify-start","flex-wrap","gap-4","form-group",3,"formGroup"],[1,"flex","flex-col","gap-1"],["for","idFilter"],["id","idFilter","type","text","formControlName","id",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","nameFilter"],["id","nameFilter","type","text","formControlName","name",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","emailFilter"],["id","emailFilter","type","text","formControlName","email",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","phoneFilter"],["id","phoneFilter","type","text","formControlName","phone",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","courseNameFilter"],["id","courseNameFilter","type","text","formControlName","courseName",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","batchNameFilter"],["id","batchNameFilter","type","text","formControlName","batchName",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],["for","courseStatusFilter"],["id","courseStatusFilter","formControlName","courseStatus",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],[3,"value",4,"ngFor","ngForOf"],["for","certificationStatusFilter"],["id","certificationStatusFilter","formControlName","certificationStatus",1,"form-control","border","border-1","border-primary","rounded-lg","px-4","py-1","text-xs","font-poppins"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","px-4","py-1","text-left","rounded-lg"],[1,"flex","flex-row","gap-6","items-center","h-10","justify-between"],[1,"button-primary-xs",3,"click"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],[3,"onClose","isOpen","SelectedStudent"],[3,"value"],[1,"py-2","h-5","text-xs","font-poppins","bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text","hover:outline","hover:outline-1","hover:outline-black","hover:bg-yellow-50"],[1,"px-6"],[1,"px-6",3,"ngClass"],[1,"px-6","text-center"],[1,"text-blue","underline","underline-offset-2","cursor-pointer",3,"click"]],template:function(n,a){n&1&&(i(0,"div",0)(1,"fieldset",1)(2,"legend",2),o(3,"Filter"),t(),i(4,"form",3)(5,"div",4)(6,"label",5),o(7,"Id"),t(),p(8,"input",6),t(),i(9,"div",4)(10,"label",7),o(11,"Name"),t(),p(12,"input",8),t(),i(13,"div",4)(14,"label",9),o(15,"Email"),t(),p(16,"input",10),t(),i(17,"div",4)(18,"label",11),o(19,"Phone"),t(),p(20,"input",12),t(),i(21,"div",4)(22,"label",13),o(23,"Course Name"),t(),p(24,"input",14),t(),i(25,"div",4)(26,"label",15),o(27,"Batch Name"),t(),p(28,"input",16),t(),i(29,"div",4)(30,"label",17),o(31,"Course Status"),t(),i(32,"select",18),m(33,Tt,2,2,"option",19),t()(),i(34,"div",4)(35,"label",20),o(36,"Certification Status"),t(),i(37,"select",21),m(38,Nt,2,2,"option",19),t()()()(),i(39,"div",22)(40,"table",23)(41,"caption",24)(42,"div",25)(43,"span"),o(44,"Student List"),t(),i(45,"button",26),v("click",function(){return a.createStudentModal=!0}),o(46,"+ Create Student"),t()()(),i(47,"thead",27)(48,"tr",28)(49,"th",29),o(50,"Id"),t(),i(51,"th",29),o(52,"Name"),t(),i(53,"th",29),o(54,"Age"),t(),i(55,"th",29),o(56,"Gender"),t(),i(57,"th",29),o(58,"Email"),t(),i(59,"th",29),o(60,"Phone"),t(),i(61,"th",29),o(62,"Course Name"),t(),i(63,"th",29),o(64,"Batch Name"),t(),i(65,"th",29),o(66,"Course Status"),t(),i(67,"th",29),o(68,"Certification Status"),t(),p(69,"th",29),t()(),i(70,"tbody",30),m(71,Vt,25,20,"ng-container",31),t()()()(),i(72,"app-create-student-modal",32),v("onClose",function(){return a.closeStudentModal()}),t()),n&2&&(l(4),c("formGroup",a.filterForm),l(29),c("ngForOf",a.courseStatus),l(5),c("ngForOf",a.certificationStatus),l(33),c("ngForOf",a.filteredStudents),l(),c("isOpen",a.createStudentModal)("SelectedStudent",a.selectedStudent))},dependencies:[Fe,L,z,Z,H,R,Y,j,W,U,K,Ge],styles:[".certification-certified[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.certification-pending[_ngcontent-%COMP%]{background-color:#fff3cd;color:#856404}.certification-not-applicable[_ngcontent-%COMP%]{background-color:#e2e3e5;color:#383d41}.course-completed[_ngcontent-%COMP%]{background-color:#cce5ff;color:#004085}.course-in-progress[_ngcontent-%COMP%]{background-color:#fffbe6;color:#856404}.course-not-started[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24}"]})}}return r})();var se=(r,s)=>{let e=Se(je);return Be(e).pipe(Ce(1),be(n=>n?!0:(window.alert("You must be logged in to access this page"),!1)))};function qt(r,s){if(r&1){let e=k();i(0,"label",15)(1,"input",16),we("ngModelChange",function(a){let d=b(e).$implicit,u=g();return Pe(u.selectedStatuses[d],a)||(u.selectedStatuses[d]=a),C(a)}),t(),i(2,"span"),o(3),t()()}if(r&2){let e=s.$implicit,n=g();l(),c("value",e),ke("ngModel",n.selectedStatuses[e]),l(2),_(e)}}function Dt(r,s){if(r&1){let e=k();N(0),i(1,"tr",17)(2,"td",18),o(3),t(),i(4,"td",18),o(5),t(),i(6,"td",18),o(7),t(),i(8,"td",18),o(9),t(),i(10,"td",18),o(11),t(),i(12,"td",18),o(13),Me(14,"timestampPipe"),t(),i(15,"td",18),o(16),t(),i(17,"td",18),o(18),t(),i(19,"td",18),o(20),t(),i(21,"td",18),o(22),t(),i(23,"td",18),o(24),t(),i(25,"td",19)(26,"a",20),v("click",function(){let a=b(e).$implicit,d=g();return C(d.viewEnquiry(a))}),o(27,"View"),t(),i(28,"a",21),v("click",function(){let a=b(e).$implicit,d=g();return C(d.confirmEnquiry(a))}),o(29,"Confirm"),t(),i(30,"a",22),v("click",function(){let a=b(e).$implicit,d=g();return C(d.cancelEnquiry(a))}),o(31,"Cancel"),t()()(),V()}if(r&2){let e=s.$implicit;l(),Ee(e.status),l(2),_(e.id),l(2),_(e.fullName),l(2),_(e.age),l(2),_(e.email),l(2),_(e.contactNumber),l(2),_(Ie(14,13,e.createdDate)),l(3),_(e.packageName),l(2),_(e.technologies.join(", ")),l(2),_(e.enquiryPrice),l(2),_(e.status),l(2),_(e.notes)}}var We=(()=>{class r{constructor(e,n){this.firebaseService=e,this.router=n,this.loading=!1,this.enquiries=[],this.enquiryStatus=Object.values(O),this.selectedStatuses={[O.pending]:!0,[O.confirmed]:!0,[O.cancelled]:!0,[O.contacted]:!0},this.subscription=new D}ngOnInit(){this.getEnquiries()}get filteredEnquiries(){return this.enquiries.filter(e=>this.selectedStatuses[e.status||O.pending])}removeEnquiry(e){if(!e||!e.id){console.error("Invalid enquiry data:",e);return}if(confirm(`Are you sure you want to delete the enquiry from ${e.fullName}?`)){this.loading=!0;let n=I(this.firebaseService.deleteData(P.enquiries,e.id)).subscribe(()=>{this.enquiries=this.enquiries.filter(a=>a.id!==e.id),this.loading=!1},a=>{console.error("Error deleting enquiry:",a),this.loading=!1});this.subscription.add(n)}}cancelEnquiry(e){let n=window.prompt("Reason for cancellation:");if(!n){window.alert("Cancellation reason is required.");return}e.notes=n,e.status=O.cancelled,this.updateEnquiry(e)}viewEnquiry(e){let n=window.prompt("Message / updates:");if(!n){window.alert("message is required.");return}e.notes=n,e.status=O.contacted,this.updateEnquiry(e)}confirmEnquiry(e){window.confirm(`Are you sure you want to confirm the enquiry from ${e.fullName}?`)&&(e.status=O.confirmed,this.updateEnquiry(e),this.router.navigate(["/admin/students"],{queryParams:{enquiryId:e.id}}))}updateEnquiry(e){if(!e||!e.id){console.error("Invalid enquiry data:",e);return}this.loading=!0;let n=I(this.firebaseService.updateData(P.enquiries,e.id,e)).subscribe(()=>{let a=this.enquiries.findIndex(d=>d.id===e.id);a!==-1&&(this.enquiries[a]=e),this.loading=!1},a=>{console.error("Error updating enquiry:",a),this.loading=!1});this.subscription.add(n)}getEnquiries(){this.loading=!0;let e=this.firebaseService.getAllFromCollection(P.enquiries,"id").subscribe(n=>{this.enquiries=n,this.loading=!1},n=>{console.error("Error fetching enquiries:",n),this.loading=!1});this.subscription.add(e)}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(n){return new(n||r)(w(B),w(Ne))}}static{this.\u0275cmp=A({type:r,selectors:[["app-enquiry"]],decls:40,vars:3,consts:[[1,"flex","flex-col","gap-6","absolute","left-0","px-10","w-full"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","p-4","text-left","rounded-lg"],[1,"flex","flex-row","justify-between"],[1,"flex","flex-row","gap-6","align-middle","h-10","items-center"],[1,"text-gray-500","text-sm"],[1,"flex","flex-row","gap-6"],[1,"flex","flex-row","gap-4","items-center"],["class","flex flex-row items-center gap-1",4,"ngFor","ngForOf"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],[1,"flex","flex-row","items-center","gap-1"],["type","checkbox",1,"accent-primary",3,"ngModelChange","value","ngModel"],[1,"bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text","status"],[1,"px-6","py-4"],[1,"px-6","py-4","text-center","flex","flex-row","gap-2"],[1,"text-","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"text-black","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"text-red-500","underline","underline-offset-2","cursor-pointer",3,"click"]],template:function(n,a){n&1&&(i(0,"div",0)(1,"div",1)(2,"table",2)(3,"caption",3)(4,"div",4)(5,"div",5)(6,"span"),o(7,"Enquiry List"),t(),i(8,"span",6),o(9),t()(),i(10,"div",7)(11,"div",8),m(12,qt,4,3,"label",9),t()()()(),i(13,"thead",10)(14,"tr",11)(15,"th",12),o(16,"Id"),t(),i(17,"th",12),o(18,"Name"),t(),i(19,"th",12),o(20,"Age"),t(),i(21,"th",12),o(22,"Email"),t(),i(23,"th",12),o(24,"Phone"),t(),i(25,"th",12),o(26,"Date"),t(),i(27,"th",12),o(28,"Package Name"),t(),i(29,"th",12),o(30,"Technologies"),t(),i(31,"th",12),o(32,"Enquiry Price"),t(),i(33,"th",12),o(34,"Status"),t(),i(35,"th",12),o(36,"Notes"),t(),p(37,"th",12),t()(),i(38,"tbody",13),m(39,Dt,32,15,"ng-container",14),t()()()()),n&2&&(l(9),M("Total Enquiries: ",a.enquiries.length,""),l(3),c("ngForOf",a.enquiryStatus),l(27),c("ngForOf",a.filteredEnquiries))},dependencies:[L,re,j,Ve,$e],styles:[".status.pending[_ngcontent-%COMP%]{background-color:#ffe082}.status.contacted[_ngcontent-%COMP%]{background-color:#b3e5fc}.status.cancelled[_ngcontent-%COMP%]{background-color:#ffcdd2}.status.confirmed[_ngcontent-%COMP%]{background-color:#c8e6c9}"]})}}return r})();function At(r,s){if(r&1){let e=k();N(0),i(1,"tr",16)(2,"td",17),o(3),t(),i(4,"td",17),o(5),t(),i(6,"td",17),o(7),t(),i(8,"td",17),o(9),t(),i(10,"td",17),o(11),t(),i(12,"td",17),o(13),t(),i(14,"td",18)(15,"a",19),v("click",function(){let a=b(e).$implicit,d=g(2);return C(d.viewCourse(a))}),o(16,"View"),t()()(),V()}if(r&2){let e=s.$implicit;l(3),_(e.index),l(2),_(e.title),l(2),_(e.description),l(2),_(e.regularPrice),l(2),_(e.discountPrice),l(2),_(e.durationInMonth)}}function Lt(r,s){if(r&1){let e=k();i(0,"table",5)(1,"caption",6)(2,"div",7)(3,"div",8)(4,"span"),o(5,"Package List"),t(),i(6,"span",9),o(7),t(),i(8,"button",10),v("click",function(){b(e);let a=g();return C(a.createNewPackage())}),o(9,"Create new package"),t()()()(),i(10,"thead",11)(11,"tr",12)(12,"th",13),o(13,"Index"),t(),i(14,"th",13),o(15,"Title"),t(),i(16,"th",13),o(17,"Description"),t(),i(18,"th",13),o(19,"Regular Price"),t(),i(20,"th",13),o(21,"Discounted Price"),t(),i(22,"th",13),o(23,"Duration"),t(),p(24,"th",13),t()(),i(25,"tbody",14),m(26,At,17,6,"ng-container",15),t()()}if(r&2){let e=g();l(7),M("Total Packages: ",e.packages.length,""),l(19),c("ngForOf",e.packages)}}function jt(r,s){r&1&&(i(0,"h3",43),o(1,"Create Package"),t())}function Bt(r,s){r&1&&(i(0,"h3",43),o(1,"Update Package"),t())}function $t(r,s){r&1&&(i(0,"div",44),o(1," Index is required and must be 0 or greater. "),t())}function Gt(r,s){r&1&&(i(0,"div",44),o(1," Title is required. "),t())}function Rt(r,s){r&1&&(i(0,"div",44),o(1," Regular price is required and must be 0 or greater. "),t())}function Wt(r,s){r&1&&(i(0,"div",44),o(1," Discounted price is required and must be 0 or greater. "),t())}function zt(r,s){r&1&&(i(0,"div",44),o(1," Duration is required and must be at least 1 month. "),t())}function Ut(r,s){r&1&&(i(0,"div",44),o(1," Description is required. "),t())}function Kt(r,s){if(r&1&&(i(0,"div",45)(1,"span",46),o(2),t()()),r&2){let e,n=g(2);l(2),M(" ",(e=n.packageForm.get("allTechItems"))==null||e.value==null?null:e.value.join(", ")," ")}}function Yt(r,s){if(r&1&&p(0,"app-dropdown",55),r&2){let e=g(3);c("items",e.availableTechnologies)("multiselect",!0)}}function Zt(r,s){if(r&1&&p(0,"app-dropdown",56),r&2){let e=g(3);c("items",e.packages)("multiselect",!0)}}function Ht(r,s){r&1&&(i(0,"select",57)(1,"option",58),o(2,"None"),t(),i(3,"option",59),o(4,"+"),t(),i(5,"option",60),o(6,"/"),t()())}function Jt(r,s){if(r&1){let e=k();i(0,"div",47)(1,"label",48)(2,"input",49),v("ngModelChange",function(){let a=b(e).$implicit,d=g(2);return C(d.resetTechs(a))}),t(),i(3,"span"),o(4,"Is Package"),t()(),m(5,Yt,1,2,"app-dropdown",50)(6,Zt,1,2,"app-dropdown",51)(7,Ht,7,0,"select",52),i(8,"button",53),v("click",function(){let a=b(e).index,d=g(2);return C(d.technologies.removeAt(a))}),o(9,"-Remove"),t(),i(10,"span",54),o(11),t()()}if(r&2){let e,n,a,d=s.$implicit,u=s.index,S=g(2);c("formGroupName",u),l(5),c("ngIf",!((e=d.get("isPackage"))!=null&&e.value)),l(),c("ngIf",(n=d.get("isPackage"))==null?null:n.value),l(),c("ngIf",((a=d.get("techs"))==null||a.value==null?null:a.value.length)>1||((a=d.get("packages"))==null||a.value==null?null:a.value.length)>1),l(4),_(S.getTechString(d))}}function Qt(r,s){if(r&1){let e=k();i(0,"button",61),v("click",function(){b(e);let a=g(2);return C(a.deletePackage())}),o(1," Delete Package "),t()}}function Xt(r,s){if(r&1){let e=k();i(0,"div",20)(1,"div",21)(2,"div",22),m(3,jt,2,0,"h3",23)(4,Bt,2,0,"h3",23),i(5,"button",24),v("click",function(){b(e);let a=g();return C(a.closeCourse())}),o(6," \xD7 "),t()(),p(7,"app-loader",2),i(8,"form",25)(9,"div",26)(10,"div")(11,"label",27),o(12,"Index"),t(),p(13,"input",28),m(14,$t,2,0,"div",29),t(),i(15,"div")(16,"label",27),o(17,"Title"),t(),p(18,"input",30),m(19,Gt,2,0,"div",29),t(),i(20,"div")(21,"label",27),o(22,"Regular Price"),t(),p(23,"input",31),m(24,Rt,2,0,"div",29),t()(),i(25,"div",26)(26,"div")(27,"label",27),o(28,"Discounted Price"),t(),p(29,"input",32),m(30,Wt,2,0,"div",29),t(),i(31,"div")(32,"label",27),o(33,"Duration (Months)"),t(),p(34,"input",33),m(35,zt,2,0,"div",29),t(),i(36,"div")(37,"label",27),o(38,"Description"),t(),p(39,"input",34),m(40,Ut,2,0,"div",29),t()(),m(41,Kt,3,1,"div",35),i(42,"div")(43,"label",27),o(44,"Technologies"),t(),i(45,"div",36),m(46,Jt,12,5,"div",37),i(47,"button",38),v("click",function(){b(e);let a=g();return C(a.addTechnology())}),o(48,"Add Technology"),t()()(),i(49,"div",39)(50,"button",40),v("click",function(){b(e);let a=g();return C(a.onSubmit())}),o(51),t(),m(52,Qt,2,0,"button",41),i(53,"button",42),v("click",function(){b(e);let a=g();return C(a.closeCourse())}),o(54,"Cancel"),t()()()()()}if(r&2){let e,n,a,d,u,S,E,h=g();l(3),c("ngIf",!h.selectedPackage),l(),c("ngIf",h.selectedPackage),l(3),c("loading",h.packageProcessing),l(),G("hidden",h.packageProcessing),c("formGroup",h.packageForm),l(6),c("ngIf",((e=h.packageForm.get("index"))==null?null:e.invalid)&&((e=h.packageForm.get("index"))==null?null:e.touched)),l(5),c("ngIf",((n=h.packageForm.get("title"))==null?null:n.invalid)&&((n=h.packageForm.get("title"))==null?null:n.touched)),l(5),c("ngIf",((a=h.packageForm.get("regularPrice"))==null?null:a.invalid)&&((a=h.packageForm.get("regularPrice"))==null?null:a.touched)),l(6),c("ngIf",((d=h.packageForm.get("discountPrice"))==null?null:d.invalid)&&((d=h.packageForm.get("discountPrice"))==null?null:d.touched)),l(5),c("ngIf",((u=h.packageForm.get("durationInMonth"))==null?null:u.invalid)&&((u=h.packageForm.get("durationInMonth"))==null?null:u.touched)),l(5),c("ngIf",((S=h.packageForm.get("description"))==null?null:S.invalid)&&((S=h.packageForm.get("description"))==null?null:S.touched)),l(),c("ngIf",(E=h.packageForm.get("allTechItems"))==null||E.value==null?null:E.value.length),l(5),c("ngForOf",h.technologies.controls),l(5),M(" ",h.selectedPackage?"Update":"Create"," Package "),l(),c("ngIf",!!h.selectedPackage)}}var ze=(()=>{class r{constructor(e,n){this.firebaseService=e,this.fb=n,this.loading=!0,this.packages=[],this.isOpen=!1,this.subscription=new D,this.availableTechnologies=[],this.packageProcessing=!1,this.packageForm=this.fb.group({index:[null,[f.required,f.min(0)]],title:[null,f.required],description:[null,f.required],regularPrice:[null,[f.required,f.min(0)]],discountPrice:[null,[f.required,f.min(0)]],durationInMonth:[null,[f.required,f.min(1)]],allTechItems:[[]],technologies:this.fb.array([])})}get technologies(){return this.packageForm.get("technologies")}addTechnology(e){this.technologies.push(this.fb.group({techs:[[]],packages:[[]],isPackage:[e?.isPackage||!1],combinationBy:[e?.combinationBy||""]}))}removeTechnology(e){this.technologies.removeAt(e)}ngOnInit(){this.fetchPackages()}createNewPackage(){this.isOpen=!0,this.selectedPackage=void 0,this.packageForm.reset(),this.technologies.clear(),this.packageForm.setControl("technologies",this.fb.array([])),this.packageForm.patchValue({index:this.packages.length+1,title:null,description:null,regularPrice:null,discountPrice:null,durationInMonth:null,allTechItems:[]}),this.packageForm.updateValueAndValidity(),this.addTechnology()}viewCourse(e){this.isOpen=!0,this.selectedPackage=e,this.packageForm.reset(),this.technologies.clear();let n=e.technologies||[];n.forEach(a=>{if(a.isPackage){let d=[];a.name.forEach(u=>{let S=this.packages.find(E=>E.title===u);S&&d.push(S)}),this.technologies.push(this.fb.group({packages:[d],techs:[[]],isPackage:[!0],combinationBy:[a.combinationBy||""]}))}else this.technologies.push(this.fb.group({techs:[a.name],packages:[[]],isPackage:[!1],combinationBy:[a.combinationBy||""]}))}),this.packageForm.patchValue({index:e.index,title:e.title,description:e.description,regularPrice:e.regularPrice,discountPrice:e.discountPrice,durationInMonth:e.durationInMonth,allTechItems:e.allTechItems||[],technologies:n}),this.packageForm.updateValueAndValidity()}closeCourse(){this.selectedPackage=void 0,this.technologies.clear(),this.isOpen=!1}getTechString(e){return e.get("isPackage")?.value?`${e.get("packages")?.value?.map(n=>n.title)?.join(" "+e.get("combinationBy")?.value+" ")}`:`${e.get("techs")?.value?.join(" "+e.get("combinationBy")?.value+" ")}`}resetTechs(e){e.get("packages")?.setValue([]),e.get("techs")?.setValue([]),e.updateValueAndValidity()}deletePackage(){if(!this.selectedPackage)return;let e=this.selectedPackage.id;e&&confirm("Are you sure you want to delete this package?")&&(this.packageProcessing=!0,this.subscription.add(I(this.firebaseService.deleteData(P.coursePackages,e)).subscribe({next:()=>{window.alert("Package deleted successfully"),this.selectedPackage=void 0,this.technologies.clear(),this.packageForm.reset(),this.packageProcessing=!1,this.isOpen=!1,this.fetchPackages()},error:n=>{this.packageProcessing=!1,window.alert("Error deleting package:")}})))}onSubmit(){if(this.packageForm.invalid){this.packageForm.markAllAsTouched();return}this.packageProcessing=!0;let e=this.packageForm.value,n={index:e.index,title:e.title,description:e.description,regularPrice:e.regularPrice,discountPrice:e.discountPrice,durationInMonth:e.durationInMonth,allTechItems:e.allTechItems||[]},a=[],d=new Set;e.technologies.forEach(u=>{if(u.isPackage){let S={name:u.packages.map(E=>E.title),isPackage:!0,combinationBy:u.combinationBy,iconUrl:[]};u.packages.forEach(E=>{E.allTechItems.forEach(h=>{d.add(h)})}),a.push(S)}else{let S={name:u.techs,isPackage:!1,combinationBy:u.combinationBy,iconUrl:[]};u.techs.forEach(E=>{d.add(E)}),a.push(S)}}),n.technologies=a,n.allTechItems=Array.from(d),this.subscription.add(I(this.firebaseService.saveNewData(P.coursePackages,n)).subscribe({next:()=>{window.alert("Package created successfully"),this.fetchPackages(),this.packageProcessing=!1,this.isOpen=!1},error:u=>{window.alert("Error creating package:"),this.packageProcessing=!1}}))}loadAllTechnologies(){let e=new Set;this.packages.forEach(n=>{n.allTechItems.forEach(a=>{e.add(a)})}),this.availableTechnologies=Array.from(e)}fetchPackages(){this.loading=!0,this.subscription.add(this.firebaseService.getAllFromCollection(P.coursePackages).subscribe({next:e=>{console.log(e),this.packages=e.sort((n,a)=>n.index-a.index),this.loading=!1,this.loadAllTechnologies()},error:e=>{console.error("Error fetching packages:",e),this.loading=!1}}))}static{this.\u0275fac=function(n){return new(n||r)(w(B),w(J))}}static{this.\u0275cmp=A({type:r,selectors:[["app-packages"]],decls:5,vars:3,consts:[[1,"flex","flex-col","gap-6","absolute","left-0","px-10","w-full"],[1,"flex","flex-row","w-full","justify-center","border","border-primary","rounded-lg","mb-32"],[3,"loading"],["class","w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400 rounded-lg",4,"ngIf"],["class","fixed inset-0 z-30 flex items-center justify-center bg-black bg-opacity-40 backdrop-blur-sm ",4,"ngIf"],[1,"w-full","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400","rounded-lg"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-800","p-4","text-left","rounded-lg"],[1,"flex","flex-row","justify-between"],[1,"flex","flex-row","gap-6","align-middle","h-10","items-center"],[1,"text-gray-500","text-sm"],[1,"button-primary-sm",3,"click"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],[1,"table-row"],["scope","col",1,"px-6","py-3","text-primary"],[1,""],[4,"ngFor","ngForOf"],[1,"bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","text-text"],[1,"px-6","py-4"],[1,"px-6","py-4","text-center","flex","flex-row","gap-2"],[1,"text-","underline","underline-offset-2","cursor-pointer",3,"click"],[1,"fixed","inset-0","z-30","flex","items-center","justify-center","bg-black","bg-opacity-40","backdrop-blur-sm"],[1,"relative","z-40","bg-secondary","rounded-lg","shadow-lg","p-6","w-1/2","max-h-[85vh]","overflow-y-auto"],[1,"flex","flex-row","justify-between","w-full","bg-primary","py-3","px-5","text-white","rounded-lg","align-middle"],["class","text-lg font-semibold ",4,"ngIf"],["aria-label","Close",1,"text-3xl","font-semibold","cursor-pointer","hover:text-gray-300","transition-colors",3,"click"],[1,"mt-6","flex","flex-col","gap-6",3,"formGroup"],[1,"grid","grid-cols-3","gap-4"],[1,"block","mb-1","font-medium"],["type","number","formControlName","index","min","0","readonly","",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["class","text-red-500 text-xs",4,"ngIf"],["type","text","formControlName","title",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","number","formControlName","regularPrice","min","0",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","number","formControlName","discountPrice","min","0",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["type","number","formControlName","durationInMonth","min","1",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["formControlName","description","rows","3",1,"px-4","py-2","border","border-black","rounded-lg","w-full"],["class","bg-slate-300 px-4 py-2 border border-1 border-primary rounded-lg w-full",4,"ngIf"],["formArrayName","technologies",1,"flex","flex-col","w-full","gap-4"],["class","flex flex-row gap-4 items-center",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"button-primary-sm","mt-2","w-fit",3,"click"],[1,"flex","justify-end","gap-4","mt-4"],["type","submit",1,"button-primary-sm",3,"click"],["type","submit","class","button-primary-sm bg-red-500",3,"click",4,"ngIf"],["type","button",1,"button-secondary-sm",3,"click"],[1,"text-lg","font-semibold"],[1,"text-red-500","text-xs"],[1,"bg-slate-300","px-4","py-2","border","border-1","border-primary","rounded-lg","w-full"],[1,"text-primary","text-lg","font-outfit"],[1,"flex","flex-row","gap-4","items-center",3,"formGroupName"],[1,"flex","items-center","gap-1"],["type","checkbox","formControlName","isPackage",3,"ngModelChange"],["formControlName","techs",3,"items","multiselect",4,"ngIf"],["formControlName","packages","labelKey","title",3,"items","multiselect",4,"ngIf"],["formControlName","combinationBy","class","px-4 py-2 border border-black rounded-lg",4,"ngIf"],["type","button",1,"text-red-600","font-semibold","text-lg",3,"click"],[1,"text-gray-600"],["formControlName","techs",3,"items","multiselect"],["formControlName","packages","labelKey","title",3,"items","multiselect"],["formControlName","combinationBy",1,"px-4","py-2","border","border-black","rounded-lg"],["value",""],["value","+"],["value","/"],["type","submit",1,"button-primary-sm","bg-red-500",3,"click"]],template:function(n,a){n&1&&(i(0,"div",0)(1,"div",1),p(2,"app-loader",2),m(3,Lt,27,2,"table",3),t()(),m(4,Xt,55,16,"div",4)),n&2&&(l(2),c("loading",a.loading),l(),c("ngIf",!a.loading),l(),c("ngIf",a.isOpen))},dependencies:[L,oe,z,Z,H,R,ae,re,Y,j,W,qe,U,K,le,ce,Q,de]})}}return r})();var ei=[{path:"students",component:Re,canActivate:[se]},{path:"enquiries",component:We,canActivate:[se]},{path:"packages",component:ze,canActivate:[se]}],Ue=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=ne({type:r})}static{this.\u0275inj=ie({imports:[X.forChild(ei),X]})}}return r})();var Ki=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=ne({type:r})}static{this.\u0275inj=ie({imports:[Oe,Ue,Ae,De,X,Q,de]})}}return r})();export{Ki as AdminModule};
